if (self.CavalryLogger) { CavalryLogger.start_js(["JXqZx"]); }

__d("MessengerSharedPhotosContainer.react",["fbt","messengerInfoPanelSectionReact","MessengerSharedPhotos.react","React","RelayClassic","react-relay/classic/query/RelayQL"],(function a(b,c,d,e,f,g,h){"use strict";__p&&__p();var i=c("messengerInfoPanelSectionReact").jsComponent,j=c("React").PropTypes,k=10,l=c("React").createClass({displayName:"MessengerSharedPhotosContainer",propTypes:{customColor:j.string,clearForceFetch:j.func.isRequired,getIsScrolledToBottom:j.func.isRequired,getScrollableHeight:j.func.isRequired,isCollapsed:j.bool.isRequired,onToggle:j.func.isRequired,sharedPhotos:j.object,threadFBID:j.string},getInitialState:function m(){return{allPhotosDisplayed:false,isLoadingImages:false}},componentWillReceiveProps:function m(n){if(n.threadFBID!==this.props.threadFBID)this.setState({allPhotosDisplayed:false})},componentDidMount:function m(){this._maybeLoadMore()},componentDidUpdate:function m(){this._maybeLoadMore()},_maybeLoadMore:function m(){__p&&__p();var n=this.props,o=n.getIsScrolledToBottom,p=n.getScrollableHeight,q=n.isCollapsed,r=n.sharedPhotos,s=this.state.isLoadingImages;if(s||q||!r||!this.state.allPhotosDisplayed||!o()||!p())return;var t=r.message_shared_photo_and_video.page_info.has_next_page;if(!t)return;this.setState({isLoadingImages:true},function(){this.props.relay.setVariables({count:this.props.relay.variables.count+k},function(u){if(u.done||u.aborted)if(this.isMounted()){this.props.clearForceFetch();this.setState({allPhotosDisplayed:false,isLoadingImages:false})}}.bind(this))}.bind(this))},_loadMore:function m(n){if(n<=0)return;this.setState({isLoadingImages:true},function(){this.props.relay.setVariables({count:this.props.relay.variables.count+n},function(o){if(o.done||o.aborted)this.setState({isLoadingImages:false})}.bind(this))}.bind(this))},_handleAllPhotosDisplayed:function m(){this.setState({allPhotosDisplayed:true})},render:function m(){var n=this.props,o=n.isCollapsed,p=n.onToggle,q=n.sharedPhotos,r=n.threadFBID,s=this.state.isLoadingImages;if(!r||!q)return null;var t=q.message_shared_photo_and_video;if(!t.page_info.has_next_page&&t.count===0)return null;return c("React").createElement(i,{customColor:this.props.customColor,isCollapsible:true,isCollapsed:o,onToggle:p,title:h._("Shared Photos")},c("React").createElement(c("MessengerSharedPhotos.react"),{allPhotosDisplayed:this.state.allPhotosDisplayed,fetchMore:this._loadMore,isLoadingImages:s,sharedPhotoAndVideos:t,onAllPhotosDisplayed:this._handleAllPhotosDisplayed,threadFBID:r}))}});f.exports=c("RelayClassic").createContainer(l,{initialVariables:{count:k},fragments:{sharedPhotos:function m(){return function(n){return{children:[{calls:[{kind:"Call",metadata:{type:"Int"},name:"first",value:{kind:"CallVariable",callVariableName:"count"}}],children:[].concat.apply([],[{children:[{fieldName:"has_next_page",kind:"Field",metadata:{isRequisite:true},type:"Boolean"},{fieldName:"has_previous_page",kind:"Field",metadata:{isGenerated:true,isRequisite:true},type:"Boolean"}],fieldName:"page_info",kind:"Field",metadata:{canHaveSubselections:true},type:"PageInfo"},{fieldName:"count",kind:"Field",metadata:{},type:"Int"},c("react-relay/classic/query/RelayQL").__frag(n)]),fieldName:"message_shared_photo_and_video",kind:"Field",metadata:{canHaveSubselections:true,isConnection:true,isFindable:true},type:"MessageSharedPhotoAndVideoConnection"},{fieldName:"id",kind:"Field",metadata:{isGenerated:true,isRequisite:true},type:"ID"}],id:c("react-relay/classic/query/RelayQL").__id(),kind:"Fragment",metadata:{},name:"MessengerSharedPhotosContainer_react_SharedPhotosRelayQL",type:"MessageThread"}}(c("MessengerSharedPhotos.react").getFragment("sharedPhotoAndVideos"))}}})}),null);