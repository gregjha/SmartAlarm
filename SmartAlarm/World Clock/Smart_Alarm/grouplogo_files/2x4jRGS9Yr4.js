if (self.CavalryLogger) { CavalryLogger.start_js(["IoPD5"]); }

__d("MercuryAttachmentAudioClip.react",["cssVar","cx","fbt","Arbiter","ArbiterMixin","MercuryAudioPlayer","CurrentUser","JSLogger","LeftRight.react","Link.react","MercuryShareAttachmentRenderLocations","React","SubscriptionsHandler","WorkModeConfig","joinClasses","messengerCustomColorUtils","shield"],(function a(b,c,d,e,f,g,h,i,j){__p&&__p();var k=c("React").PropTypes,l="MercuryAttachmentAudioClip/play",m="progress-bar",n=c("JSLogger").create("mercury_audio_clip"),o=c("React").createClass({displayName:"AudioClip",mixins:[c("ArbiterMixin")],propTypes:{customColor:k.string,duration:k.number,isChat:k.bool,isFromViewer:k.bool,location:k.oneOf(c("MercuryShareAttachmentRenderLocations").getValues()),onAttachmentLoad:k.func,rootClassName:k.string,showHelp:k.bool,src:k.string.isRequired,width:k.number},getInitialState:function p(){this.logged=false;return{time:0,playing:false,started:false,duration:this.props.duration,audioPlayer:new(c("MercuryAudioPlayer"))(this.props.src,this)}},componentDidMount:function p(){this.props.onAttachmentLoad&&this.props.onAttachmentLoad();this._subscriptionsHandler=new(c("SubscriptionsHandler"))();this._subscriptionsHandler.addSubscriptions(this.subscribe("playing",this.updateTime),this.subscribe("played",c("shield")(this.setState,this,{playing:true,started:true})),this.subscribe("paused",c("shield")(this.setState,this,{playing:false})),this.subscribe("finished",c("shield")(this.setState,this,{playing:false,started:false,time:this.props.duration})),c("Arbiter").subscribe(l,function(q,r){if(this.props.src!=r)this.setState({time:0})}.bind(this)))},componentWillUnmount:function p(){this._subscriptionsHandler&&this._subscriptionsHandler.release()},updateTime:function p(q,r){this.setState({time:r})},play:function p(){if(this.state.playing)this.state.audioPlayer.pause();else{this.state.audioPlayer.play(this.state.started);c("Arbiter").inform(l,this.props.src);if(!this.logged){this.logged=true;n.log("play",{uid:c("CurrentUser").getID(),duration:this.props.duration})}}},_formatSeconds:function p(q){if(q){q=Math.round(q);var r=q%60;if(r<10)r="0"+r;var s=Math.floor(q/60);return s+":"+r}else return null},_renderPlayer:function p(q,r,s){var t=this.props.isFromViewer,u=this.props.isChat,v=c("WorkModeConfig").is_work_user,w=s===m,x=u&&t&&!w,y=this.props.location===c("MercuryShareAttachmentRenderLocations").MESSENGER,z=v?"#373e4c":"#4080ff",A=s||z,B={width:q};if(x)c("messengerCustomColorUtils").customBubbleStyle(A,B);var C=s&&s!==m&&!u?{color:s}:{},D={};if(w)D["aria-disabled"]=true;return c("React").createElement(c("Link.react"),babelHelpers["extends"]({"aria-label":j._("Voice Message"),className:"_1miz _2e-1"+(!y?" _3_om":"")+(t&&u?" _3e5f":""),role:"button",style:B,onClick:this.play},D),c("React").createElement("span",{className:"_1mi- _2e-2"},c("React").createElement("i",{className:"_1mi_ _2e-3"})),c("React").createElement("span",{style:C,className:"_1mj0 _2e-4 _3oh-"},r),c("React").createElement("div",{className:"_1mj1 _2e-5"}))},render:function p(){__p&&__p();var q=this.state.time,r=this.state.playing,s=this._formatSeconds(this.state.duration),t=this.props.location===c("MercuryShareAttachmentRenderLocations").MESSENGER,u=this.props.width||170;if(t){var v=this.props.duration;if(v>10)u=240;else if(v>5)u=200;else if(v>2)u=160;else u=120}var w=null,x=Math.ceil(q*(u+2)/this.state.duration);if(t)x=Math.ceil(q*(u+24)/this.state.duration);if(this.state.audioPlayer&&this.state.audioPlayer.getType()){var y=this._renderPlayer(u,s,this.props.customColor),z=this._renderPlayer(u,s,m),A="_1mj2 _2e-6"+(r&&q!==0?" _1mj3":"")+(r&&q===0?" _4g4x":"");w=c("React").createElement("div",{className:A},y,c("React").createElement("div",{className:"_1mj4 _2e-7",style:{width:x}},z))}else w=c("React").createElement("div",{className:"_1mj2"},c("React").createElement("div",{className:"_1miz"},c("React").createElement(c("LeftRight.react"),null,c("React").createElement("a",{className:"_1mj5",href:this.props.src},c("React").createElement("span",{className:"_3qi6"},c("React").createElement("i",{className:"_1mj6"})),c("React").createElement("span",{className:"_1mj7"},j._("Voice Message")),c("React").createElement("span",{className:"_1mj8"},s)),c("React").createElement("a",{href:this.props.src,className:"_1mj9"},c("React").createElement("i",{className:"_1mja"})))));return c("React").createElement("div",{className:c("joinClasses")("_1mjb"+(t?" _454y":""),this.props.rootClassName)},w)}});f.exports=o}),null);