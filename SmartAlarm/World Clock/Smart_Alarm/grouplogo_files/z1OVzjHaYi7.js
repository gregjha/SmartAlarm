if (self.CavalryLogger) { CavalryLogger.start_js(["WBnp+"]); }

__d("MessagingThreadEventTypedLogger",["Banzai","GeneratedLoggerUtils","nullthrows"],(function a(b,c,d,e,f,g){"use strict";__p&&__p();function h(){this.clear()}h.prototype.log=function(){c("GeneratedLoggerUtils").log("logger:MessagingThreadEventLoggerConfig",this.$MessagingThreadEventTypedLogger1,c("Banzai").BASIC)};h.prototype.logVital=function(){c("GeneratedLoggerUtils").log("logger:MessagingThreadEventLoggerConfig",this.$MessagingThreadEventTypedLogger1,c("Banzai").VITAL)};h.prototype.clear=function(){this.$MessagingThreadEventTypedLogger1={};return this};h.prototype.updateData=function(j){this.$MessagingThreadEventTypedLogger1=babelHelpers["extends"]({},this.$MessagingThreadEventTypedLogger1,j);return this};h.prototype.setActiveTimeMs=function(j){this.$MessagingThreadEventTypedLogger1.active_time_ms=j;return this};h.prototype.setClientEventTimeMs=function(j){this.$MessagingThreadEventTypedLogger1.client_event_time_ms=j;return this};h.prototype.setEvent=function(j){this.$MessagingThreadEventTypedLogger1.event=j;return this};h.prototype.setPageData=function(j){this.$MessagingThreadEventTypedLogger1.page_data=c("GeneratedLoggerUtils").serializeMap(j);return this};h.prototype.setPageID=function(j){this.$MessagingThreadEventTypedLogger1.page_id=j;return this};h.prototype.setScriptPath=function(j){this.$MessagingThreadEventTypedLogger1.script_path=j;return this};h.prototype.setSource=function(j){this.$MessagingThreadEventTypedLogger1.source=j;return this};h.prototype.setThreadID=function(j){this.$MessagingThreadEventTypedLogger1.thread_id=j;return this};h.prototype.setVC=function(j){this.$MessagingThreadEventTypedLogger1.vc=j;return this};var i={active_time_ms:true,client_event_time_ms:true,event:true,page_data:true,page_id:true,script_path:true,source:true,thread_id:true,vc:true};f.exports=h}),null);
__d("VideoCallTypedLogger",["Banzai","GeneratedLoggerUtils","nullthrows"],(function a(b,c,d,e,f,g){"use strict";__p&&__p();function h(){this.clear()}h.prototype.log=function(){c("GeneratedLoggerUtils").log("logger:VideoCallLoggerConfig",this.$VideoCallTypedLogger1,c("Banzai").BASIC)};h.prototype.logVital=function(){c("GeneratedLoggerUtils").log("logger:VideoCallLoggerConfig",this.$VideoCallTypedLogger1,c("Banzai").VITAL)};h.prototype.clear=function(){this.$VideoCallTypedLogger1={};return this};h.prototype.updateData=function(j){this.$VideoCallTypedLogger1=babelHelpers["extends"]({},this.$VideoCallTypedLogger1,j);return this};h.prototype.setEvent=function(j){this.$VideoCallTypedLogger1.event=j;return this};h.prototype.setMessage=function(j){this.$VideoCallTypedLogger1.message=j;return this};var i={event:true,message:true};f.exports=h}),null);
__d("MessagingThreadEventType",[],(function a(b,c,d,e,f,g){f.exports=Object.freeze({ACTIVE:"active",INACTIVE:"inactive"})}),null);
__d("MessagingThreadSourceName",[],(function a(b,c,d,e,f,g){f.exports=Object.freeze({CHAT_NUB:"chat_nub",MESSENGER:"messenger"})}),null);
__d("MessengerLoggerUtils",["MercuryIDs","MessagingThreadEventType","MessagingThreadEventTypedLogger","MessagingThreadSourceName","ScriptPath","pageID"],(function a(b,c,d,e,f,g){var h={logThreadChangeEvent:function i(j,k,l,m){if(l.activeThreadID&&j)this.log({activeThreadID:l.activeThreadID,event:c("MessagingThreadEventType").INACTIVE,clientEventTimeMs:k,activeTimeMs:k-j});if(m.activeThreadID)this.log({activeThreadID:m.activeThreadID,event:c("MessagingThreadEventType").ACTIVE,clientEventTimeMs:k,activeTimeMs:0})},log:function i(j){var k=c("MercuryIDs").tokenize(j.activeThreadID.toString()),l=c("ScriptPath").getPageInfo();new(c("MessagingThreadEventTypedLogger"))().setEvent(j.event).setClientEventTimeMs(j.clientEventTimeMs).setActiveTimeMs(j.activeTimeMs).setPageID(c("pageID")).setPageData(l?l.extraData:{}).setThreadID(k.value).setSource(c("MessagingThreadSourceName").MESSENGER).log()}};f.exports=h}),null);
__d("MessengerStateStore",["MessengerActions","MessengerLoggerUtils","MessengerStore"],(function a(b,c,d,e,f,g){"use strict";__p&&__p();var h,i;h=babelHelpers.inherits(j,c("MessengerStore"));i=h&&h.prototype;function j(){i.constructor.call(this);this.$MessengerStateStore1={activeThreadID:null,detailView:null,filter:null,folder:null,masterView:null,query:null,mid:null,serverThreadID:null,extraQueryParams:null,threadIDs:null};this.$MessengerStateStore2=babelHelpers["extends"]({},this.$MessengerStateStore1);this.$MessengerStateStore4=this.$MessengerStateStore3=null}j.prototype.getState=function(){return this.$MessengerStateStore1};j.prototype.getPrevState=function(){return this.$MessengerStateStore2};j.prototype.__onDispatch=function(k){switch(k.type){case c("MessengerActions").Types.REPLACE_STATE:this.$MessengerStateStore2=this.$MessengerStateStore1;this.$MessengerStateStore4=this.$MessengerStateStore3;this.$MessengerStateStore1=babelHelpers["extends"]({activeThreadID:null,detailView:null,filter:null,folder:null,masterView:null,query:null,mid:null,serverThreadID:null,extraQueryParams:null,threadsIDs:null},k.nextState);var l=Date.now();this.$MessengerStateStore3=l;c("MessengerLoggerUtils").logThreadChangeEvent(this.$MessengerStateStore4,l,this.$MessengerStateStore2,this.$MessengerStateStore1);this.emitChange();break}};f.exports=new j()}),null);
__d("FBRTCIceStatsParser",[],(function a(b,c,d,e,f,g){__p&&__p();var h=null;i.getInstance=function(){"use strict";if(!h)h=new i();return h};function i(){"use strict"}i.prototype.extractIceInfo=function(j){"use strict";var k=[],l=j.split("\r\n");for(var m=0;m<l.length;m++){var n=l[m];if(this.$FBRTCIceStatsParser1(n))k.push({gen:this.$FBRTCIceStatsParser2(n),type:this.$FBRTCIceStatsParser3(n)})}return k};i.prototype.$FBRTCIceStatsParser1=function(j){"use strict";return j.indexOf("candidate:")>-1};i.prototype.$FBRTCIceStatsParser2=function(j){"use strict";var k=0,l=j.match(/generation (\d+)/);if(l)k=parseInt(l[1],10);return k};i.prototype.$FBRTCIceStatsParser3=function(j){"use strict";var k=j.match(/typ (host|relay|srflx|prflx)/);if(k)return k[1];else return"unknown"};f.exports=i}),null);
__d("FBRTCCallSummary",["FBRTCConstants","FBRTCIceStatsParser","FBRTCLogger","FBRTCUtils","SiteData","UserAgentData","performanceNow"],(function a(b,c,d,e,f,g){__p&&__p();var h=5*60*1e3,i={CALL_STARTED:"started",POPUP_OPENED:"opened",SENT_OFFER:"s_o",RECV_OFFER:"r_o",SENT_OFFER_ACK:"s_oack",RECV_OFFER_ACK:"r_oack",SENT_RETRIED_OFFER:"s_o2",RECV_RETRIED_OFFER:"r_o2",SENT_RETRIED_OFFER_ACK:"s_oack2",RECV_RETRIED_OFFER_ACK:"r_oack2",SENT_PRANSWER:"s_pr",RECV_PRANSWER:"r_pr",NETWORK_READY:"network_ready",SENT_ANSWER:"s_a",RECV_ANSWER:"r_a",SENT_ANSWER_ACK:"s_aack",RECV_ANSWER_ACK:"r_aack",SENT_RETRIED_ANSWER:"s_a2",RECV_RETRIED_ANSWER:"r_a2",SENT_RETRIED_ANSWER_ACK:"s_aack2",RECV_RETRIED_ANSWER_ACK:"r_aack2",SENT_OK:"s_ok",RECV_OK:"r_ok",CALL_CONNECTED:"connected",CALL_ENDED:"ended"};j.CURRENT_SUMMARY_VERSION=19;function j(k){"use strict";__p&&__p();this.peerID=k.peerID;this.callID=k.callID;this.$FBRTCCallSummary1=k.isCaller;this.$FBRTCCallSummary2=c("FBRTCUtils").getLocalUploadLogLevel();this.$FBRTCCallSummary3=new Date().valueOf();this.$FBRTCCallSummary4=null;this.$FBRTCCallSummary5={};this.$FBRTCCallSummary6=null;this.$FBRTCCallSummary7=null;this.$FBRTCCallSummary8=null;this.$FBRTCCallSummary9=null;this.$FBRTCCallSummary10=null;this.$FBRTCCallSummary11=null;this.$FBRTCCallSummary12={};this.$FBRTCCallSummary13={};this.$FBRTCCallSummary14={};this.$FBRTCCallSummary15={};this.$FBRTCCallSummary16={};this.$FBRTCCallSummary17={};this.$FBRTCCallSummary18=null;this.$FBRTCCallSummary19=c("performanceNow")();this.$FBRTCCallSummary20=0;this.$FBRTCCallSummary21={};this.$FBRTCCallSummary22=this.$FBRTCCallSummary19;this.$FBRTCCallSummary23=0;this.$FBRTCCallSummary24={};this.addExtraInfo(c("FBRTCLogger").Key.DEVICE_INFO,this.$FBRTCCallSummary25());this.$FBRTCCallSummary26();this.$FBRTCCallSummary27=c("FBRTCIceStatsParser").getInstance();this.$FBRTCCallSummary28=c("FBRTCLogger").getInstance()}j.prototype.toJsonString=function(){"use strict";this.$FBRTCCallSummary10=new Date().valueOf();return JSON.stringify({version:j.CURRENT_SUMMARY_VERSION,peerID:this.peerID,callID:this.callID,isCaller:this.$FBRTCCallSummary1,uploadLogLevel:this.$FBRTCCallSummary2,clientVersion:this.$FBRTCCallSummary18,callType:this.$FBRTCCallSummary29,isUsingMultiway:this.$FBRTCCallSummary30,conferenceName:this.$FBRTCCallSummary31,serverInfoData:this.$FBRTCCallSummary32,localVideoDuration:this.$FBRTCCallSummary33,remoteVideoDuration:this.$FBRTCCallSummary34,startTime:this.$FBRTCCallSummary3,trigger:this.$FBRTCCallSummary4,signalingTime:this.$FBRTCCallSummary5,endCallReason:this.$FBRTCCallSummary6,endCallSubreason:this.$FBRTCCallSummary7,isRemoteEnded:this.$FBRTCCallSummary8,lastUpdatedTime:this.$FBRTCCallSummary9,lastSerializedTime:this.$FBRTCCallSummary10,unsetOnRetrieve:this.$FBRTCCallSummary11,openCount:this.$FBRTCCallSummary23,extraInfo:this.$FBRTCCallSummary24,pcStats:this.$FBRTCCallSummary12,captureStats:this.$FBRTCCallSummary13,gen0IceSentCount:this.$FBRTCCallSummary14,gen0IceReceivedCount:this.$FBRTCCallSummary15,iceSentCount:this.$FBRTCCallSummary16,iceReceivedCount:this.$FBRTCCallSummary17,newSignalingTime:this.$FBRTCCallSummary21,accumulatedCallTime:this.$FBRTCCallSummary35()})};j.fromJsonString=function(k){"use strict";__p&&__p();var l;try{l=JSON.parse(k)}catch(m){return null}if(l.version!==j.CURRENT_SUMMARY_VERSION)return null;if(!Object.prototype.hasOwnProperty.call(l,"peerID")||!Object.prototype.hasOwnProperty.call(l,"callID")||!Object.prototype.hasOwnProperty.call(l,"isCaller")||!Object.prototype.hasOwnProperty.call(l,"startTime")||!Object.prototype.hasOwnProperty.call(l,"trigger")||!Object.prototype.hasOwnProperty.call(l,"signalingTime")||!Object.prototype.hasOwnProperty.call(l,"endCallReason")||!Object.prototype.hasOwnProperty.call(l,"isRemoteEnded")||!Object.prototype.hasOwnProperty.call(l,"lastUpdatedTime")||!Object.prototype.hasOwnProperty.call(l,"lastSerializedTime"))return null;var n=new j({peerID:l.peerID,callID:l.callID,isCaller:l.isCaller});n.$FBRTCCallSummary2=l.uploadLogLevel;n.$FBRTCCallSummary18=l.clientVersion;n.$FBRTCCallSummary3=l.startTime;n.$FBRTCCallSummary4=l.trigger;n.$FBRTCCallSummary5=l.signalingTime;n.$FBRTCCallSummary6=l.endCallReason;n.$FBRTCCallSummary7=l.endCallSubreason;n.$FBRTCCallSummary8=l.isRemoteEnded;n.$FBRTCCallSummary9=l.lastUpdatedTime;n.$FBRTCCallSummary10=l.lastSerializedTime;if(l.callType)n.$FBRTCCallSummary29=l.callType;if(l.isUsingMultiway!=null)n.$FBRTCCallSummary30=l.isUsingMultiway;if(l.conferenceName)n.$FBRTCCallSummary31=l.conferenceName;if(l.serverInfoData)n.$FBRTCCallSummary32=l.serverInfoData;if(l.localVideoDuration)n.$FBRTCCallSummary33=l.localVideoDuration;if(l.remoteVideoDuration)n.$FBRTCCallSummary34=l.remoteVideoDuration;if(l.unsetOnRetrieve)n.$FBRTCCallSummary11=l.unsetOnRetrieve;if(l.openCount)n.$FBRTCCallSummary23=l.openCount;if(l.extraInfo)n.$FBRTCCallSummary24=l.extraInfo;if(l.pcStats)n.$FBRTCCallSummary12=l.pcStats;if(l.captureStats)n.$FBRTCCallSummary13=l.captureStats;if(l.gen0IceSentCount)n.$FBRTCCallSummary14=l.gen0IceSentCount;if(l.gen0IceReceivedCount)n.$FBRTCCallSummary15=l.gen0IceReceivedCount;if(l.iceSentCount)n.$FBRTCCallSummary16=l.iceSentCount;if(l.iceReceivedCount)n.$FBRTCCallSummary17=l.iceReceivedCount;if(l.newSignalingTime)n.$FBRTCCallSummary21=l.newSignalingTime;if(l.accumulatedCallTime)n.$FBRTCCallSummary20=l.accumulatedCallTime;return n};j.restoreOrInitialize=function(k,l,m,n,o){"use strict";__p&&__p();var p=k.retrieveCallSummary(l,m);if(!p){p=new j({peerID:l,callID:m,isCaller:n});if(o){p.onFullMessageReceived({msg:o});p.onOfferAckSent(o)}else p.onCallStarted(c("FBRTCLogger").Trigger.UNKNOWN);c("FBRTCLogger").getInstance().logError(l,m,"Missing call summary from storage")}else if(p.$FBRTCCallSummary11){p.$FBRTCCallSummary6=null;p.$FBRTCCallSummary7=null;p.$FBRTCCallSummary8=null;delete p.$FBRTCCallSummary5[i.CALL_ENDED];delete p.$FBRTCCallSummary21[i.CALL_ENDED];p.$FBRTCCallSummary11=null}return p};j.logSavedSummaries=function(k){"use strict";__p&&__p();var l=k.getLoggableSummaries(),m=l.length;if(m<=0)return;var n=c("FBRTCLogger").getInstance(),o=[];for(var p=0;p<m;p++){var q=l[p];n.logEndCallSummary(q);o.push({peerID:q.peerID,callID:q.callID})}k.removeCallSummaries(o);n.logToConsole("Logged pending summaries: "+m)};j.prototype.save=function(k){"use strict";var l=c("performanceNow")(),m=l-this.$FBRTCCallSummary22;if(m>h){this.$FBRTCCallSummary28.logInfo(this.peerID,this.callID,"Summary too old: "+m);return}k.storeCallSummary(this.peerID,this.callID,this);this.$FBRTCCallSummary22=l};j.prototype.getLastUpdatedTime=function(){"use strict";return this.$FBRTCCallSummary9};j.prototype.setLastUpdatedTime=function(k){"use strict";this.$FBRTCCallSummary9=k};j.prototype.getExtraInfo=function(){"use strict";return this.$FBRTCCallSummary24};j.prototype.addExtraInfo=function(k,l){"use strict";this.$FBRTCCallSummary24[k]=l;this.$FBRTCCallSummary26()};j.prototype.isCaller=function(){"use strict";return this.$FBRTCCallSummary1};j.prototype.isNetworkReady=function(){"use strict";if(this.$FBRTCCallSummary5[i.NETWORK_READY])return true;else return false};j.prototype.isAnswerReceived=function(){"use strict";if(this.$FBRTCCallSummary5[i.RECV_ANSWER])return true;else return false};j.prototype.onCallStarted=function(k){"use strict";this.$FBRTCCallSummary4=k;this.$FBRTCCallSummary36(i.CALL_STARTED);this.$FBRTCCallSummary26()};j.prototype.onPopupOpened=function(){"use strict";this.$FBRTCCallSummary36(i.POPUP_OPENED);this.$FBRTCCallSummary23++;this.$FBRTCCallSummary26()};j.prototype.setPcStats=function(k){"use strict";this.$FBRTCCallSummary12=k;this.$FBRTCCallSummary26()};j.prototype.setVideoCaptureStats=function(k,l){"use strict";this.$FBRTCCallSummary13={w:k,h:l};this.$FBRTCCallSummary26()};j.prototype.setUploadLogLevel=function(k){"use strict";this.$FBRTCCallSummary2=k;this.$FBRTCCallSummary26()};j.prototype.getCallType=function(){"use strict";return this.$FBRTCCallSummary29};j.prototype.setCallType=function(k){"use strict";this.$FBRTCCallSummary29=k;this.addExtraInfo("call_type",k);this.$FBRTCCallSummary26()};j.prototype.setVideoDurations=function(k,l){"use strict";this.$FBRTCCallSummary33=k;this.$FBRTCCallSummary34=l;this.$FBRTCCallSummary26()};j.prototype.setIsUsingMultiway=function(k){"use strict";this.$FBRTCCallSummary30=k;this.$FBRTCCallSummary26()};j.prototype.setConferenceName=function(k){"use strict";this.$FBRTCCallSummary31=k;this.$FBRTCCallSummary26()};j.prototype.setServerInfoData=function(k){"use strict";this.$FBRTCCallSummary32=k;this.$FBRTCCallSummary26()};j.prototype.onOfferAckSent=function(k){"use strict";this.onMessageSent({type:c("FBRTCConstants").PayloadType.OFFER_ACK,flag:k.flag})};j.prototype.onMessageSent=function(k){"use strict";__p&&__p();var l=k.flag===1;switch(k.type){case c("FBRTCConstants").PayloadType.OFFER:this.$FBRTCCallSummary37(l,i.SENT_OFFER,i.SENT_RETRIED_OFFER);this.$FBRTCCallSummary38(k,this.$FBRTCCallSummary14,this.$FBRTCCallSummary16);break;case c("FBRTCConstants").PayloadType.ANSWER:this.$FBRTCCallSummary37(l,i.SENT_ANSWER,i.SENT_RETRIED_ANSWER);this.$FBRTCCallSummary38(k,this.$FBRTCCallSummary14,this.$FBRTCCallSummary16);break;case c("FBRTCConstants").PayloadType.OK:this.$FBRTCCallSummary36(i.SENT_OK);break;case c("FBRTCConstants").PayloadType.PRANSWER:this.$FBRTCCallSummary36(i.SENT_PRANSWER);break;case c("FBRTCConstants").PayloadType.OFFER_ACK:this.$FBRTCCallSummary37(l,i.SENT_OFFER_ACK,i.SENT_RETRIED_OFFER_ACK);break;case c("FBRTCConstants").PayloadType.ANSWER_ACK:this.$FBRTCCallSummary37(l,i.SENT_ANSWER_ACK,i.SENT_RETRIED_ANSWER_ACK);break;case c("FBRTCConstants").PayloadType.ICE_CANDIDATE:this.$FBRTCCallSummary38(k,this.$FBRTCCallSummary14,this.$FBRTCCallSummary16);break;default:}this.$FBRTCCallSummary26()};j.prototype.$FBRTCCallSummary38=function(k,l,m){"use strict";var n=null,o=null,p=this.$FBRTCCallSummary27.extractIceInfo(k.sdp);for(var q=0;q<p.length;q++){n=p[q].gen;o=p[q].type;if(n===0)this.$FBRTCCallSummary39(l,o);this.$FBRTCCallSummary39(m,o)}};j.prototype.$FBRTCCallSummary39=function(k,l){"use strict";if(!k[l])k[l]=1;else k[l]=k[l]+1};j.prototype.$FBRTCCallSummary40=function(k){"use strict";if(k.isFromMobile())this.addExtraInfo(c("FBRTCLogger").Key.PEER_IS_MOBILE,"1")};j.prototype.onFullMessageReceived=function(k){"use strict";__p&&__p();var l=k.msg,m=l.flag===1;switch(l.type){case c("FBRTCConstants").PayloadType.OFFER:this.$FBRTCCallSummary40(k);this.$FBRTCCallSummary37(m,i.RECV_OFFER,i.RECV_RETRIED_OFFER);this.$FBRTCCallSummary38(l,this.$FBRTCCallSummary15,this.$FBRTCCallSummary17);break;case c("FBRTCConstants").PayloadType.ANSWER:this.$FBRTCCallSummary40(k);this.$FBRTCCallSummary37(m,i.RECV_ANSWER,i.RECV_RETRIED_ANSWER);this.$FBRTCCallSummary38(l,this.$FBRTCCallSummary15,this.$FBRTCCallSummary17);break;case c("FBRTCConstants").PayloadType.OK:this.$FBRTCCallSummary36(i.RECV_OK);break;case c("FBRTCConstants").PayloadType.PRANSWER:this.$FBRTCCallSummary36(i.RECV_PRANSWER);break;case c("FBRTCConstants").PayloadType.OFFER_ACK:this.$FBRTCCallSummary37(m,i.RECV_OFFER_ACK,i.RECV_RETRIED_OFFER_ACK);break;case c("FBRTCConstants").PayloadType.ANSWER_ACK:this.$FBRTCCallSummary37(m,i.RECV_ANSWER_ACK,i.RECV_RETRIED_ANSWER_ACK);break;case c("FBRTCConstants").PayloadType.ICE_CANDIDATE:this.$FBRTCCallSummary38(l,this.$FBRTCCallSummary15,this.$FBRTCCallSummary17);break;default:}this.$FBRTCCallSummary26()};j.prototype.onMsgAckReceived=function(k,l){"use strict";var m=k.msg.flag===1;if(l)this.$FBRTCCallSummary37(m,i.RECV_OFFER_ACK,i.RECV_RETRIED_OFFER_ACK);else this.$FBRTCCallSummary37(m,i.RECV_ANSWER_ACK,i.RECV_RETRIED_ANSWER_ACK)};j.prototype.onNetworkReady=function(){"use strict";this.$FBRTCCallSummary36(i.NETWORK_READY);this.$FBRTCCallSummary26()};j.prototype.onCallConnected=function(){"use strict";this.$FBRTCCallSummary36(i.CALL_CONNECTED);this.$FBRTCCallSummary26()};j.prototype.onCallEnded=function(k,l,m,n){"use strict";this.$FBRTCCallSummary11=m;this.$FBRTCCallSummary6=k;this.$FBRTCCallSummary7=n;this.$FBRTCCallSummary8=l;this.$FBRTCCallSummary36(i.CALL_ENDED);this.$FBRTCCallSummary26()};j.prototype.setOfferSentTime=function(){"use strict";this.$FBRTCCallSummary36(i.SENT_OFFER)};j.prototype.setOfferAckReceivedTime=function(){"use strict";this.$FBRTCCallSummary36(i.RECV_OFFER_ACK)};j.prototype.setAnswerSentTime=function(){"use strict";this.$FBRTCCallSummary36(i.SENT_ANSWER)};j.prototype.setAnswerReceivedTime=function(){"use strict";this.$FBRTCCallSummary36(i.RECV_ANSWER)};j.prototype.toString=function(){"use strict";var k={};k.core_metrics=this.$FBRTCCallSummary41();k.time_series=null;return JSON.stringify(k)};j.prototype.$FBRTCCallSummary41=function(){"use strict";__p&&__p();var k={};k.ver=j.CURRENT_SUMMARY_VERSION;k.log_level=c("FBRTCConstants").uploadLogLevelString(this.$FBRTCCallSummary2);k.caller=this.$FBRTCCallSummary1;k.call_type=this.$FBRTCCallSummary29;k.is_using_multiway=this.$FBRTCCallSummary30;k.conf_name=this.$FBRTCCallSummary31;k.serv_info=this.$FBRTCCallSummary32;k.conn=this.$FBRTCCallSummary42();k.peer_id=this.peerID;k.has_video=true;k.open_count=this.$FBRTCCallSummary23;k.signaling=this.$FBRTCCallSummary43();k.sender=this.$FBRTCCallSummary44();k.receiver=this.$FBRTCCallSummary45();k.end=this.$FBRTCCallSummary46();k.video=this.$FBRTCCallSummary47();k.push_phase=c("SiteData").push_phase;k.client_version=this.$FBRTCCallSummary18;return k};j.prototype.$FBRTCCallSummary42=function(){"use strict";var k={dtls:1};if(this.$FBRTCCallSummary12.sender&&this.$FBRTCCallSummary12.sender.rtt)k.rtt=this.$FBRTCCallSummary12.sender.rtt;return k};j.prototype.$FBRTCCallSummary43=function(){"use strict";__p&&__p();var k={};if(this.$FBRTCCallSummary4)k.trigger=this.$FBRTCCallSummary4;k.start_time=this.$FBRTCCallSummary3;k.time_from_start=this.$FBRTCCallSummary5;var l=this.$FBRTCCallSummary5[i.CALL_CONNECTED],m=this.$FBRTCCallSummary5[i.CALL_ENDED];if(l){if(!m)if(this.$FBRTCCallSummary10)m=this.$FBRTCCallSummary10-this.$FBRTCCallSummary3;else m=this.$FBRTCCallSummary48();var n=m-l;if(n>0)k.duration=n}k.new_time_from_start=this.$FBRTCCallSummary21;l=this.$FBRTCCallSummary21[i.CALL_CONNECTED];m=this.$FBRTCCallSummary21[i.CALL_ENDED];if(l){if(!m)if(this.$FBRTCCallSummary20>0)m=this.$FBRTCCallSummary20;else m=this.$FBRTCCallSummary35();n=m-l;if(n>0)k.new_duration=n}return k};j.prototype.$FBRTCCallSummary44=function(){"use strict";var k={};if(this.$FBRTCCallSummary14)k.ice_g0=this.$FBRTCCallSummary14;if(this.$FBRTCCallSummary16)k.ice=this.$FBRTCCallSummary16;if(this.$FBRTCCallSummary12.sender)Object.assign(k,this.$FBRTCCallSummary12.sender);return k};j.prototype.$FBRTCCallSummary45=function(){"use strict";var k={};if(this.$FBRTCCallSummary15)k.ice_g0=this.$FBRTCCallSummary15;if(this.$FBRTCCallSummary17)k.ice=this.$FBRTCCallSummary17;return k};j.prototype.$FBRTCCallSummary46=function(){"use strict";__p&&__p();var k={};if(this.$FBRTCCallSummary6!==null){k.end_call_reason_string=c("FBRTCConstants").callEndReasonString(this.$FBRTCCallSummary6);if(this.$FBRTCCallSummary7!==null)k.end_call_subreason_string=this.$FBRTCCallSummary7;k.remote_ended=this.$FBRTCCallSummary8}if(this.$FBRTCCallSummary12.end)Object.assign(k,this.$FBRTCCallSummary12.end);return k};j.prototype.$FBRTCCallSummary47=function(){"use strict";var k={capture:{}};if(this.$FBRTCCallSummary12.video&&this.$FBRTCCallSummary12.video.sender)Object.assign(k,this.$FBRTCCallSummary12.video.sender);if(this.$FBRTCCallSummary13)Object.assign(k.capture,this.$FBRTCCallSummary13);return{sender:k,ld:this.$FBRTCCallSummary33,rd:this.$FBRTCCallSummary34}};j.prototype.$FBRTCCallSummary48=function(){"use strict";return new Date().valueOf()-this.$FBRTCCallSummary3};j.prototype.$FBRTCCallSummary35=function(){"use strict";var k=c("performanceNow")()-this.$FBRTCCallSummary19;return Math.floor(this.$FBRTCCallSummary20+k)};j.prototype.$FBRTCCallSummary36=function(k){"use strict";if(this.$FBRTCCallSummary5[k])return;this.$FBRTCCallSummary5[k]=this.$FBRTCCallSummary48();this.$FBRTCCallSummary21[k]=this.$FBRTCCallSummary35()};j.prototype.$FBRTCCallSummary37=function(k,l,m){"use strict";if(k)this.$FBRTCCallSummary36(m);else this.$FBRTCCallSummary36(l)};j.prototype.$FBRTCCallSummary26=function(){"use strict";this.$FBRTCCallSummary9=new Date().valueOf()};j.prototype.$FBRTCCallSummary25=function(){"use strict";return{device:c("UserAgentData").deviceName,os:c("UserAgentData").platformName,os_version:c("UserAgentData").platformFullVersion,browser:c("UserAgentData").browserName,browser_version:c("UserAgentData").browserFullVersion,screen_height:window.screen.availHeight,screen_width:window.screen.availWidth}};j.prototype.setClientVersion=function(k){"use strict";this.$FBRTCCallSummary18=k};f.exports=j}),null);
__d("FBRTCCallSummaryStore",["CacheStorage","FBRTCCallSummary","FBRTCLogger","areEqual"],(function a(b,c,d,e,f,g){__p&&__p();var h="localstorage",i="RTC_CALL_SUMMARY_",j="summary",k=2e3,l=3,m=3*60*1e3,n=null;o.getInstance=function(){"use strict";if(!n)n=new o();return n};function o(){"use strict";this.$FBRTCCallSummaryStore1=new(c("CacheStorage"))(h,i);this.$FBRTCCallSummaryStore2=c("FBRTCLogger").getInstance()}o.prototype.storeCallSummary=function(p,q,r){"use strict";__p&&__p();var s=this;this.$FBRTCCallSummaryStore3(function(t){__p&&__p();if(!t[p])t[p]={};var u=t[p][q];if(u){var v=s.$FBRTCCallSummaryStore4(u);if(v&&v.getLastUpdatedTime()>r.getLastUpdatedTime()){s.$FBRTCCallSummaryStore2.logToConsole("Outdated summaries");return null}}t[p][q]=s.$FBRTCCallSummaryStore5(r);return t},s.$FBRTCCallSummaryStore2.logError.bind(s.$FBRTCCallSummaryStore2,p,q))};o.prototype.retrieveCallSummary=function(p,q){"use strict";var r=this.$FBRTCCallSummaryStore6(),s=null;if(r[p])s=r[p][q];if(s)return this.$FBRTCCallSummaryStore4(s);else return null};o.prototype.removeCallSummary=function(p,q){"use strict";this.removeCallSummaries([{peerID:p,callID:q}])};o.prototype.removeCallSummaries=function(p){"use strict";__p&&__p();var q=this;this.$FBRTCCallSummaryStore3(function(r){__p&&__p();var s=p.length;for(var t=0;t<s;t++){var u=p[t].peerID,v=p[t].callID;if(r[u]&&r[u][v]){delete r[u][v];if(q.$FBRTCCallSummaryStore7(r[u]))delete r[u]}}return r},q.$FBRTCCallSummaryStore2.logError.bind(q.$FBRTCCallSummaryStore2,null,null))};o.prototype.getLoggableSummaries=function(){"use strict";__p&&__p();var p=this.$FBRTCCallSummaryStore6(),q=[];for(var r in p)if(Object.prototype.hasOwnProperty.call(p,r))for(var s in p[r])if(Object.prototype.hasOwnProperty.call(p[r],s)){var t=this.$FBRTCCallSummaryStore4(p[r][s],m);if(t)q.push(t)}return q};o.prototype.$FBRTCCallSummaryStore7=function(p){"use strict";for(var q in p)if(Object.prototype.hasOwnProperty.call(p,q))return false;return true};o.prototype.$FBRTCCallSummaryStore5=function(p){"use strict";var q={__t:Date.now(),__d:p.toJsonString()};return q};o.prototype.$FBRTCCallSummaryStore4=function(p,q){"use strict";if(p)if(!q||Date.now()-p.__t>=q)return c("FBRTCCallSummary").fromJsonString(p.__d);return null};o.prototype.$FBRTCCallSummaryStore6=function(){"use strict";var p=this.$FBRTCCallSummaryStore1.get(j)||{};return p};o.prototype.$FBRTCCallSummaryStore3=function(p,q,r,s){"use strict";__p&&__p();if(r===undefined||r===null)r=l;var t=this.$FBRTCCallSummaryStore6(),u=this.$FBRTCCallSummaryStore6(),v=p(t);if(v===null)return;var w=this.$FBRTCCallSummaryStore6();if(c("areEqual")(u,w)){this.$FBRTCCallSummaryStore1.set(j,v);this.$FBRTCCallSummaryStore2.logToConsole("Updated summaries")}else if(r>0){q("Retry lock");if(s){var x=this;setTimeout(function(){x.$FBRTCCallSummaryStore3(p,q,r-1,true)},k)}else this.$FBRTCCallSummaryStore3(p,q,r-1,true)}else q("Failed to lock")};f.exports=o}),null);
__d("XGroupCallController",["XController"],(function a(b,c,d,e,f,g){f.exports=c("XController").create("/groupcall/{?conference_name}/",{conference_name:{type:"String",required:true},call_id:{type:"Int"},users_to_ring:{type:"FBIDSet",defaultValue:[]},has_video:{type:"Bool",defaultValue:true},server_info_data:{type:"String"},nonce:{type:"String"}})}),null);
__d("XGroupCallSigningController",["XController"],(function a(b,c,d,e,f,g){f.exports=c("XController").create("/groupcall/init/",{conference_name:{type:"String",required:true},call_id:{type:"Int"},users_to_ring:{type:"FBIDSet",defaultValue:[]},has_video:{type:"Bool",defaultValue:false},server_info_data:{type:"String"},nonce:{type:"String"}})}),null);
__d("XVideoCallController",["XController"],(function a(b,c,d,e,f,g){f.exports=c("XController").create("/videocall/incall/",{peer_id:{type:"FBID",required:true},call_id:{type:"Int"},is_caller:{type:"Bool",defaultValue:false},audio_only:{type:"Bool",defaultValue:false},nonce:{type:"String"}})}),null);
__d("XVideoCallInitController",["XController"],(function a(b,c,d,e,f,g){f.exports=c("XController").create("/videocall/init/",{peer_id:{type:"FBID",required:true},call_id:{type:"Int",required:true},is_caller:{type:"Bool",defaultValue:false},audio_only:{type:"Bool",defaultValue:false},nonce:{type:"String"}})}),null);
__d("XWirelessScreenSharingController",["XController"],(function a(b,c,d,e,f,g){f.exports=c("XController").create("/screen_sharing/{?session_id}/",{nonce:{type:"String"},peer_id:{type:"FBID",required:true},session_id:{type:"Int"}})}),null);
__d("FBRTCUrlManager",["regeneratorRuntime","Promise","CurrentUser","FBRTCConfig","FBRTCLogger","FBRTCUtils","MessengerRTCFunnelLogger","URI","XGroupCallController","XGroupCallSigningController","XVideoCallController","XVideoCallInitController","XWirelessScreenSharingController"],(function a(b,c,d,e,f,g){__p&&__p();var h=3,i=function i(p,q,r,s){c("FBRTCLogger").getInstance().logCallAction(p,q,c("FBRTCLogger").CallAction.OLD_URI);return c("XVideoCallController").getURIBuilder().setFBID("peer_id",p).setInt("call_id",q).setBool("is_caller",r).setBool("audio_only",s).getURI()},j=function j(p,q,r,s,t,u){__p&&__p();var v=arguments.length<=6||arguments[6]===undefined?h:arguments[6],w=arguments.length<=7||arguments[7]===undefined?"":arguments[7];if(v===undefined||v===null)v=h;var x=c("XVideoCallInitController").getURIBuilder().setFBID("peer_id",p).setInt("call_id",q).setBool("is_caller",r).setBool("audio_only",s).getURI();x=c("FBRTCUtils").isPeerVCEndpoint(p)||c("FBRTCUtils").isCollabTrigger(w)?k(x):x;c("FBRTCUtils").sendServerRequest(x,function(y){t(y.payload.uri)},function(y){if(v>0)j(p,q,r,s,t,u,v-1,w);else t(i(p,q,r,s))})};function k(p){if(c("CurrentUser").isEmployee()){p=p.setSubdomain(c("CurrentUser").hasWorkUser()||c("CurrentUser").isWorkUser()?"fb":"www");var q="/intern/";return c("URI").getRequestURI().getPath().substr(0,q.length)!==q?p:p.setDomain(p.getDomain().toString().replace(/\.(intern|internmc|cstools)\./,"."))}return p}function l(p){__p&&__p();var q=p.conferenceName,r=p.callID,s=p.usersToRing,t=p.hasVideo,u=p.nonce,v=p.serverInfoData,w;return c("regeneratorRuntime").async(function x(y){while(1)switch(y.prev=y.next){case 0:w=c("XGroupCallSigningController").getURIBuilder().setString("conference_name",q).setInt("call_id",r).setFBIDSet("users_to_ring",s).setBool("has_video",t).setString("server_info_data",v).setString("nonce",u).getURI();return y.abrupt("return",new(c("Promise"))(function(z,A){c("FBRTCUtils").sendServerRequest(w,function(B){c("MessengerRTCFunnelLogger").appendAction("got_server_call_uri");z(B.payload.uri)},function(B){A(B)})}));case 2:case"end":return y.stop()}},null,this)}var m=function m(p,q,r,s,t,u,v){__p&&__p();if(v===undefined||v===null)v=h;var w=c("XGroupCallSigningController").getURIBuilder().setFBID("call_id",p).setBool("is_caller",r).setBool("audio_only",s).setFBIDSet("users_to_ring",q).getURI();c("FBRTCUtils").sendServerRequest(w,function(x){t(x.payload.uri)},function(x){if(v>0)m(p,q,r,s,t,u,v-1);else{var y=c("XGroupCallController").getURIBuilder().setFBID("call_id",p).setBool("is_caller",r).setBool("audio_only",s).setFBIDSet("users_to_ring",q).getURI();t(y)}})},n=function n(p){if(c("FBRTCConfig").disableURLManager())return;window.history.replaceState({},"",p)},o={init:function p(q){this._peerID=q},onCallStarted:function p(){n(i(this._peerID))},getCallUri:j,getGroupCallUri:function m(p,q,r,s,t,u){__p&&__p();var v;return c("regeneratorRuntime").async(function w(x){__p&&__p();while(1)switch(x.prev=x.next){case 0:v=0;case 1:if(!(v<3)){x.next=14;break}x.prev=2;x.next=5;return c("regeneratorRuntime").awrap(l({conferenceName:p,callID:q,usersToRing:r,hasVideo:s,nonce:t,serverInfoData:u}));case 5:return x.abrupt("return",x.sent);case 8:x.prev=8;x.t0=x["catch"](2);case 11:v++;x.next=1;break;case 14:c("MessengerRTCFunnelLogger").appendAction("use_local_call_uri");return x.abrupt("return",c("XGroupCallController").getURIBuilder().setString("conference_name",p).setInt("call_id",q).setFBIDSet("users_to_ring",r).setBool("has_video",s).setString("server_info_data",u).setString("nonce",t).getURI());case 16:case"end":return x.stop()}},null,this,[[2,8]])},getNonceUri:function p(q,r,s,t,u){var v=arguments.length<=5||arguments[5]===undefined?"":arguments[5],w=c("XVideoCallController").getURIBuilder().setFBID("peer_id",q).setInt("call_id",r).setBool("is_caller",s).setBool("audio_only",t).setString("nonce",u).getURI();return c("FBRTCUtils").isPeerVCEndpoint(q)||c("FBRTCUtils").isCollabTrigger(v)?k(w):w},getWirelessScreenSharingUri:function p(q,r,s){var t=c("XWirelessScreenSharingController").getURIBuilder().setFBID("peer_id",r).setInt("session_id",s).setString("nonce",q).getURI();return k(t)}};f.exports=o}),null);
__d("FBRTCCallUI",["regeneratorRuntime","FBRTCCallSummary","FBRTCCallSummaryStore","FBRTCConstants","FBRTCLogger","FBRTCMessageListener","FBRTCUrlManager","MessengerRTCFunnelLogger","VideoCallTypedLogger","pageID"],(function a(b,c,d,e,f,g){__p&&__p();var h={openGroupCallUI:function i(j,k,l,m,n,o,p){__p&&__p();var q,r,s;return c("regeneratorRuntime").async(function t(u){__p&&__p();while(1)switch(u.prev=u.next){case 0:q=c("FBRTCMessageListener").generateNewNonce();u.next=3;return c("regeneratorRuntime").awrap(c("FBRTCUrlManager").getGroupCallUri(j,k,l,m,q,p));case 3:r=u.sent;c("MessengerRTCFunnelLogger").appendAction("start_load_popup");c("MessengerRTCFunnelLogger").listenCrossWindowAction(q);o.location=r;o.focus&&o.focus();s=new(c("FBRTCCallSummary"))({peerID:-1,callID:k,isCaller:true});s.onCallStarted(n);s.addExtraInfo(c("FBRTCLogger").Key.INITIATED_BY_PAGE_ID,c("pageID"));s.onCallEnded(c("FBRTCConstants").CallEndReason.CLIENT_ERROR,false,true,"PopupPending");s.save(c("FBRTCCallSummaryStore").getInstance());case 13:case"end":return u.stop()}},null,this)},openGroupCallURI:function i(j){__p&&__p();var k=j.conferenceName,l=j.callID,m=j.hasVideo,n=j.serverInfoData,o=j.trigger,p=j.callSummary,q=j.callWindow,r;return c("regeneratorRuntime").async(function s(t){__p&&__p();while(1)switch(t.prev=t.next){case 0:t.next=2;return c("regeneratorRuntime").awrap(c("FBRTCUrlManager").getGroupCallUri(k,l,[],m,c("FBRTCMessageListener").generateNewNonce(),n));case 2:r=t.sent;q.location=r;q.focus&&q.focus();p.onCallStarted(o);p.addExtraInfo(c("FBRTCLogger").Key.INITIATED_BY_PAGE_ID,c("pageID"));p.onCallEnded(c("FBRTCConstants").CallEndReason.CLIENT_ERROR,false,true,"PopupPending");p.save(c("FBRTCCallSummaryStore").getInstance());case 9:case"end":return t.stop()}},null,this)},openAsCaller:function i(j,k,l,m,n){new(c("VideoCallTypedLogger"))().setEvent("open_as_caller").log();var o=c("FBRTCMessageListener").generateNewNonce();c("FBRTCLogger").getInstance().logCallAction(j,k,c("FBRTCLogger").CallAction.START_CALL,null,l);var p=new(c("FBRTCCallSummary"))({peerID:j,callID:k,isCaller:true});p.onCallStarted(l);c("MessengerRTCFunnelLogger").listenCrossWindowAction(o);this._open(j,k,true,p,false,m,n,o,l)},openAsCallee:function i(j,k,l,m,n,o){new(c("VideoCallTypedLogger"))().setEvent("open_as_callee").log();this._open(j,k,false,l,m,n,o,c("FBRTCMessageListener").generateNewNonce())},_open:function i(j,k,l,m,n,o,p,q){__p&&__p();var r=arguments.length<=8||arguments[8]===undefined?"":arguments[8];m.addExtraInfo(c("FBRTCLogger").Key.INITIATED_BY_PAGE_ID,c("pageID"));m.onCallEnded(c("FBRTCConstants").CallEndReason.CLIENT_ERROR,false,true,"PopupPending");m.save(c("FBRTCCallSummaryStore").getInstance());if(!p)return;n=c("FBRTCUrlManager").getNonceUri(j,k,l,o,q,r);new(c("VideoCallTypedLogger"))().setEvent("open_popup").log();if(!n)this._setUri(p,j,k,l,o);else{c("MessengerRTCFunnelLogger").appendAction("use_local_call_uri");c("MessengerRTCFunnelLogger").appendAction("start_load_popup");c("FBRTCLogger").getInstance().logCallAction(j,k,c("FBRTCLogger").CallAction.OPEN_POPUP);p.location=n}p.focus&&p.focus()},_setUri:function i(j,k,l,m,n){c("FBRTCUrlManager").getCallUri(k,l,m,n,function(o){c("FBRTCLogger").getInstance().logCallAction(k,l,c("FBRTCLogger").CallAction.OPEN_POPUP);c("MessengerRTCFunnelLogger").appendAction("got_server_call_uri");c("MessengerRTCFunnelLogger").appendAction("start_load_popup");j.location=o},function(){c("FBRTCLogger").getInstance().logCallAction(k,l,c("FBRTCLogger").CallAction.FAILED_GETTING_URI)})}};f.exports=h}),null);
__d("DocumentTitle",["Arbiter"],(function a(b,c,d,e,f,g){__p&&__p();var h=document.title,i=null,j=1500,k=[],l=0,m=null,n=false;function o(){__p&&__p();if(k.length>0)if(!n){p(k[l].title);l=++l%k.length}else q();else{clearInterval(m);m=null;q()}}function p(s){document.title=s;n=true}function q(){r.set(i||h,true);n=false}var r={get:function s(){return h},set:function s(t,u){document.title=t;if(!u){h=t;i=null;c("Arbiter").inform("update_title",t)}else i=t},blink:function s(t){__p&&__p();var u={title:t};k.push(u);if(m===null)m=setInterval(o,j);return{stop:function v(){var w=k.indexOf(u);if(w>=0){k.splice(w,1);if(l>w)l--;else if(l==w&&l==k.length)l=0}}}}};f.exports=r}),null);
__d("SoundPlayer",["Map","URI","createArrayFromMixed"],(function a(b,c,d,e,f,g){"use strict";__p&&__p();var h=new(c("Map"))();function i(l){var m=new(c("URI"))(l);return m.getDomain()?l:new(c("URI"))(window.location.href).setPath(m.getPath()).toString()}function j(l){var m=new(c("URI"))(l).getPath();if(/\.mp3$/.test(m))return"audio/mpeg";if(/\.og[ga]$/.test(m))return"audio/ogg";return""}var k={preload:function l(m){__p&&__p();for(var n=c("createArrayFromMixed")(m),o=Array.isArray(n),p=0,n=o?n:n[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){var q;if(o){if(p>=n.length)break;q=n[p++]}else{p=n.next();if(p.done)break;q=p.value}var r=q;if(h.has(r))return;var s=document.createElement("audio");if(!s||!s.canPlayType||!s.canPlayType(j(r)))continue;s.preload="auto";s.src=i(r);document.body&&document.body.appendChild(s);h.set(r,s);return}},play:function l(m){__p&&__p();var n=arguments.length<=1||arguments[1]===undefined?{}:arguments[1];for(var o=c("createArrayFromMixed")(m),p=Array.isArray(o),q=0,o=p?o:o[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){var r;if(p){if(q>=o.length)break;r=o[q++]}else{q=o.next();if(q.done)break;r=q.value}var s=r;if(!h.has(s))k.preload(s);var t=h.get(s);if(!t)continue;if(n.loop)t.setAttribute("loop","");if(n.volume)t.volume=n.volume;t.play();return}},pause:function l(m){__p&&__p();for(var n=c("createArrayFromMixed")(m),o=Array.isArray(n),p=0,n=o?n:n[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){var q;if(o){if(p>=n.length)break;q=n[p++]}else{p=n.next();if(p.done)break;q=p.value}var r=q,s=h.get(r);if(s){s.pause();return}}},stop:function l(m){__p&&__p();for(var n=c("createArrayFromMixed")(m),o=Array.isArray(n),p=0,n=o?n:n[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){var q;if(o){if(p>=n.length)break;q=n[p++]}else{p=n.next();if(p.done)break;q=p.value}var r=q,s=h.get(r);if(s){s.pause();s.removeAttribute("src");s.src=i(r);return}}}};f.exports=k}),null);
__d("MercuryAttachmentSnippetType",["keyMirror"],(function a(b,c,d,e,f,g){var h=c("keyMirror")({PHOTO:null,GIF:null,VIDEO:null,AUDIO_CLIP:null,STICKER:null,SHARE:null,ERROR:null,MIXED:null,GIFT:null,THIRDPARTYSTICKER:null,FILE:null,LIKE_STICKER:null});f.exports=h}),null);
__d("P2PSnippetStringUtils",["fbt","P2PPaymentRequestStatus","P2PTransferStatus"],(function a(b,c,d,e,f,g,h){__p&&__p();var i={getRequestCanceledSnippet:function j(k,l,m,n,o){if(k)return h._("Your request for {payment request amount} from {receiver's name} was canceled.",[h.param("payment request amount",o),h.param("receiver's name",n)]);else if(l)return h._("{requester's name}'s request for {payment request amount} was canceled.",[h.param("requester's name",m),h.param("payment request amount",o)]);else return h._("{requester's name}'s request for {payment request amount} from {receiver's name} was canceled.",[h.param("requester's name",m),h.param("payment request amount",o),h.param("receiver's name",n)])},getRequestDeclinedSnippet:function j(k,l,m,n,o){if(k)return h._("{receiver's name} declined your request for {payment request amount}.",[h.param("receiver's name",n),h.param("payment request amount",o)]);else if(l)return h._("You declined {requester's name}'s request for {payment request amount}.",[h.param("requester's name",m),h.param("payment request amount",o)]);else return h._("{receiver's name} declined {sender's name}'s request for {payment request amount}.",[h.param("receiver's name",n),h.param("sender's name",m),h.param("payment request amount",o)])},getRequestSentSnippet:function j(k,l,m,n,o){if(k)return h._("You requested {amount} from {requestee name}.",[h.param("amount",o),h.param("requestee name",n)]);else if(l)return h._("{requester name} requested {amount} from you.",[h.param("requester name",m),h.param("amount",o)]);else return h._("{name} requested {amount} from {requestee name}.",[h.param("name",m),h.param("amount",o),h.param("requestee name",n)])},getRequestSnippetByStatus:function j(k,l,m,n,o,p){var q=k||c("P2PPaymentRequestStatus").INITED,r=[l,m,n,o,p];switch(q){case c("P2PPaymentRequestStatus").DECLINED:return this.getRequestDeclinedSnippet.apply(this,r);case c("P2PPaymentRequestStatus").TRANSFER_FAILED:case c("P2PPaymentRequestStatus").CANCELED:return this.getRequestCanceledSnippet.apply(this,r)}return this.getRequestSentSnippet.apply(this,r)},getTransferCanceledSnippet:function j(k,l,m,n,o){if(k)return h._("Your {amount} payment to {receiver_name} was canceled.",[h.param("amount",o),h.param("receiver_name",n)]);else if(l)return h._("{sender name}'s {amount} payment was canceled.",[h.param("sender name",m),h.param("amount",o)]);else return h._("{sender_name}'s {amount} payment to {receiver_name} was canceled.",[h.param("sender_name",m),h.param("amount",o),h.param("receiver_name",n)])},getTransferDeclinedSnippet:function j(k,l,m,n,o){if(k)return h._("{receiver_name} didn't accept your {amount} payment.",[h.param("receiver_name",n),h.param("amount",o)]);else if(l)return h._("You didn't accept {sender name}'s {amount} payment.",[h.param("sender name",m),h.param("amount",o)]);else return h._("{receiver_name} didn't accept {sender_name}'s {amount} payment.",[h.param("receiver_name",n),h.param("sender_name",m),h.param("amount",o)])},getTransferSentSnippet:function j(k,l,m,n,o){if(k)return h._("You sent {receiver name} {amount}.",[h.param("receiver name",n),h.param("amount",o)]);else if(l)return h._("{name} sent you {amount}.",[h.param("name",m),h.param("amount",o)]);else return h._("{sender name} sent {receiver name} {amount}.",[h.param("sender name",m),h.param("receiver name",n),h.param("amount",o)])},getTransferSnippetByStatus:function j(k,l,m,n,o,p){var q=[l,m,n,o,p],r=k||c("P2PTransferStatus").PENDING_SENDER_INITED;switch(r){case c("P2PTransferStatus").CANCELED_DECLINED:return this.getTransferDeclinedSnippet.apply(this,q);case c("P2PTransferStatus").CANCELED_SENDER_RISK:case c("P2PTransferStatus").CANCELED_RECIPIENT_RISK:case c("P2PTransferStatus").CANCELED_SYSTEM_FAIL:case c("P2PTransferStatus").CANCELED_EXPIRED:case c("P2PTransferStatus").CANCELED_SAME_CARD:return this.getTransferCanceledSnippet.apply(this,q)}return this.getTransferSentSnippet.apply(this,q)}};f.exports=i}),null);
__d("MercuryAttachmentSnippetRenderer",["fbt","CurrentUser","MercuryAttachmentSnippetType","MercuryAttachmentType","MercuryAudioType","MercuryGiftSnippetRenderer","MessengerLightweightActionUtils","P2PSnippetStringUtils","StickerConstants","StoryAttachmentStyle"],(function a(b,c,d,e,f,g,h){"use strict";__p&&__p();var i={getAttachmentSnippetType:function j(k){__p&&__p();if(this._hasOnlyPhotos(k))return c("MercuryAttachmentSnippetType").PHOTO;if(this._hasOnlyAnimatedImages(k))return c("MercuryAttachmentSnippetType").GIF;if(this._hasOnlyVideo(k))return c("MercuryAttachmentSnippetType").VIDEO;if(this._hasAudioClip(k))return c("MercuryAttachmentSnippetType").AUDIO_CLIP;if(this._hasLikeSticker(k))return c("MercuryAttachmentSnippetType").LIKE_STICKER;if(this._hasSticker(k))return c("MercuryAttachmentSnippetType").STICKER;if(this._hasThirdPartySticker(k))return c("MercuryAttachmentSnippetType").THIRDPARTYSTICKER;if(this._hasShare(k))return c("MercuryAttachmentSnippetType").SHARE;if(this._hasGift(k))return c("MercuryAttachmentSnippetType").GIFT;if(this._hasError(k))return c("MercuryAttachmentSnippetType").ERROR;if(this._hasFile(k))return c("MercuryAttachmentSnippetType").FILE;return c("MercuryAttachmentSnippetType").MIXED},renderAttachmentSnippetText:function j(k,l,m,n){__p&&__p();switch(k){case c("MercuryAttachmentSnippetType").PHOTO:return this._renderPhotoAttachmentSnippetText(l,m,this._getPhotoAttachments(n));case c("MercuryAttachmentSnippetType").GIF:return this._renderAnimatedImagesAttachmentSnippetText(l,m,this._getAnimatedImageAttachments(n));case c("MercuryAttachmentSnippetType").VIDEO:return l?h._("You sent a video."):h._("{sender name} sent a video.",[h.param("sender name",m)]);case c("MercuryAttachmentSnippetType").AUDIO_CLIP:return l?h._("You sent a voice message."):h._("{name} sent a voice message.",[h.param("name",m)]);case c("MercuryAttachmentSnippetType").STICKER:case c("MercuryAttachmentSnippetType").LIKE_STICKER:case c("MercuryAttachmentSnippetType").THIRDPARTYSTICKER:return l?h._("You sent a sticker."):h._("{name} sent a sticker.",[h.param("name",m)]);case c("MercuryAttachmentSnippetType").SHARE:if(n&&this._hasP2PPayment(n))return this._renderP2PPaymentSnippetText(n[0]);if(n&&this._hasP2PPaymentRequest(n))return this._renderP2PPaymentRequestSnippetText(n[0]);if(n&&this._hasBusinessMessage(n))return this._renderBusinessMessageSnippetText(n[0],m);if(n&&this._hasLocation(n))return l?h._("You sent a location."):h._("{sender name} sent a location.",[h.param("sender name",m)]);if(n&&this._hasLiveLocation(n))return l?h._("You sent a live location."):h._("{sender name} sent a live location.",[h.param("sender name",m)]);if(n&&n.length===1&&c("MessengerLightweightActionUtils").isLWAAttachment(n[0]))return c("MessengerLightweightActionUtils").getLWASnippetText(n);return l?h._("You sent a link."):h._("{sender name} sent a link.",[h.param("sender name",m)]);case c("MercuryAttachmentSnippetType").GIFT:return c("MercuryGiftSnippetRenderer").renderText(l,m);case c("MercuryAttachmentSnippetType").FILE:return l?h._("You sent an attachment."):h._("{sender name} sent an attachment.",[h.param("sender name",m)]);case c("MercuryAttachmentSnippetType").ERROR:return l?h._("You sent an attachment."):h._("{sender name} sent an attachment.",[h.param("sender name",m)]);default:return""}},_hasOnlyPhotos:function j(k){return this._getPhotoAttachments(k).length===k.length},_hasThirdPartySticker:function j(k){return k.length===1&&k[0].attach_type===c("MercuryAttachmentType").THIRDPARTYSTICKER},_hasOnlyAnimatedImages:function j(k){return this._getAnimatedImageAttachments(k).length===k.length},_hasOnlyVideo:function j(k){return k.length===1&&k[0].attach_type===c("MercuryAttachmentType").VIDEO},_hasAudioClip:function j(k){var l=k[0].metadata&&k[0].metadata.type;return k.length===1&&(l===c("MercuryAudioType").AudioClip||l===c("MercuryAudioType").VoiceMessageWithTranscript)},_hasBusinessMessage:function j(k){return this._hasSingleShareAttachmentOfStyle(k,c("StoryAttachmentStyle").BUSINESS_MESSAGE_ITEMS)},_hasSticker:function j(k){return k.length===1&&k[0].attach_type===c("MercuryAttachmentType").STICKER},_hasLikeSticker:function j(k){if(k.length<1)return false;var l=k[0].metadata&&k[0].metadata.stickerID;return k.length===1&&(l==c("StickerConstants").LIKE_STICKER_ID||l==c("StickerConstants").HOT_LIKE_SMALL_STICKER_ID||l==c("StickerConstants").HOT_LIKE_MEDIUM_STICKER_ID||l==c("StickerConstants").HOT_LIKE_LARGE_STICKER_ID)},_hasLocation:function j(k){return this._hasSingleShareAttachmentOfStyle(k,c("StoryAttachmentStyle").MESSAGE_LOCATION)},_hasLiveLocation:function j(k){return this._hasSingleShareAttachmentOfStyle(k,c("StoryAttachmentStyle").MESSAGE_LIVE_LOCATION)},_hasP2PPayment:function j(k){return this._hasSingleShareAttachmentOfStyle(k,c("StoryAttachmentStyle").ORION)},_hasP2PPaymentRequest:function j(k){return this._hasSingleShareAttachmentOfStyle(k,c("StoryAttachmentStyle").ORION_REQUEST)},_hasSingleShareAttachmentOfStyle:function j(k,l){return k.length===1&&k[0].attach_type===c("MercuryAttachmentType").SHARE&&k[0].share.style_list.indexOf(l)>=0},_hasShare:function j(k){return k.length===1&&k[0].attach_type===c("MercuryAttachmentType").SHARE},_hasError:function j(k){return k.length===1&&k[0].attach_type===c("MercuryAttachmentType").ERROR},_hasGift:function j(k){return k.length===1&&k[0].attach_type===c("MercuryAttachmentType").GIFT},_hasFile:function j(k){return k.length===1&&k[0].attach_type===c("MercuryAttachmentType").FILE},_getPhotoAttachments:function j(k){if(!k)return[];return k.filter(function(l){return l.attach_type===c("MercuryAttachmentType").PHOTO})},_getAnimatedImageAttachments:function j(k){if(!k)return[];return k.filter(function(l){return l.attach_type===c("MercuryAttachmentType").ANIMATED_IMAGE})},_renderPhotoAttachmentSnippetText:function j(k,l,m){if(m.length===1)if(k)return h._("You sent a photo.");else return h._("{name} sent a photo.",[h.param("name",l)]);else if(k)return h._({"*":"You sent {num_photos} photos."},[h.param("num_photos",m.length,[0])]);else return h._({"*":"{name} sent {num_photos} photos."},[h.param("name",l),h.param("num_photos",m.length,[0])])},_renderAnimatedImagesAttachmentSnippetText:function j(k,l,m){if(m.length===1)if(k)return h._("You sent a GIF.");else return h._("{name} sent a GIF.",[h.param("name",l)]);else if(k)return h._("You sent {num_animated_images} GIFs.",[h.param("num_animated_images",m.length)]);else return h._("{name} sent {num_animated_images} GIFs.",[h.param("name",l),h.param("num_animated_images",m.length)])},_renderBusinessMessageSnippetText:function j(k,l){var m=k.share.target,n=m&&m.message||h._("{sender name} sent an attachment.",[h.param("sender name",l)]);return n},_renderP2PPaymentSnippetText:function j(k){var l=k.share.target;return this.renderP2PPaymentSnippetText(c("CurrentUser").getID()===l.sender.id,l.sender.name,l.amountWithSymbol,l.status,c("CurrentUser").getID()===l.receiver.id,l.receiver.name)},_renderP2PPaymentRequestSnippetText:function j(k){var l=k.share.target;return this.renderP2PPaymentRequestSnippetText(c("CurrentUser").getID()===l.requester.id,l.requester.name,l.amountWithSymbol,l.currentStatus,c("CurrentUser").getID()===l.requestee.id,l.requestee.name)},renderP2PPaymentSnippetText:function j(k,l,m,n,o,p){return c("P2PSnippetStringUtils").getTransferSnippetByStatus(n,k,o||false,l||"",p||"",m)},renderP2PPaymentRequestSnippetText:function j(k,l,m,n,o,p){return c("P2PSnippetStringUtils").getRequestSnippetByStatus(n,k,o||false,l||"",p||"",m)}};f.exports=i}),null);