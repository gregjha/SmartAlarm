if (self.CavalryLogger) { CavalryLogger.start_js(["ARSKu"]); }

__d("MessengerReactions.react",["cx","fbt","Bootloader","CurrentUser","MercuryIDs","MercuryParticipants","MessengerEnvironment","MessengerReactionsUtil","MessengerReactionsPrompt.react","MessengerTextWithEmoticons.react","MessengerWebViewReactionsTypedLogger","MercuryConfig","TooltipData","React","ShimButton.react"],(function a(b,c,d,e,f,g,h,i){"use strict";__p&&__p();var j,k,l=c("React").PropTypes,m="ALL",n=c("CurrentUser").getID(),o=3,p=9;j=babelHelpers.inherits(q,c("React").Component);k=j&&j.prototype;function q(){__p&&__p();var r,s;for(var t=arguments.length,u=Array(t),v=0;v<t;v++)u[v]=arguments[v];return s=(r=k.constructor).call.apply(r,[this].concat(u)),this.$MessengerReactions2=function(){var w=c("MessengerEnvironment").messengerui,x=this.props,y=x.isFromViewer,z=x.message,A=x.participants,B=z.reactions;new(c("MessengerWebViewReactionsTypedLogger"))().setEvent("open_details").setMid(z.message_id).setSenderID(z.author).setEmojiGroup(m).setEmojiGroupCount(Object.values(B).length).log();if(w)c("Bootloader").loadModules(["messengerDialogsRe","messengerReactionsDialogReact"],function(C,D){var E=D.jsComponent;C.showDialog(function(){return c("React").createElement(E,{isFromViewer:y,participants:A,message:z})})},"MessengerReactions.react");else c("Bootloader").loadModules(["ChatReactionsDialog"],function(C){C.show(z,A,y)},"MessengerReactions.react")}.bind(this),s}q.prototype.render=function(){__p&&__p();var r=this.props,s=r.message,t=r.participants,u=r.renderQuickAdd,v=r.hovered,w=s.reactions,x=s.attachments;if(!v&&c("MercuryConfig").MessengerForwardButtonForSharedLinksQE&&x&&x.length===1&&x[0].attach_type==="share"&&w&&Object.keys(w).length===0)return null;if((!w||!t)&&!u)return null;var y={},z=0,A=false;Object.entries(w||{}).forEach(function(F){var G=F[0],H=F[1];if(typeof H==="string"){if(G===n)A=true;if(!y[H])y[H]=0;y[H]++;z++}});var B=Object.keys(y).sort(c("MessengerReactionsUtil").sortFunction).slice(0,o).map(function(F,G,w){return c("React").createElement("span",{className:"_4kf5",style:{zIndex:w.length-G,marginLeft:G===0?0:"-4px"},key:F},c("React").createElement(c("MessengerTextWithEmoticons.react"),{customSize:true,renderEmoticons:true,renderEmoji:true,text:F}))}),C=z>0?c("React").createElement("span",{className:"_4kf5 _4kf6"+(A?" _fy2":"")},z):null,D=u&&!A?c("React").createElement("div",{className:"_aou _aov"},c("React").createElement("span",{className:"_aow"},c("React").createElement(c("MessengerReactionsPrompt.react"),{message:s,messageIsSelected:true,isQuickAdd:true}))):null,E=c("TooltipData").propsFor(this.$MessengerReactions1());return c("React").createElement("div",babelHelpers["extends"]({},E,{className:"_4kf7 preview"}),c("React").createElement(c("ShimButton.react"),{className:"_aou",onClick:this.$MessengerReactions2},B,C),D)};q.prototype.$MessengerReactions1=function(){__p&&__p();var r=this.props.message.reactions,s=this.props.participants;if(!r||!s)return"";var t=Object.keys(r),u=t.reduce(function(u,y){if(u.length>=p)return u;var z=c("MercuryIDs").getParticipantIDFromUserID(y),A=s.get(z)||c("MercuryParticipants").getNow(z),B=A&&A.name;if(B)u.push(B);return u},[]),v=u.length,w=u.join("\n");if(t.length>v){var x=i._("and {count} other(s)",[i.param("count",t.length-v)]);w+="\n"+x.toString()}return w};q.propTypes={isFromViewer:l.bool.isRequired,message:l.object.isRequired,participants:l.object,renderQuickAdd:l.bool,hovered:l.bool};f.exports=q}),null);