if (self.CavalryLogger) { CavalryLogger.start_js(["JiUej"]); }

__d("MessengerSharedPhotos.react",["cx","MessengerSharedPhoto.react","MessengerSpinner.react","MessengerSharedPhotosAlbumViewContainer.react","React","RelayClassic","react-relay/classic/query/RelayQL","SpotlightViewer","SpotlightMessengerSharedMediaViewerContainer.react","Vector","cancelAnimationFrame","requestAnimationFrame"],(function a(b,c,d,e,f,g,h){"use strict";__p&&__p();var i,j,k=c("React").PropTypes,l=10,m=80;i=babelHelpers.inherits(n,c("React").Component);j=i&&i.prototype;function n(){__p&&__p();var o,p;for(var q=arguments.length,r=Array(q),s=0;s<q;s++)r[s]=arguments[s];return p=(o=j.constructor).call.apply(o,[this].concat(r)),this.state={albumView:null,imagesLoaded:l,shownID:null},this.$MessengerSharedPhotos1=null,this.$MessengerSharedPhotos5=function(t){this.setState({shownID:t})}.bind(this),this.$MessengerSharedPhotos6=function(t){this.setState({shownID:t},function(){this.$MessengerSharedPhotos3(this.state.shownID);this.$MessengerSharedPhotos7()}.bind(this))}.bind(this),this.$MessengerSharedPhotos8=function(t){this.setState({shownID:t})}.bind(this),this.$MessengerSharedPhotos7=function(){this.setState({albumView:null})}.bind(this),this.$MessengerSharedPhotos9=function(t){this.setState({albumView:t,shownID:null})}.bind(this),this.$MessengerSharedPhotos10=function(t){this.setState({albumView:null,shownID:t})}.bind(this),this.$MessengerSharedPhotos11=function(){this.setState({shownID:null})}.bind(this),p}n.prototype.componentDidMount=function(){this.$MessengerSharedPhotos2()};n.prototype.componentWillReceiveProps=function(o){if(o.threadFBID!==this.props.threadFBID)this.setState({imagesLoaded:l})};n.prototype.componentDidUpdate=function(){this.$MessengerSharedPhotos2()};n.prototype.componentWillUnmount=function(){c("cancelAnimationFrame")(this.$MessengerSharedPhotos1)};n.prototype.shouldComponentUpdate=function(o,p){var q=o.sharedPhotoAndVideos,r=q.edges,s=q.pageInfo&&q.pageInfo.has_next_page,t=r.find(function(u){var t=u.node;return t.id===p.shownID});if(!t&&s&&r.length<p.imagesLoaded){setTimeout(function(){return this.props.fetchMore(p.imagesLoaded)}.bind(this),1e3);return false}return true};n.prototype.$MessengerSharedPhotos2=function(){c("cancelAnimationFrame")(this.$MessengerSharedPhotos1);var o=this.props.sharedPhotoAndVideos;if(this.state.imagesLoaded<o.edges.length)this.$MessengerSharedPhotos1=c("requestAnimationFrame")(function(){this.setState({imagesLoaded:Math.min(o.edges.length,this.state.imagesLoaded+l)})}.bind(this));else if(!this.props.allPhotosDisplayed)this.props.onAllPhotosDisplayed()};n.prototype.$MessengerSharedPhotos3=function(o){var p=c("Vector").getViewportDimensions().x,q=this.props.sharedPhotoAndVideos.edges.length,r=this.props.sharedPhotoAndVideos.edges.find(function(v){return v.node.id===o});if(!r)return;var s=this.props.sharedPhotoAndVideos.edges.indexOf(r),t=(q-s)*m;if(t>p/2)return;var u=Math.ceil((p/2-t)/m);this.props.fetchMore(u)};n.prototype.$MessengerSharedPhotos4=function(o){var p=this.props.sharedPhotoAndVideos,q=p.edges.find(function(r){var s=r.node;return s.id===o});return q.node};n.prototype.$MessengerSharedPhotos12=function(){return c("React").createElement(c("SpotlightMessengerSharedMediaViewerContainer.react"),{onClosePhotoView:this.$MessengerSharedPhotos11,openAlbum:this.$MessengerSharedPhotos9,photoID:this.state.shownID,rootClassName:"",threadID:this.props.threadFBID,disableForward:false})};n.prototype.$MessengerSharedPhotos13=function(){return c("React").createElement(c("SpotlightViewer"),{className:"_3ode",onHide:this.$MessengerSharedPhotos7,open:true,ref:"spotlightViewer"},c("React").createElement(c("MessengerSharedPhotosAlbumViewContainer.react"),{onClick:this.$MessengerSharedPhotos10,onCloseSharedPhotos:this.$MessengerSharedPhotos7,threadID:this.props.threadFBID,viewedPhoto:this.state.albumView}))};n.prototype.$MessengerSharedPhotos14=function(){return c("React").createElement("div",{className:"_2n20"},c("React").createElement(c("MessengerSpinner.react"),null))};n.prototype.render=function(){var o=this.props,p=o.isLoadingImages,q=o.sharedPhotoAndVideos,r=q,s=r.edges,t=this.state.imagesLoaded,u="_3m31",v=this.$MessengerSharedPhotos5,w=p?this.$MessengerSharedPhotos14():null,x=this.state.shownID?this.$MessengerSharedPhotos12():null,y=this.state.albumView?this.$MessengerSharedPhotos13():null;return c("React").createElement("div",null,x,y,c("React").createElement("div",{className:"_40jj _5l-3"},s.slice(0,t).filter(function(z){var A=z.node;return!!A.image}).map(function(z){var A=z.node,B=A.photo_encodings?A.photo_encodings.length!==0:false;return c("React").createElement(c("MessengerSharedPhoto.react"),{className:u,fbid:A.legacy_attachment_id,key:A.legacy_attachment_id,onClick:v,photoID:A.id,uri:A.image.uri,isSpherical:B})})),w)};n.propTypes={allPhotosDisplayed:k.bool.isRequired,isLoadingImages:k.bool.isRequired,fetchMore:k.func.isRequired,onAllPhotosDisplayed:k.func.isRequired,sharedPhotoAndVideos:k.object.isRequired,threadFBID:k.string.isRequired};f.exports=c("RelayClassic").createContainer(n,{fragments:{sharedPhotoAndVideos:function o(){return function(){return{children:[{children:[{children:[{fieldName:"__typename",kind:"Field",metadata:{isGenerated:true,isRequisite:true},type:"String"},{children:[{fieldName:"id",kind:"Field",metadata:{isRequisite:true},type:"ID"},{fieldName:"__typename",kind:"Field",metadata:{isGenerated:true,isRequisite:true},type:"String"}],id:c("react-relay/classic/query/RelayQL").__id(),kind:"Fragment",metadata:{isAbstract:true},name:"Node",type:"Node"},{children:[{fieldName:"legacy_attachment_id",kind:"Field",metadata:{},type:"ID"},{calls:[{kind:"Call",metadata:{type:"Int"},name:"width",value:{kind:"CallValue",callValue:250}},{kind:"Call",metadata:{type:"Int"},name:"height",value:{kind:"CallValue",callValue:250}}],children:[{fieldName:"uri",kind:"Field",metadata:{},type:"Url"}],fieldName:"image",kind:"Field",metadata:{canHaveSubselections:true},type:"Image"},{children:[{fieldName:"x",kind:"Field",metadata:{},type:"Float"},{fieldName:"y",kind:"Field",metadata:{},type:"Float"}],fieldName:"original_dimensions",kind:"Field",metadata:{canHaveSubselections:true},type:"Vect2"},{children:[{fieldName:"id",kind:"Field",metadata:{isRequisite:true},type:"ID"}],fieldName:"photo_encodings",kind:"Field",metadata:{canHaveSubselections:true,inferredRootCallName:"node",inferredPrimaryKey:"id",isPlural:true},type:"PhotoEncoding"},{fieldName:"id",kind:"Field",metadata:{isGenerated:true,isRequisite:true},type:"ID"}],id:c("react-relay/classic/query/RelayQL").__id(),kind:"Fragment",metadata:{},name:"MessageImage",type:"MessageImage"},{children:[{fieldName:"legacy_attachment_id",kind:"Field",metadata:{},type:"ID"},{calls:[{kind:"Call",metadata:{type:"Int"},name:"width",value:{kind:"CallValue",callValue:250}},{kind:"Call",metadata:{type:"Int"},name:"height",value:{kind:"CallValue",callValue:250}}],children:[{fieldName:"uri",kind:"Field",metadata:{},type:"Url"}],fieldName:"image",kind:"Field",metadata:{canHaveSubselections:true},type:"Image"},{children:[{fieldName:"x",kind:"Field",metadata:{},type:"Float"},{fieldName:"y",kind:"Field",metadata:{},type:"Float"}],fieldName:"original_dimensions",kind:"Field",metadata:{canHaveSubselections:true},type:"Vect2"},{fieldName:"id",kind:"Field",metadata:{isGenerated:true,isRequisite:true},type:"ID"}],id:c("react-relay/classic/query/RelayQL").__id(),kind:"Fragment",metadata:{},name:"MessageVideo",type:"MessageVideo"}],fieldName:"node",kind:"Field",metadata:{canHaveSubselections:true,inferredRootCallName:"node",inferredPrimaryKey:"id",isAbstract:true,isRequisite:true},type:"MessageSharedPhotoAndVideo"},{fieldName:"cursor",kind:"Field",metadata:{isGenerated:true,isRequisite:true},type:"ID"}],fieldName:"edges",kind:"Field",metadata:{canHaveSubselections:true,isPlural:true},type:"MessageSharedPhotoAndVideoEdge"},{fieldName:"count",kind:"Field",metadata:{},type:"Int"},{children:[{fieldName:"has_next_page",kind:"Field",metadata:{isRequisite:true},type:"Boolean"},{fieldName:"has_previous_page",kind:"Field",metadata:{isGenerated:true,isRequisite:true},type:"Boolean"}],fieldName:"page_info",kind:"Field",metadata:{canHaveSubselections:true,isRequisite:true},type:"PageInfo"}],id:c("react-relay/classic/query/RelayQL").__id(),kind:"Fragment",metadata:{},name:"MessengerSharedPhotos_react_SharedPhotoAndVideosRelayQL",type:"MessageSharedPhotoAndVideoConnection"}}()}}})}),null);