if (self.CavalryLogger) { CavalryLogger.start_js(["kOLkj"]); }

__d("MercuryAudioPlayer",["Arbiter","DOM","Event","Flash"],(function a(b,c,d,e,f,g){__p&&__p();var h=200;function i(){var r=c("DOM").create("audio"),s=false;try{if(!!r.canPlayType)if(r.canPlayType("video/mp4;").replace(/^no$/,""))s=true}finally{return s}}function j(){return c("Flash").isAvailable()}var k=function k(){__p&&__p();this.interval=null;this.arbiterInstance=null;this.audio=c("DOM").create("audio");c("Event").listen(this.audio,"playing",function(){this.informAttachment("playing",this.audio.currentTime);this.interval=setInterval(function(){this.informAttachment("playing",this.audio.currentTime)}.bind(this),h)}.bind(this));c("Event").listen(this.audio,"ended",function(){clearInterval(this.interval);this.informAttachment("finished")}.bind(this))};Object.assign(k.prototype,{setAudio:function r(s,t){this.audio.setAttribute("src",s);this.arbiterInstance=t},informAttachment:function r(s,t){if(this.arbiterInstance)this.arbiterInstance.inform(s,t)},play:function r(){this.audio.play();this.informAttachment("played")},resume:function r(){this.audio.play();this.informAttachment("played")},pause:function r(){this.audio.pause();clearInterval(this.interval);this.informAttachment("paused")},getType:function r(){return"html5"}});var l=function l(){this.src=null;this.arbiterInstance=null;var r=c("DOM").create("div");document.body.appendChild(r);this.swf=c("Flash").embed("/swf/cigars/SoundStreamPlayer.swf",r,null,{});this.interval=null;c("Arbiter").subscribe("soundstream/finished",function(){clearInterval(this.interval);this.informAttachment("finished")}.bind(this))};Object.assign(l.prototype,{setAudio:function r(s,t){this.src=s;this.arbiterInstance=t},informAttachment:function r(s,t){if(this.arbiterInstance)this.arbiterInstance.inform(s,t)},play:function r(){this.swf.playSound(this.src);this.interval=setInterval(function(){var s=this.swf.getCurrentTime();this.informAttachment("playing",s)}.bind(this),h);this.informAttachment("played")},resume:function r(){this.swf.resume();this.informAttachment("played")},pause:function r(){clearInterval(this.interval);this.swf.pause();this.informAttachment("paused")},getType:function r(){return"flash"}});function m(){if(i())return new k();else if(j())return new l();return false}var n=null,o=null,p=0;function q(r,s){this.src=r;this.arbiterInstance=s;this.audio_id=++p;n!==null||(n=m());if(!n)return false}Object.assign(q.prototype,{getType:function r(){if(!n)return false;else return n.getType()},play:function r(s){if(s&&o==this.audio_id)n.resume();else{this.pause();o=this.audio_id;n.setAudio(this.src,this.arbiterInstance);n.play()}},pause:function r(){n.pause()}});f.exports=q}),null);