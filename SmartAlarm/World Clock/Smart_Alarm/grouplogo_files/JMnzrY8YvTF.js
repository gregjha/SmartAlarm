if (self.CavalryLogger) { CavalryLogger.start_js(["jp3\/p"]); }

__d("ContextualDialogXUITheme",["cx"],(function a(b,c,d,e,f,g,h){var i={wrapperClassName:"_53ii",arrowDimensions:{offset:12,length:16}};f.exports=i}),null);
__d("XUIContextualDialogBody.react",["React"],(function a(b,c,d,e,f,g){__p&&__p();var h,i;h=babelHelpers.inherits(j,c("React").Component);i=h&&h.prototype;j.prototype.render=function(){"use strict";return c("React").createElement("div",{className:this.props.className},this.props.children)};function j(){"use strict";h.apply(this,arguments)}f.exports=j}),null);
__d("XUIContextualDialogFooter.react",["cx","React","XUIOverlayFooter.react"],(function a(b,c,d,e,f,g,h){__p&&__p();var i,j;i=babelHelpers.inherits(k,c("React").Component);j=i&&i.prototype;k.prototype.render=function(){"use strict";return c("React").createElement(c("XUIOverlayFooter.react"),{className:"_572u"},this.props.children)};function k(){"use strict";i.apply(this,arguments)}f.exports=k}),null);
__d("XUIContextualDialogTitle.react",["cx","React","joinClasses"],(function a(b,c,d,e,f,g,h){__p&&__p();var i,j;i=babelHelpers.inherits(k,c("React").Component);j=i&&i.prototype;k.prototype.render=function(){"use strict";var l=this.props.use,m=c("joinClasses")("_47lu"+(l==="primary"?" _47lv":"")+(l==="secondary"?" _47mc":""),this.props.className);return c("React").createElement("h3",{className:m,id:this.props.id},this.props.children)};function k(){"use strict";i.apply(this,arguments)}k.defaultProps={use:"primary"};f.exports=k}),null);
__d("XUIContextualDialog.react",["cx","fbt","ContextualDialogXUITheme","React","ReactAbstractContextualDialog","ReactLayer","XUIContextualDialogBody.react","XUIContextualDialogFooter.react","XUIContextualDialogTitle.react","joinClasses","uniqueID"],(function a(b,c,d,e,f,g,h,i){__p&&__p();var j,k,l=c("ReactLayer").createClass(c("ReactAbstractContextualDialog").createSpec({displayName:"ReactXUIContextualDialog",theme:c("ContextualDialogXUITheme")}));j=babelHelpers.inherits(m,c("React").Component);k=j&&j.prototype;function m(){"use strict";k.constructor.call(this);this.updatePosition=function(){var n=this.refs.dialog;if(n)n.layer.updatePosition()}.bind(this);this.$XUIContextualDialog1=this.$XUIContextualDialog1||c("uniqueID")()}m.prototype.$XUIContextualDialog2=function(){"use strict";return this.$XUIContextualDialog3(c("XUIContextualDialogBody.react"))};m.prototype.$XUIContextualDialog4=function(){"use strict";return this.$XUIContextualDialog3(c("XUIContextualDialogTitle.react"))};m.prototype.$XUIContextualDialog5=function(){"use strict";return this.$XUIContextualDialog3(c("XUIContextualDialogFooter.react"))};m.prototype.$XUIContextualDialog3=function(n){"use strict";var o=null;c("React").Children.forEach(this.props.children,function(p){if(!o&&p&&p.type===n)o=p});return o};m.prototype.$XUIContextualDialog6=function(){"use strict";return i._("Dialog content")};m.prototype.render=function(){"use strict";__p&&__p();var n=this.props.children,o=this.$XUIContextualDialog2(),p=this.$XUIContextualDialog4(),q={};if(this.props.labelledBy)q.labelledBy=this.props.labelledBy;else if(this.props.label)q.label=this.props.label;else if(p){p=c("React").cloneElement(p,{id:this.$XUIContextualDialog1});q.labelledBy=[this.$XUIContextualDialog1]}else q.label=this.$XUIContextualDialog6();if(o)n=c("React").createElement("div",{className:c("joinClasses")(this.props.className,"_53iv")},p,o);return c("React").createElement(l,babelHelpers["extends"]({},this.props,q,{ref:"dialog"}),n,o?this.$XUIContextualDialog5():null)};m.WIDTH={NORMAL:312,WIDE:400};m.defaultProps={dialogRole:"dialog",hasActionableContext:false,hideOnEscape:true};f.exports=m}),null);
__d("ChatEmojiButton.react",["cx","fbt","BootloadOnRender.react","ChatFlyoutPlaceholder.react","JSResource","LazyComponent.react","Link.react","ReactComponentWithPureRenderMixin","React","XUIContextualDialog.react","joinClasses"],(function a(b,c,d,e,f,g,h,i){"use strict";__p&&__p();var j=c("React").PropTypes,k=278,l=c("React").createClass({displayName:"ChatEmojiButton",_clickGuard:false,mixins:[c("ReactComponentWithPureRenderMixin")],propTypes:{ContextualDialogClass:j.func.isRequired,flyoutAlignment:j.oneOf(["left","right"]),fromChatTab:j.bool,onMount:j.func,onSelect:j.func,sendCustomEmoji:j.func,threadID:j.string},getDefaultProps:function m(){return{ContextualDialogClass:c("XUIContextualDialog.react"),flyoutAlignment:"left"}},getInitialState:function m(){return{shown:false}},componentDidMount:function m(){this.props.onMount&&this.props.onMount(this)},hideFlyout:function m(){this.setState(this.getInitialState());this.props.getInput&&this.props.getInput().focus()},render:function m(){return c("React").createElement(c("Link.react"),{className:c("joinClasses")(this.props.className,this.state.shown?"open":""),href:"#",onMouseDown:this._handleMouseDown,onClick:this._handleClick,role:"button",title:i._("Choose an emoji"),ref:"link"},this.renderLayers())},renderLayers:function m(){if(!this.state.shown)return null;var n=this.props.ContextualDialogClass;return c("React").createElement(n,{alignment:this.props.flyoutAlignment,contextRef:function(){return this.refs.link}.bind(this),offsetY:this.props.fromChatTab?-20:10,onBlur:this.hideFlyout,onToggle:this._handleContextualDialogToggle,shown:this.state.shown,width:k,key:"contextualDialog"},c("React").createElement(c("BootloadOnRender.react"),{component:c("React").createElement(c("LazyComponent.react"),{onCategorySelect:this._focusInput,onEscKeyDown:this.hideFlyout,onSelect:this._handleSelect,sendCustomEmoji:this.props.sendCustomEmoji,threadID:this.props.threadID,width:k}),loader:c("JSResource")("ChatEmojiFlyout.react").__setRef("ChatEmojiButton.react"),placeholder:c("React").createElement(c("ChatFlyoutPlaceholder.react"),null)}))},_focusInput:function m(){this.props.getInput&&this.props.getInput().focus()},_handleMouseDown:function m(){this._clickGuard=this.state.shown},_handleClick:function m(n){n.stopPropagation();if(this._clickGuard){this._clickGuard=false;return}this.setState({shown:!this.state.shown});this._focusInput()},_handleSelect:function m(n){this.props.onSelect&&this.props.onSelect(n)},_handleContextualDialogToggle:function m(n){this.setState({shown:n})}});f.exports=l}),null);
__d("MessengerSupportedEmojiUtils",["cx","EmojiImageURL","EmojiLikeConstants","EmojiRenderer","EmoticonEmojiList","Image.react","MessengerSupportedEmoji","React","Utf16","joinClasses"],(function a(b,c,d,e,f,g,h){"use strict";__p&&__p();var i=65039,j="_fe0f",k=new RegExp("(\r\n|[ \r\n]|s)"),l={getSupportedEmojiKey:function m(n){__p&&__p();if(!n)return null;var o=null,p=this.parse(n);if(p.length===1&&p[0].length===n.length){var q=p[0].emoji.map(function(r){return c("Utf16").decode(r)});q[q.length-1]===i&&q.pop();o=q.map(function(r){return r.toString(16)}).join("_")}return this.isSupportedEmojiKey(o)?o:null},isSupportedEmoji:function m(n){return!!this.getSupportedEmojiKey(n)},isSupportedEmojiKey:function m(n){return!!c("MessengerSupportedEmoji").emoji[n]},getSupportedEmojiCodesArray:function m(n){__p&&__p();if(!n)return null;var o=this.parse(n);if(o.length===1&&o[0].length===n.length){var p=o[0].emoji.map(function(r){return c("Utf16").decode(r)});p[p.length-1]===i&&p.pop();var q=p.map(function(r){return r.toString(16)}).join("_");if(c("MessengerSupportedEmoji").emoji[q])return p}return null},getEmojiKeyFromCodes:function m(n){return n.map(function(o){return o.toString(16)}).join("_")},getClassSizeMap:function m(){var n,o=c("EmojiLikeConstants").size;return n={},n[o.XSMALL]="_2560",n[o.SMALL]="_1ifu",n[o.MEDIUM]="_19_r",n[o.LARGE]="_19_s",n},getEmojiMatchObj:function m(n){__p&&__p();var o=this.parse(n,1);if(o.length!==1)return null;var p=o[0].emoji,q=p.map(function(s){return c("Utf16").decode(s)});if(q[q.length-1]===i)q.pop();var r=q.map(function(s){return s.toString(16)}).join("_");return{emoji_key:r,emoji_str:p.join(""),is_supported:this.isSupportedEmojiKey(r),offset:o[0].offset,length:o[0].length}},getNewEmojiData:function m(n,o){__p&&__p();if(!n)return null;var p=this.getSupportedEmojiKey(n);if(!p)return null;var q=this.getClassSizeMap();o=this.transferSize(o);if(!c("EmojiLikeConstants").sizeMap[o])o=c("EmojiLikeConstants").size.XSMALL;var r=c("joinClasses")(q[o],"_1ift"),s=c("EmojiImageURL").getMessengerURL(p,c("EmojiLikeConstants").sizeMap[o]);return{emoji:c("React").createElement(c("Image.react"),{className:r,src:s}),emoji_key:p,url:s}},getEmojiOnlyContents:function m(n){__p&&__p();var o=n||"",p=[];while(o.length>0&&o.trim().length>0){var q=k.exec(o),r="";while(q&&q.length&&q.index===0){r+=q[0];o=o.replace(k,"");q=k.exec(o)}if(r.length>0)p.push({text:r});var s=c("EmoticonEmojiList").noncapturingRegexp.exec(o);if(s&&s.index===0){var t=c("EmoticonEmojiList").names[s[1]],u=c("EmoticonEmojiList").emote2emojis[t];p.push({emojiKey:u,text:s[1]});o=o.replace(s[1],"")}else{s=this.getEmojiMatchObj(o);if(s&&s.is_supported){p.push({emojiKey:s.emoji_key,text:s.emoji_str});o=o.replace(s.emoji_str,"")}else return null}}return p},getUrl:function m(n,o){if(n.endsWith(j))n=n.replace(j,"");if(!c("MessengerSupportedEmoji").emoji[n])return null;o=this.transferSize(o);return c("EmojiImageURL").getMessengerURL(n,c("EmojiLikeConstants").sizeMap[o])},containsEmoji:function m(n){return this.parse(n,1).length===1},parse:function m(n,o){return c("EmojiRenderer").parse(n,o)},transferSize:function m(n){return c("EmojiLikeConstants").sizeMapTransfer[n]||n}};f.exports=l}),null);
__d("P2PLoadingMask.react",["cx","React","XUISpinner.react"],(function a(b,c,d,e,f,g,h){"use strict";__p&&__p();var i,j,k=c("React").PropTypes;i=babelHelpers.inherits(l,c("React").Component);j=i&&i.prototype;l.prototype.render=function(){if(!this.props.visible)return null;return c("React").createElement("div",{className:"_3de"},c("React").createElement(c("XUISpinner.react"),{background:"dark",size:"large",className:"_3df"}),c("React").createElement("div",{className:"_3dg"}))};function l(){i.apply(this,arguments)}l.propTypes={visible:k.bool};l.defaultProps={visible:false};f.exports=l}),null);
__d("P2PAbstractSendMoneyButton.react",["cx","fbt","React","TooltipLink.react","joinClasses"],(function a(b,c,d,e,f,g,h,i){"use strict";__p&&__p();var j,k;j=babelHelpers.inherits(l,c("React").Component);k=j&&j.prototype;function l(){__p&&__p();var m,n;for(var o=arguments.length,p=Array(o),q=0;q<o;q++)p[q]=arguments[q];return n=(m=k.constructor).call.apply(m,[this].concat(p)),this.$P2PAbstractSendMoneyButton1=false,this.$P2PAbstractSendMoneyButton3=function(){this.props.onMouseDown&&this.props.onMouseDown();this.$P2PAbstractSendMoneyButton1=this.props.isActive}.bind(this),this.$P2PAbstractSendMoneyButton2=function(r){r.stopPropagation();if(this.$P2PAbstractSendMoneyButton1){this.$P2PAbstractSendMoneyButton1=false;return}this.props.onClick()}.bind(this),n}l.prototype.render=function(){return c("React").createElement(c("TooltipLink.react"),{alignH:"center",className:c("joinClasses")(this.props.className,(this.props.isActive?"open":"")+(this.props.isDisabled?" disabled":"")+(this.props.isActive?" _10gz":"")+(this.props.isDisabled?" _10g-":"")+(!this.props.isMessenger&&!this.props.className?" _5uqy":"")+(this.props.isMessenger?" _3ggc":"")),href:"#",onClick:this.$P2PAbstractSendMoneyButton2,onMouseDown:this.$P2PAbstractSendMoneyButton3,onMouseOver:this.props.onMouseOver,position:"above",role:"button",title:this.$P2PAbstractSendMoneyButton4()},this.getButton())};l.prototype.getButton=function(){if(this.props.button)return this.props.button;return c("React").createElement("i",{className:"_5s8l"})};l.prototype.$P2PAbstractSendMoneyButton4=function(){if(this.props.isDisabled)return null;return i._("Send Money")};f.exports=l}),null);
__d("P2PSendMoneyDialogStore",["P2PActionConstants","EventEmitter","Map","P2PDispatcher"],(function a(b,c,d,e,f,g){"use strict";__p&&__p();var h,i,j=36,k=void 0,l=void 0;h=babelHelpers.inherits(m,c("EventEmitter"));i=h&&h.prototype;function m(){i.constructor.call(this);l=new(c("Map"))();k=c("P2PDispatcher").register(this.onEventDispatched.bind(this))}m.prototype.onEventDispatched=function(n){var o=n.data,p=n.type;switch(p){case c("P2PActionConstants").CHAT_SEND_VIEW_OPENED:this.handleChatSendViewOpened(o);this.emit("change");break;case c("P2PActionConstants").CHAT_SEND_VIEW_CLOSED:this.handleChatSendViewClosed(o);this.emit("change");break}};m.prototype.getStateByThreadID=function(n){return l.get(n)};m.prototype.handleChatSendViewOpened=function(n){l.set(n.threadID,{amount:n.amount,groupSendRecipientUserIDs:n.groupSendRecipientUserIDs,groupSendReceiptDetails:n.groupSendReceiptDetails,groupThreadFBID:n.groupThreadFBID,onCompletion:n.onCompletion,openRequestTab:n.openRequestTab,memoText:n.memoText&&n.memoText.substr(0,j),platformData:n.platformData,referrer:n.referrer,paymentRequestID:n.paymentRequestID,sendMoneyDialogShown:true,sendMoneyNUXDismissed:n.sendMoneyNUXDismissed,useModal:n.useModal})};m.prototype.handleChatSendViewClosed=function(n){l.set(n.threadID,{amount:"",groupSendRecipientUserIDs:[],groupSendReceiptDetails:null,groupThreadFBID:"",onCompletion:null,openRequestTab:false,memoText:null,platformData:null,referrer:null,paymentRequestID:null,sendMoneyDialogShown:false,sendMoneyNUXDismissed:false,useModal:false})};m.prototype.isAnyChatSendViewOpen=function(){__p&&__p();for(var n=l.values(),o=Array.isArray(n),p=0,n=o?n:n[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){var q;if(o){if(p>=n.length)break;q=n[p++]}else{p=n.next();if(p.done)break;q=p.value}var r=q;if(r.sendMoneyDialogShown)return true}return false};f.exports=new m()}),null);
__d("P2PSendMoneyContainerBootloader.react",["cx","Bootloader","MessengerEnvironment","DeferredComponent.react","MercuryIDs","P2PAbstractSendMoneyButton.react","P2PActions","P2PLoadingMask.react","P2PLogger","P2PPaymentLoggerEvent","P2PPaymentLoggerEventFlow","P2PSendMoneyDialogStore","React","ReactLayeredComponentMixin_DEPRECATED","XUIContextualDialog.react","emptyFunction","getPageIDFromThreadID"],(function a(b,c,d,e,f,g,h){"use strict";__p&&__p();var i=c("React").PropTypes,j=c("MessengerEnvironment").messengerui,k=j?282:260,l=c("React").createClass({displayName:"P2PSendMoneyContainerBootloader",propTypes:{button:i.node,className:i.string,ContextualDialog:i.func,flyoutAlignment:i.oneOf(["left","center","right"]),onTrigger:i.func,participantIDs:i.array,referrer:i.string,threadID:i.string},getInitialState:function m(){return{showPlaceholderDialog:false,shouldBootloadImmediately:c("P2PSendMoneyDialogStore").isAnyChatSendViewOpen()}},mixins:[c("ReactLayeredComponentMixin_DEPRECATED")],_clicked:false,_onComponentLoad:c("emptyFunction"),_bootloadCalled:false,_sendMoneyDialogStoreSub:null,log:function m(n,o){c("P2PLogger").log(n,babelHelpers["extends"]({www_event_referrer:this.props.referrer,www_event_flow:c("P2PPaymentLoggerEventFlow").UI_FLOW_P2P_SEND},o))},componentWillUnmount:function m(){this.removeDialogStoreSub()},onDialogStoreChange:function m(){this._bootloadComponentNow();this.removeDialogStoreSub()},removeDialogStoreSub:function m(){if(this._sendMoneyDialogStoreSub){this._sendMoneyDialogStoreSub.remove();this._sendMoneyDialogStoreSub=null}},onPlaceholderClick:function m(){var n=this.props.threadID?c("MercuryIDs").tokenize(this.props.threadID).value:null;this._handleDialogVisibility(!this.state.showPlaceholderDialog);this.log(c("P2PPaymentLoggerEvent").UI_ACTN_SEND_MONEY_BUTTON_PLACEHOLDER_CLICKED,{object_id:n});this._bootloadComponentNow();this._clicked=false},_handleDialogVisibility:function m(n){if(!n)c("P2PActions").chatSendViewClosed({threadID:this.props.threadID});else c("P2PActions").chatSendViewOpened({referrer:this.props.referrer,threadID:this.props.threadID});this.setState({showPlaceholderDialog:n})},renderLayers:function m(){__p&&__p();var n={};if(this.state.showPlaceholderDialog){var o=this.props.ContextualDialog||c("XUIContextualDialog.react");n.placeholderDialog=c("React").createElement(o,{alignment:this.props.flyoutAlignment?this.props.flyoutAlignment:j?"right":"left",contextRef:function(){return this.refs.placeholderButton}.bind(this),onBlur:function(){if(!this._clicked)this._handleDialogVisibility(false);this._clicked=false}.bind(this),ref:"dialog",shown:true,width:k,position:"above"},c("React").createElement("div",{className:"_c_5"},c("React").createElement(c("P2PLoadingMask.react"),{visible:true})))}return n},render:function m(){if(this._isPageChat())return null;return c("React").createElement(c("DeferredComponent.react"),babelHelpers["extends"]({deferredComponent:this._bootloadComponent,deferredPlaceholder:this._renderPlaceholder()},this.props))},_renderPlaceholder:function m(){return c("React").createElement(c("P2PAbstractSendMoneyButton.react"),{button:this.props.button,className:this.props.className,isActive:false,isDisabled:false,isMessenger:j,onClick:this.onPlaceholderClick,onMouseDown:function(){this._clicked=true}.bind(this),onMouseOver:this._bootloadComponentNow,ref:"placeholderButton"})},_bootloadComponent:function m(n){this._onComponentLoad=n.bind(this);if(this.state.shouldBootloadImmediately)this._bootloadComponentNow();else this._sendMoneyDialogStoreSub=c("P2PSendMoneyDialogStore").addListener("change",this.onDialogStoreChange)},_bootloadComponentNow:function m(){if(this._bootloadCalled)return;this._bootloadCalled=true;c("Bootloader").loadModules(["P2PSendMoneyContainer.react"],function(n){this.removeDialogStoreSub();this._onComponentLoad(n);this.setState({showPlaceholderDialog:false})}.bind(this),"P2PSendMoneyContainerBootloader.react")},_isPageChat:function m(){return!!this._getPageID()},_getPageID:function m(){return c("getPageIDFromThreadID")(this.props.threadID)}});f.exports=l}),null);