if (self.CavalryLogger) { CavalryLogger.start_js(["4yTBb"]); }

__d("MessengerURLUploader",["AsyncRequest","Event","MessengerActions","SubscriptionsHandler","URLMatcher","XShareScrapeAttachmentAsyncController","debounce","gkx"],(function a(b,c,d,e,f,g){"use strict";__p&&__p();var h=c("XShareScrapeAttachmentAsyncController").getURIBuilder().getURI(),i=920,j=920;function k(l,m,n){__p&&__p();this.handleInputValueChange=function(o){__p&&__p();var p=this.$MessengerURLUploader3(),q=c("URLMatcher").match(p);if(!!q){if(this.$MessengerURLUploader5!==q){this.$MessengerURLUploader5=q;this.$MessengerURLUploader2=null;if(c("gkx")("AT5M-KOnq98igVULtzbIXLLujZOrcPEb_vzPxIrrMO4yDC59FjeQpdoZs2nMsaoB9WIY9SOWsfOkycr87iOYdoQQ"))c("MessengerActions").loadingPreview(this.$MessengerURLUploader7,q);this.loadShare()}}else if(!c("gkx")("AT5M-KOnq98igVULtzbIXLLujZOrcPEb_vzPxIrrMO4yDC59FjeQpdoZs2nMsaoB9WIY9SOWsfOkycr87iOYdoQQ")){this.$MessengerURLUploader5=null;this.$MessengerURLUploader2=null}}.bind(this);this.$MessengerURLUploader3=l;this.$MessengerURLUploader6=new(c("SubscriptionsHandler"))();this.$MessengerURLUploader7=n;this.$MessengerURLUploader4=c("debounce")(this.handleInputValueChange,200);this.initInput(m)}k.prototype.getData=function(){return this.$MessengerURLUploader2};k.prototype.getMatchedURL=function(){return this.$MessengerURLUploader5};k.prototype.initInput=function(l){this.$MessengerURLUploader6.addSubscriptions(c("Event").listen(l,"keyup",this.$MessengerURLUploader4),c("Event").listen(l,"paste",this.$MessengerURLUploader4))};k.prototype.loadShare=function(){if(this.$MessengerURLUploader1&&this.$MessengerURLUploader1.abort)this.$MessengerURLUploader1.abort();var l=this.$MessengerURLUploader5;if(l)this.$MessengerURLUploader1=new(c("AsyncRequest"))().setMethod("POST").setURI(h).setData({uri:l,image_width:j,image_height:i,disallow_delayed:true}).setHandler(this.handleShareLoad.bind(this,l)).send()};k.prototype.handleShareLoad=function(l,m){if(l===this.$MessengerURLUploader5)this.$MessengerURLUploader2=(m.payload||0).share_data};k.prototype.setThreadID=function(l){this.$MessengerURLUploader7=l};k.prototype.clearShareData=function(){this.$MessengerURLUploader5=null;this.$MessengerURLUploader2=null};f.exports=k}),null);