if (self.CavalryLogger) { CavalryLogger.start_js(["cYsSr"]); }

__d("MessengerComposerStore",["EditorState","immutable","MessengerActions","MessengerComposerActions","MessengerComposerState","MessengerComposerSteps","MessengerConstants","MessengerDispatcher","MessengerEditorStateManager","MessengerStateStore","MessengerStore","MessengerView"],(function a(b,c,d,e,f,g){"use strict";__p&&__p();var h,i,j=new(c("MessengerComposerState"))({step:c("MessengerComposerSteps").NULL,recipients:c("immutable").List()});h=babelHelpers.inherits(k,c("MessengerStore"));i=h&&h.prototype;function k(){i.constructor.call(this);this.$MessengerComposerStore1=j}k.prototype.getState=function(){return this.$MessengerComposerStore1};k.prototype.__onDispatch=function(l){__p&&__p();c("MessengerDispatcher").waitFor([c("MessengerStateStore").getDispatchToken()]);var m=c("MessengerStateStore").getState().detailView,n=this.$MessengerComposerStore1.recipients,o=this.$MessengerComposerStore1.step,p=null,q=null;switch(l.type){case c("MessengerComposerActions").Types.ADD_TOKEN:if(n.some(function(v){return v.getUniqueID()===l.entry.getUniqueID()}))break;p=n.push(l.entry);break;case c("MessengerComposerActions").Types.REMOVE_TOKEN:var r=l.entry.getUniqueID(),s=n.findIndex(function(v){return v.getUniqueID()===r});if(s!==-1)p=n["delete"](s);break;case c("MessengerComposerActions").Types.FOCUS_COMPOSER:if(o===c("MessengerComposerSteps").SELECT_RECIPIENTS)q=c("MessengerComposerSteps").COMPOSE;break;case c("MessengerComposerActions").Types.FOCUS_TYPEAHEAD:if(o===c("MessengerComposerSteps").COMPOSE)q=c("MessengerComposerSteps").SELECT_RECIPIENTS;break;case c("MessengerActions").Types.REPLACE_STATE:var t=c("MessengerStateStore").getPrevState().detailView;if(t!==c("MessengerView").DETAIL.COMPOSE&&m===c("MessengerView").DETAIL.COMPOSE)q=c("MessengerComposerSteps").SELECT_RECIPIENTS;break;case c("MessengerComposerActions").Types.MOVE_DRAFT:c("MessengerEditorStateManager").set(l.threadID,c("MessengerEditorStateManager").get(c("MessengerConstants").NEW_THREAD_KEY));break;case c("MessengerComposerActions").Types.EXIT_COMPOSE_STATE:var u=c("EditorState").createEmpty();setTimeout(function(){c("MessengerEditorStateManager").set(c("MessengerConstants").NEW_THREAD_KEY,c("EditorState").forceSelection(u,u.getSelection()))},0);q=c("MessengerComposerSteps").NULL;p=c("immutable").List();break}if(p||q){this.$MessengerComposerStore1=new(c("MessengerComposerState"))({step:q||o,recipients:p||n});this.emitChange()}};f.exports=new k()}),null);