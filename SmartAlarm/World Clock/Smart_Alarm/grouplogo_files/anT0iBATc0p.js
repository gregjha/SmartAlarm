if (self.CavalryLogger) { CavalryLogger.start_js(["7To\/N"]); }

__d("ScriptPathLogger",["Banzai","CurrentUser","ScriptPath","TimeSpentPageTransitionCause","URI","isInIframe"],(function a(b,c,d,e,f,g){"use strict";__p&&__p();var h="script_path_change",i={scriptPath:null,categoryToken:null,extraData:{}},j=false,k="imp_id";function l(v){__p&&__p();var w=c("URI").getNextURI?c("URI").getNextURI():new(c("URI"))(window.location.href),x=w.getQueryData(),y=w.getPath();if(y.endsWith("/"))y=y.substr(0,y.length-1);var z=m(y,x);if(z){v.content_id=z;return}var A=n(y);if(A!==""){v.dest_topic_feed=A;return}if(o(y)){var B=x.queue_id;if(B)v.dest_srt_queue_id=B;return}}function m(v,w){__p&&__p();if(w.story_fbid)return w.story_fbid;if(w.fbid)return w.fbid;if(w.view==="permalink"&&w.id)return w.id;var x=/\/(posts|videos|notes|groups\/.*\/permalink)\//,y=/^[0-9]+$/;if(x.test(v)){var z=v.split("/"),A=z[z.length-1];if(y.test(A))return A}return""}function n(v){if(!v||v.search("/feed/topics/")==-1)return"";var w=v.split("/");return w[w.length-1]}function o(v){return!!v&&v.search("/intern/review/")!==-1}function p(v,w,x,y){__p&&__p();if(!j||c("isInIframe")())return;var z=c("CurrentUser").isLoggedIn(),A=z?c("Banzai").VITAL:c("Banzai").BASIC;if(z){y=y||{};y.via_banzai_vital="1"}var B={source_path:v.scriptPath,source_token:v.categoryToken,dest_path:w.scriptPath,dest_token:w.categoryToken,impression_id:w.extraData?w.extraData.imp_id:null,cause:x},C=x===c("TimeSpentPageTransitionCause").PAGE_UNLOAD;if(!C)l(B);if(y!=null){var D=y,E=D.snowlift_content_id;if(!C&&E!=null){B.content_id=E;delete y.snowlift_content_id}B.extra_data=y}if(v.scriptPath===null)B.referrer=document.referrer;var F=c("ScriptPath").getClickPointInfo();if(F)B.click_point_info=F;if(v.extraData)for(var G in v.extraData)if(G!=k)B["source_"+G]=v.extraData[G];if(w.extraData)for(var H in w.extraData)if(H!=k)B["dest_"+H]=w.extraData[H];if(v.topViewEndpoint)B.source_endpoint=v.topViewEndpoint;if(w.topViewEndpoint)B.dest_endpoint=w.topViewEndpoint;if(v.restored)B.source_restored=true;c("Banzai").post(h,B,A);c("ScriptPath").setClickPointInfo(null)}function q(){p(c("ScriptPath").getSourcePageInfo()||i,c("ScriptPath").getPageInfo()||i,c("TimeSpentPageTransitionCause").PAGE_LOAD)}function r(v,w,x){p(v,w,c("TimeSpentPageTransitionCause").TRANSITION,x)}function s(){p(c("ScriptPath").getPageInfo()||i,i,c("TimeSpentPageTransitionCause").PAGE_UNLOAD);c("ScriptPath").shutdown()}var t=c("ScriptPath").subscribe(function(v){if(j){var w=v.source,x=v.dest,y=v.cause,z=v.extraData;if(y)p(w||i,x||i,y,z);else if(w)r(w,x||i,z);else q()}});c("Banzai").subscribe(c("Banzai").SHUTDOWN,s);var u={startLogging:function v(){j=true;if(c("ScriptPath").getPageInfo())q()},stopLogging:function v(){j=false;t.remove()},BANZAI_LOGGING_ROUTE:h};f.exports=u}),null);