if (self.CavalryLogger) { CavalryLogger.start_js(["HhoDv"]); }

__d("P2PNUXRendererUtils",["CurrentUser","ImmutableObject","MercuryAttachmentType","P2PTransferParam","P2PTransferStatus","StoryAttachmentStyle"],(function a(b,c,d,e,f,g){"use strict";__p&&__p();var h={getTransferFromMessage:function i(j){var k=void 0,l=void 0;if(!j||!j.attachments||!j.attachments.length)return null;l=j.attachments[0];if(this.isShareAttachment(l))k=l.share.target;if(k)k=new(c("ImmutableObject"))(k);return k},isSuccessfulReceivedTransfer:function i(j){return j&&j.receiver&&j.receiver.id===c("CurrentUser").getID()&&(j.status===c("P2PTransferStatus").COMPLETED||j.status===c("P2PTransferStatus").PENDING_RECIPIENT_NUX)},isShareAttachment:function i(j){return!!(typeof j!=="string"&&j.attach_type==c("MercuryAttachmentType").SHARE&&j.share&&j.share.style_list&&j.share.style_list.indexOf(c("StoryAttachmentStyle").ORION)>=0)},doesNUXNeedCreditCards:function i(j){var k=c("CurrentUser").getID()===j.sender.id;return!k&&j[c("P2PTransferParam").STATUS]===c("P2PTransferStatus").PENDING_RECIPIENT_NUX},isRecipientActionableStatus:function i(j){var k=j[c("P2PTransferParam").STATUS],l=c("CurrentUser").getID()===j.sender.id;return!l&&(k===c("P2PTransferStatus").PENDING_RECIPIENT_NUX||k===c("P2PTransferStatus").PENDING_RECIPIENT_VERIFICATION||k===c("P2PTransferStatus").PENDING_PUSH_FAIL)}};f.exports=h}),null);
__d("P2PListRow.react",["cx","invariant","React"],(function a(b,c,d,e,f,g,h,i){"use strict";__p&&__p();var j,k,l=c("React").PropTypes;j=babelHelpers.inherits(m,c("React").Component);k=j&&j.prototype;m.prototype.render=function(){var n=this.props;c("React").Children.count(n.children)===2||i(0);var o=n.offset,p=n.offsetRight!==undefined&&n.offsetRight+"px",q=n.offsetBottom!==undefined&&n.offsetBottom+"px";return c("React").createElement("div",{className:"_3q6c"+(o==="large"?" _3q6d":"")+(o==="small"?" _3q6o":"")},c("React").createElement("div",{className:"_3q6p",style:{paddingRight:p,paddingBottom:q}},n.children[0]),c("React").createElement("div",{className:"_3q6q",style:{paddingBottom:q}},n.children[1]))};function m(){j.apply(this,arguments)}m.propTypes={offset:l.oneOf(["large","small"]),offsetBottom:l.number,offsetRight:l.number};m.defaultProps={offset:"large"};f.exports=m}),null);
__d("P2PAddCreditCardDialog.react",["cx","fbt","CreditCardFormParam","MessengerEnvironment","Link.react","MessengerPaymentProductType","P2PAPI","P2PAPIUtils","P2PPaymentConfig","P2PCreditCardStore","P2PCreditCardForm.react","P2PLoadingMask.react","P2PLogger","P2PPaymentLoggerEvent","P2PLinkConstants","React","P2PButton.react","P2PDialog.react","P2PDialogTitle.react","P2PDialogBody.react","P2PDialogFooter.react","P2PText.react","emptyFunction","getObjectValues"],(function a(b,c,d,e,f,g,h,i){"use strict";__p&&__p();var j,k,l=c("React").PropTypes,m="fbP2PAddCreditCardDialog_learnMoreSentenceID";j=babelHelpers.inherits(n,c("React").Component);k=j&&j.prototype;function n(){__p&&__p();var o,p;for(var q=arguments.length,r=Array(q),s=0;s<q;s++)r[s]=arguments[s];return p=(o=k.constructor).call.apply(o,[this].concat(r)),this.state={isValid:false,formData:{},loading:false,requestID:"",saveErrors:null,asyncRequestState:{}},this.onCreditCardStoreChange=function(){var t=c("P2PCreditCardStore").getAsyncRequestState(),u=t[this.state.requestID];this.setState({asyncRequestState:t});if(u){this.setState({requestID:""});if(u.error)this.handleOnSaveError(u.error);else this.handleOnSaveSuccess(u)}}.bind(this),this.onSaveClick=function(){var t,u=this.props.p2pPaymentConfig;if(!u){this.setState({loading:false,saveErrors:{general:{message:i._("Cannot identify country.")}}});return}var v=c("P2PAPIUtils").genRequestID();this.setState({loading:true,requestID:v,saveErrors:null,formData:babelHelpers["extends"]({},this.state.formData,(t={},t[c("CreditCardFormParam").COUNTRY]=u.countryCode,t))},function(){c("P2PAPI").addCreditCard(babelHelpers["extends"]({requestID:v,product_type:this.props.productType},this.state.formData))}.bind(this));this.log(c("P2PPaymentLoggerEvent").UI_ACTN_CONFIRM_CARD_DETAILS)}.bind(this),this.handleValidation=function(t,u){this.setState({isValid:t,formData:u})}.bind(this),this.onToggle=function(t){if(!t){this.props.onCancel();this.log(c("P2PPaymentLoggerEvent").UI_ACTN_CANCEL_ADD_CARD)}}.bind(this),this.onCancelClicked=function(){this.onToggle(false)}.bind(this),p}n.prototype.componentDidMount=function(){this.log(c("P2PPaymentLoggerEvent").UI_ACTN_INITIATE_ADD_CARD);this.creditCardStoreSub=c("P2PCreditCardStore").addListener("change",this.onCreditCardStoreChange)};n.prototype.componentWillUnmount=function(){if(this.creditCardStoreSub){this.creditCardStoreSub.remove();this.creditCardStoreSub=null}};n.prototype.log=function(o,p){c("P2PLogger").log(o,babelHelpers["extends"]({www_event_flow:this.props.eventFlow,object_id:this.props.loggingObjectID},this.props.loggingData,p))};n.prototype.handleOnSaveSuccess=function(o){this.props.onSuccess(o);this.log(c("P2PPaymentLoggerEvent").UI_ACTN_ADD_CARD_SUCCESS)};n.prototype.handleOnSaveError=function(o){this.setState({loading:false,saveErrors:o});this.log(c("P2PPaymentLoggerEvent").UI_ACTN_ADD_CARD_FAIL,{message:o&&o.general?o.general.message:""})};n.prototype.isSaveButtonDisabled=function(){return this.state.loading||!this.state.isValid};n.prototype.renderAddCardForm=function(){var o=this.props.p2pPaymentConfig;if(!o)return null;var p=void 0,q=this.props.title;if(this.props.showCancelButton)p=c("React").createElement(c("P2PButton.react"),{use:"default",size:"medium",label:this.props.cancelButtonText,disabled:this.state.loading,onClick:this.onCancelClicked});return c("React").createElement("div",null,c("React").createElement(c("P2PDialogTitle.react"),null,q),c("React").createElement(c("P2PDialogBody.react"),null,c("React").createElement(c("P2PText.react"),{type:"primary",className:"_3-96"},this.props.text),c("React").createElement(c("P2PCreditCardForm.react"),{asyncRequestState:this.state.asyncRequestState,compactMode:true,onValidation:this.handleValidation,postalRegex:o.postalRegex,productType:this.props.productType,saveErrors:this.state.saveErrors,showIcons:false,showLabels:true,showPlaceholderOnFocus:true,showSecondaryIcons:true,useGutters:true}),c("React").createElement(c("P2PText.react"),{className:"_3-8y",id:m,type:"secondary"},i._("Your payment info is stored securely."),c("React").createElement("div",null,c("React").createElement(c("Link.react"),{"aria-describedby":m,href:c("P2PLinkConstants").addDebitCardHelpURI,target:"_blank"},i._("Learn More"))))),c("React").createElement(c("P2PDialogFooter.react"),{leftContent:this.props.leftContent},p,c("React").createElement(c("P2PButton.react"),{use:"confirm",size:"medium",label:this.props.saveButtonText,disabled:this.isSaveButtonDisabled(),onClick:this.onSaveClick})))};n.prototype.render=function(){if(!this.props.p2pPaymentConfig)return null;return c("React").createElement(c("P2PDialog.react"),{behaviors:this.props.behaviors,layerHideOnBlur:false,ref:"dialog",onToggle:this.onToggle,repositionOnUpdate:true,shown:true,width:this.props.width},this.renderAddCardForm(),c("React").createElement(c("P2PLoadingMask.react"),{visible:this.state.loading}))};n.propTypes={cancelButtonText:l.string,eventFlow:l.string.isRequired,leftContent:l.object,loggingData:l.object,loggingObjectID:l.string,onCancel:l.func,onSuccess:l.func,p2pPaymentConfig:l.shape({currencyCode:l.string.isRequired,enabledActions:l.object.isRequired,enabledPaymentMethods:l.object.isRequired,maxTransferAmount:l.number.isRequired,title:l.string,use_payment_module_method_picker:l.bool,countryCode:l.string.isRequired,postalRegex:l.string.isRequired}).isRequired,productType:l.oneOf(c("getObjectValues")(c("MessengerPaymentProductType"))),saveButtonText:l.string,showCancelButton:l.bool,text:l.string,title:l.string};n.defaultProps={cancelButtonText:i._("Cancel"),loggingData:{},onCancel:c("emptyFunction"),onSuccess:c("emptyFunction"),p2pPaymentConfig:c("P2PPaymentConfig").config,productType:c("MessengerPaymentProductType").P2P,saveButtonText:i._("Save"),showCancelButton:true,text:i._("Please enter a Visa or MasterCard debit card. Credit cards can't be used."),title:i._("Add Debit Card"),width:c("MessengerEnvironment").messengerui?480:430};f.exports=n}),null);
__d("P2PConfirmAmountDialog.react",["fbt","MessengerEnvironment","React","P2PButton.react","P2PDialog.react","P2PDialogBody.react","P2PDialogFooter.react","P2PDialogTitle.react","P2PLoadingMask.react","P2PText.react","emptyFunction"],(function a(b,c,d,e,f,g,h){__p&&__p();var i,j,k=c("React").PropTypes,l=c("MessengerEnvironment").messengerui;i=babelHelpers.inherits(m,c("React").Component);j=i&&i.prototype;function m(){var n,o;"use strict";for(var p=arguments.length,q=Array(p),r=0;r<p;r++)q[r]=arguments[r];return o=(n=j.constructor).call.apply(n,[this].concat(q)),this.state={loading:false},this.handleCancelClick=function(){this.props.onCancel()}.bind(this),this.handleConfirmClick=function(){this.setState({loading:true});this.props.onConfirm()}.bind(this),this.getFormattedAmount=function(){return this.props.currencySymbol+""+this.props.amount}.bind(this),o}m.prototype.render=function(){"use strict";var n=l?350:300;return c("React").createElement(c("P2PDialog.react"),{behaviors:this.props.behaviors,layerHideOnBlur:false,shown:true,width:n},c("React").createElement(c("P2PDialogTitle.react"),{showCloseButton:false},h._("Confirm Payment")),c("React").createElement(c("P2PDialogBody.react"),null,c("React").createElement(c("P2PText.react"),{type:"primary"},h._("Do you want to pay {recipient name} {amount}?",[h.param("recipient name",this.props.receiverName),h.param("amount",this.getFormattedAmount())]))),c("React").createElement(c("P2PDialogFooter.react"),null,c("React").createElement(c("P2PButton.react"),{label:h._("Cancel"),onClick:this.handleCancelClick,use:"default"}),c("React").createElement(c("P2PButton.react"),{label:h._("Pay"),onClick:this.handleConfirmClick,use:"confirm"})),c("React").createElement(c("P2PLoadingMask.react"),{visible:this.state.loading}))};m.propTypes={amount:k.string,currencySymbol:k.string,onCancel:k.func,onConfirm:k.func,receiverName:k.string};m.defaultProps={amount:"",currencySymbol:"",onCancel:c("emptyFunction"),onConfirm:c("emptyFunction"),receiverName:k.string};f.exports=m}),null);
__d("P2PGroupSendContactListItem.react",["cx","fbt","ix","Image.react","Link.react","messengerContactImageReact","React"],(function a(b,c,d,e,f,g,h,i,j){"use strict";__p&&__p();var k,l,m=c("messengerContactImageReact").jsComponent,n=32;k=babelHelpers.inherits(o,c("React").PureComponent);l=k&&k.prototype;o.prototype.$P2PGroupSendContactListItem1=function(p){if(!p)return null;return c("React").createElement("div",{className:"_1jwz"},c("React").createElement(c("Image.react"),{src:j("86852")}))};o.prototype.$P2PGroupSendContactListItem2=function(p){if(!this.props.isDisabled)return null;return c("React").createElement("div",{className:"_1jw-"},i._("Isn't able to receive money right now"))};o.prototype.render=function(){var p=this.props,q=p.isSelected,r=p.participant;return c("React").createElement(c("Link.react"),{"aria-checked":q,className:"_1jw_",onClick:p.onClick,role:"checkbox"},c("React").createElement(m,{className:"_1jx2",isMessengerUser:r.is_messenger_user,size:n,src:r.image_src}),c("React").createElement("div",{className:"_1jx4"},c("React").createElement("div",{className:"_1jx5"},c("React").createElement("div",{className:"_1jx6"},r.name),this.$P2PGroupSendContactListItem2(r)),this.$P2PGroupSendContactListItem1(q)))};function o(){k.apply(this,arguments)}f.exports=o}),null);
__d("P2PGroupSendDialog.react",["cx","fbt","MessengerEnvironment","Image.react","immutable","MessengerContextualDialog.react","P2PActions","P2PLogger","P2PPaymentLoggerEvent","P2PPaymentLoggerEventFlow","P2PText.react","React","ScrollableArea.react","XUIContextualDialog.react"],(function a(b,c,d,e,f,g,h,i){"use strict";__p&&__p();var j=c("React").PropTypes,k=c("React").createClass({displayName:"P2PGroupSendDialog",propTypes:{amount:j.string,currency:j.string,flyoutAlignment:j.oneOf(["left","center","right"]),onToggle:j.func.isRequired,openRequestTab:j.bool,p2pEligibilities:j.object,participants:j.instanceOf(c("immutable").List),referrer:j.string,threadID:j.string.isRequired,threadFBID:j.string.isRequired},componentDidMount:function l(){if(this.props.amount)this.log(c("P2PPaymentLoggerEvent").UI_ACTN_INITIATE_GROUP_SEND_TRIGGER,{raw_amount:this.props.amount,currency:this.props.currency});else this.log(c("P2PPaymentLoggerEvent").UI_ACTN_INITIATE_GROUP_SEND)},log:function l(m,n){c("P2PLogger").log(m,babelHelpers["extends"]({www_event_flow:c("P2PPaymentLoggerEventFlow").UI_FLOW_P2P_GROUP_SEND},n))},_handleToggle:function l(m){this.props.onToggle(m);this.log(c("P2PPaymentLoggerEvent").UI_ACTN_GROUP_SEND_CANCELLED)},_handleBlur:function l(){this._handleToggle(false)},isP2PIneligible:function l(m){var n=this.props.p2pEligibilities;return n?n[m.userID]===false:true},renderParticipantRow:function l(m){var n=c("MessengerEnvironment").messengerui,o=n?32:40,p=this.isP2PIneligible(m),q=void 0;if(p)q=c("React").createElement(c("P2PText.react"),{className:"_4cof",type:"primary"},i._("Isn't able to receive money right now"));return c("React").createElement("li",{className:"_4cog"+(p?" _4coh":""),key:m.id,onClick:this.handleGroupThreadClicked.bind(this,m)},c("React").createElement("div",{className:"_4coi"},c("React").createElement(c("Image.react"),{className:"_4coj",height:o,src:m.big_image_src||m.image_src,width:o})),c("React").createElement("div",{className:"_4cok"},c("React").createElement(c("P2PText.react"),{className:"_4col",type:"primary"},m.name),q))},renderGroupList:function l(){return c("React").createElement(c("ScrollableArea.react"),{height:178},c("React").createElement("ul",null,this.props.participants?this.props.participants.map(this.renderParticipantRow):null))},handleGroupThreadClicked:function l(m){if(this.isP2PIneligible(m))return;this.props.onToggle(false);c("P2PActions").chatSendViewOpened({amount:this.props.amount,openRequestTab:this.props.openRequestTab,referrer:this.props.referrer,threadID:this.props.threadID,groupSendRecipientUserIDs:[m.userID],groupThreadFBID:this.props.threadFBID});this.log(c("P2PPaymentLoggerEvent").UI_ACTN_GROUP_SEND_RECIPIENT_PICKED,{raw_amount:this.props.amount,currency:this.props.currency,object_id:m.userID})},render:function l(){var m=c("MessengerEnvironment").messengerui,n=m?c("MessengerContextualDialog.react"):c("XUIContextualDialog.react"),o=m?302:280;return c("React").createElement(n,{alignment:this.props.flyoutAlignment?this.props.flyoutAlignment:m?"right":"left",context:this.props.context,onBlur:this._handleBlur,onToggle:this._handleToggle,shown:true,width:o,position:"above"},c("React").createElement("div",{className:"_4com"+(m?" _4con":"")},c("React").createElement(c("P2PText.react"),{className:"_4coo",type:"primary",weight:"bold"},i._("Select a person")),this.renderGroupList()))}});f.exports=k}),null);
__d("P2PGroupSendParticipantsPickerDialog.react",["cx","fbt","immutable","LeftRight.react","MessengerContextualDialog.react","MessengerDialogButton.react","MessengerEnvironment","P2PActions","P2PGroupSendContactListItem.react","P2PLogger","P2PPaymentLoggerEvent","P2PPaymentLoggerEventFlow","P2PText.react","React","ScrollableArea.react","XUIContextualDialog.react"],(function a(b,c,d,e,f,g,h,i){"use strict";__p&&__p();var j,k,l=5,m=5;j=babelHelpers.inherits(n,c("React").PureComponent);k=j&&j.prototype;function n(o){__p&&__p();k.constructor.call(this,o);this.isMessengerDotCom=c("MessengerEnvironment").messengerui;this.$P2PGroupSendParticipantsPickerDialog8=function(){this.$P2PGroupSendParticipantsPickerDialog9(false)}.bind(this);this.$P2PGroupSendParticipantsPickerDialog10=function(){var s=this.$P2PGroupSendParticipantsPickerDialog5().map(function(t){return t.fbid});this.props.onToggle(false);if(s.length===0)return;c("P2PActions").chatSendViewOpened({amount:this.props.amount,openRequestTab:this.props.openRequestTab,referrer:this.props.referrer,threadID:this.props.threadID,groupSendRecipientUserIDs:s,groupThreadFBID:this.props.threadFBID});this.$P2PGroupSendParticipantsPickerDialog3(c("P2PPaymentLoggerEvent").UI_ACTN_GROUP_SEND_RECIPIENT_PICKED,{raw_amount:this.props.amount,currency:this.props.currency,object_ids:s})}.bind(this);this.$P2PGroupSendParticipantsPickerDialog9=function(s){this.props.onToggle(s);this.$P2PGroupSendParticipantsPickerDialog3(c("P2PPaymentLoggerEvent").UI_ACTN_GROUP_SEND_CANCELLED)}.bind(this);this.$P2PGroupSendParticipantsPickerDialog13=function(s){var t=s.fbid;return c("React").createElement(c("P2PGroupSendContactListItem.react"),{isDisabled:!this.$P2PGroupSendParticipantsPickerDialog7(t),isSelected:this.$P2PGroupSendParticipantsPickerDialog6(t),key:s.id,onClick:function(){return this.$P2PGroupSendParticipantsPickerDialog11(t)}.bind(this),participant:s})}.bind(this);var p=o.participants.sort(this.$P2PGroupSendParticipantsPickerDialog1),q=p.size>m,r=this.$P2PGroupSendParticipantsPickerDialog2(p,o.p2pEligibilities);this.state={isParticipantChecked:q||r.size>0,participants:p.toArray(),isParticipantSelected:r}}n.prototype.componentDidMount=function(){if(this.props.amount)this.$P2PGroupSendParticipantsPickerDialog3(c("P2PPaymentLoggerEvent").UI_ACTN_INITIATE_GROUP_SEND_TRIGGER,{raw_amount:this.props.amount,currency:this.props.currency});else this.$P2PGroupSendParticipantsPickerDialog3(c("P2PPaymentLoggerEvent").UI_ACTN_INITIATE_GROUP_SEND)};n.prototype.componentWillReceiveProps=function(o){if(!this.state.isParticipantChecked){var p=this.$P2PGroupSendParticipantsPickerDialog2(o.participants,o.p2pEligibilities);this.setState({isParticipantChecked:p.size>0,isParticipantSelected:p})}};n.prototype.$P2PGroupSendParticipantsPickerDialog4=function(){if(this.state.isMessengerDotCom)return c("MessengerContextualDialog.react");return c("XUIContextualDialog.react")};n.prototype.$P2PGroupSendParticipantsPickerDialog5=function(){return this.state.participants.filter(function(o){return this.$P2PGroupSendParticipantsPickerDialog6(o.fbid)}.bind(this))};n.prototype.$P2PGroupSendParticipantsPickerDialog7=function(o,p){if(!o)return false;var q=p||this.props.p2pEligibilities||{};return!!q[o]};n.prototype.$P2PGroupSendParticipantsPickerDialog6=function(o){if(!o)return false;return!!this.state.isParticipantSelected.get(o)};n.prototype.$P2PGroupSendParticipantsPickerDialog3=function(o,p){c("P2PLogger").log(o,babelHelpers["extends"]({www_event_flow:c("P2PPaymentLoggerEventFlow").UI_FLOW_P2P_GROUP_SEND},p))};n.prototype.$P2PGroupSendParticipantsPickerDialog11=function(o){if(!o||!this.$P2PGroupSendParticipantsPickerDialog7(o))return;var p=this.state.isParticipantSelected,q=this.$P2PGroupSendParticipantsPickerDialog6(o);this.setState({isParticipantSelected:p.set(o,!q)})};n.prototype.$P2PGroupSendParticipantsPickerDialog1=function(o,p){return o.name.localeCompare(p.name)};n.prototype.$P2PGroupSendParticipantsPickerDialog2=function(o,p){if(o.size>m)return c("immutable").Map();var q=c("immutable").Map().withMutations(function(r){o.forEach(function(s){var t=s.fbid;if(t&&this.$P2PGroupSendParticipantsPickerDialog7(t,p))r.set(t,true)}.bind(this))}.bind(this));return q};n.prototype.$P2PGroupSendParticipantsPickerDialog12=function(){if(this.state.participants.length<=l)return c("React").createElement("ul",{className:"_3jwq"},this.state.participants.map(this.$P2PGroupSendParticipantsPickerDialog13));return c("React").createElement(c("ScrollableArea.react"),{height:278},c("React").createElement("ul",null,this.state.participants.map(this.$P2PGroupSendParticipantsPickerDialog13)))};n.prototype.$P2PGroupSendParticipantsPickerDialog14=function(){var o=this.$P2PGroupSendParticipantsPickerDialog5();return c("React").createElement(c("LeftRight.react"),{className:"_4coo"},c("React").createElement(c("P2PText.react"),{tabIndex:0,type:"primary",weight:"bold"},i._("Select People")),c("React").createElement(c("MessengerDialogButton.react"),{className:"_3jwt",disabled:o.length===0,label:i._("Continue"),onClick:this.$P2PGroupSendParticipantsPickerDialog10,type:"primary"}))};n.prototype.render=function(){var o=this.$P2PGroupSendParticipantsPickerDialog4(),p=this.isMessengerDotCom?"right":"left",q=this.isMessengerDotCom?302:280;return c("React").createElement(o,{alignment:this.props.flyoutAlignment||p,className:"_4com"+(this.isMessengerDotCom?" _4con":""),context:this.props.context,position:"above",shown:true,type:"default",width:q,onBlur:this.$P2PGroupSendParticipantsPickerDialog8,onToggle:this.$P2PGroupSendParticipantsPickerDialog9},this.$P2PGroupSendParticipantsPickerDialog14(),this.$P2PGroupSendParticipantsPickerDialog12())};f.exports=n}),null);
__d("P2PMemoPhotoUploadPreview.react",["cx","BackgroundImage.react","MessengerEnvironment","P2PLoadingMask.react","React","XUICloseButton.react"],(function a(b,c,d,e,f,g,h){"use strict";__p&&__p();var i,j,k=c("React").PropTypes;i=babelHelpers.inherits(l,c("React").Component);j=i&&i.prototype;function l(){var m,n;for(var o=arguments.length,p=Array(o),q=0;q<o;q++)p[q]=arguments[q];return n=(m=j.constructor).call.apply(m,[this].concat(p)),this.renderAttachedPhotoPreviewContent=function(){var r=this.props.attachedPhoto;if(!r||!r.url)return null;var s=c("MessengerEnvironment").messengerui?286:260;return c("React").createElement(c("BackgroundImage.react"),{backgroundSize:"cover",height:120,src:r.url,width:s})}.bind(this),n}l.prototype.render=function(){var m=this.props.attachedPhoto;if(!this.props.photoUploading&&!m)return null;return c("React").createElement("div",{className:"_y37"},this.renderAttachedPhotoPreviewContent(),c("React").createElement(c("P2PLoadingMask.react"),{visible:this.props.photoUploading}),c("React").createElement(c("XUICloseButton.react"),{className:"_y38",onClick:this.props.onRemoveButtonClick,shade:"light",size:"medium"}))};l.propTypes={attachedPhoto:k.object,photoUploading:k.bool,onRemoveButtonClick:k.func};f.exports=l}),null);
__d("P2PMemoPhotoUploadSelector.react",["cx","fbt","FileInput","FileInputUploader","React","ReactDOM"],(function a(b,c,d,e,f,g,h,i){"use strict";__p&&__p();var j,k,l=c("React").PropTypes,m="/ajax/payments/p2p/memo_photo_upload/",n=1,o=29;j=babelHelpers.inherits(p,c("React").Component);k=j&&j.prototype;function p(){__p&&__p();var q,r;for(var s=arguments.length,t=Array(s),u=0;u<s;u++)t[u]=arguments[u];return r=(q=k.constructor).call.apply(q,[this].concat(t)),this.fileInput=null,this.$P2PMemoPhotoUploadSelector1=null,this.handleFileInputChange=function(){if(this.fileInput&&this.fileInput.getValue()){var v=new(c("FileInputUploader"))(this.fileInput.getInput()).setAllowCrossPageTransition(true).setURI(m);v.subscribe(["success","failure"],function(w,x){this.props.onPhotoUploadComplete(x.response)}.bind(this));v.setData({profile_id:n,source:o}).send();this.props.onPhotoUploadStart()}}.bind(this),r}p.prototype.componentDidMount=function(){var q=c("ReactDOM").findDOMNode(this.refs.PhotoInputContainer),r=c("ReactDOM").findDOMNode(this.refs.PhotoInputControl),s=c("ReactDOM").findDOMNode(this.refs.PhotoInput);this.fileInput=new(c("FileInput"))(q,r,s);this.$P2PMemoPhotoUploadSelector1=this.fileInput.subscribe("change",this.handleFileInputChange)};p.prototype.componentWillUnmount=function(){this.$P2PMemoPhotoUploadSelector1&&this.$P2PMemoPhotoUploadSelector1.unsubscribe()};p.prototype.render=function(){var q=i._("Add Photo");return c("React").createElement("div",{"aria-label":q,className:"_m _3h1u"+(this.props.photoUploading||this.props.attachedPhoto?" _3h1v":""),ref:"PhotoInputContainer"},c("React").createElement("i",{className:"_3h1w",ref:"PhotoInputControl"},c("React").createElement("input",{accept:"image/*",className:"_n",name:"file",ref:"PhotoInput",title:q,type:"file"})))};p.propTypes={attachedPhoto:l.object,isUploading:l.bool,onPhotoUploadComplete:l.func.isRequired,onPhotoUploadStart:l.func.isRequired};f.exports=p}),null);
__d("P2PMemoField.react",["cx","fbt","ix","MessengerEnvironment","Image.react","P2PGKValues","P2PMemoPhotoUploadPreview.react","P2PMemoPhotoUploadSelector.react","React"],(function a(b,c,d,e,f,g,h,i,j){"use strict";__p&&__p();var k,l,m=c("React").PropTypes;k=babelHelpers.inherits(n,c("React").Component);l=k&&k.prototype;function n(){__p&&__p();var o,p;for(var q=arguments.length,r=Array(q),s=0;s<q;s++)r[s]=arguments[s];return p=(o=l.constructor).call.apply(o,[this].concat(r)),this.state={attachedPhoto:null,defaultValue:"",disabled:false,focused:false,isRequesting:false,photoUploading:false},this.handleChangeText=function(t){this.props.onTextChange(t.target.value)}.bind(this),this.handleImageClick=function(){this.refs.input.focus()}.bind(this),this.handleFocus=function(){this.setState({focused:true})}.bind(this),this.handleBlur=function(){this.setState({focused:false})}.bind(this),this.handlePhotoUploadStart=function(){this.setState({photoUploading:true});this.props.onPhotoUploadingChange(true)}.bind(this),this.handlePhotoUploadComplete=function(t){var u=t.payload||null;this.setState({attachedPhoto:u,photoUploading:false});this.props.onPhotoChange(u?[u.fbid]:[]);this.props.onPhotoUploadingChange(false)}.bind(this),this.handlePhotoRemove=function(){this.setState({attachedPhoto:null,photoUploading:false});this.props.onPhotoChange([]);this.props.onPhotoUploadingChange(false)}.bind(this),this.getImageSrc=function(){var t=c("MessengerEnvironment").messengerui;if(this.state.focused)if(t)return j("94382");else return j("94384");else if(t)return j("94383");else return j("94385")}.bind(this),this.getPlaceholder=function(){if(this.props.isRequesting)return i._("What is this request for?");return i._("What is this payment for?")}.bind(this),this.shouldRenderPhotoMemo=function(){return c("P2PGKValues").P2PWWWMemoPhotoEnabled&&!this.props.isRequesting}.bind(this),this.renderPhotoUploadSelector=function(){if(!this.shouldRenderPhotoMemo())return null;return c("React").createElement("div",{className:"_1-j-"},c("React").createElement(c("P2PMemoPhotoUploadSelector.react"),{attachedPhoto:this.state.attachedPhoto,photoUploading:this.state.photoUploading,onPhotoUploadComplete:this.handlePhotoUploadComplete,onPhotoUploadStart:this.handlePhotoUploadStart}))}.bind(this),this.renderPhotoUploadPreview=function(){if(!this.shouldRenderPhotoMemo())return null;return c("React").createElement(c("P2PMemoPhotoUploadPreview.react"),{attachedPhoto:this.state.attachedPhoto,photoUploading:this.state.photoUploading,onRemoveButtonClick:this.handlePhotoRemove})}.bind(this),p}n.prototype.render=function(){return c("React").createElement("div",{className:"_2z8p"},c("React").createElement("div",{className:"_1-j_"},c("React").createElement(c("Image.react"),{className:"_2z8q",height:12,onClick:this.handleImageClick,src:this.getImageSrc(),width:12}),c("React").createElement("input",{className:"_2z8r",defaultValue:this.props.defaultValue,disabled:this.props.disabled,maxLength:36,onChange:this.handleChangeText,onBlur:this.handleBlur,onFocus:this.handleFocus,placeholder:this.getPlaceholder(),ref:"input"}),this.renderPhotoUploadSelector()),this.renderPhotoUploadPreview())};n.propTypes={defaultValue:m.string,disabled:m.bool,isRequesting:m.bool,onTextChange:m.func.isRequired,onPhotoChange:m.func.isRequired,onPhotoUploadingChange:m.func.isRequired};f.exports=n}),null);
__d("P2PMemoText.react",["cx","fbt","P2PText.react","React"],(function a(b,c,d,e,f,g,h,i){"use strict";__p&&__p();var j,k,l=c("React").PropTypes;j=babelHelpers.inherits(m,c("React").Component);k=j&&j.prototype;m.prototype.render=function(){return c("React").createElement("div",{className:"_4myt"},c("React").createElement(c("P2PText.react"),{display:"inline",type:"primary",weight:"bold"},i._("For: {Memo description}",[i.param("Memo description",c("React").createElement(c("P2PText.react"),{display:"inline",type:"secondary",weight:"normal"},this.props.memoText))])))};function m(){j.apply(this,arguments)}m.propTypes={memoText:l.string.isRequired};f.exports=m}),null);
__d("Middot.react",["React"],(function a(b,c,d,e,f,g){"use strict";var h,i;h=babelHelpers.inherits(j,c("React").Component);i=h&&h.prototype;j.prototype.render=function(){return c("React").createElement("span",babelHelpers["extends"]({},this.props,{role:"presentation","aria-hidden":true})," \xb7 ")};function j(){h.apply(this,arguments)}f.exports=j}),null);
__d("intlAmountInputUtils",["NumberFormatConfig"],(function a(b,c,d,e,f,g){"use strict";__p&&__p();function h(){var i=arguments.length<=0||arguments[0]===undefined?true:arguments[0];this.trailingDecimalSeparator=false;this.trailingZeros=[false,false];this.allowDecimals=i}h.prototype.parseAmount=function(i){__p&&__p();var j=i.split(c("NumberFormatConfig").decimalSeparator),k=j[0],l=j[1];this.trailingZeros=[false,false];if(l){l=l.substr(0,2);this.trailingZeros[0]=l[0]==="0";this.trailingZeros[1]=l[1]==="0"}if(l==="")this.trailingDecimalSeparator=true;else this.trailingDecimalSeparator=false;if(k&&!l)return parseFloat(k);else if(!k&&l)return parseFloat("0."+l);else if(k&&l)return parseFloat(k+"."+l);else return NaN};h.prototype.formatAmount=function(i){__p&&__p();if(Number.isNaN(i))return"";var j=i.toString(),k=j.split("."),l=k[0],m=k[1],n="";for(var o=l.length-1;o>=0;o--){n+=l[o];var p=l.length-o;if(p!==l.length&&p%(c("NumberFormatConfig").minDigitsForThousandsSeparator-1)===0)n+=c("NumberFormatConfig").numberDelimiter}n=n.split("").reverse().join("");var q=n;if(m){q+=c("NumberFormatConfig").decimalSeparator+m;if(this.trailingZeros[1])q+="0"}else if(this.trailingZeros[0]){q+=c("NumberFormatConfig").decimalSeparator+"0";if(this.trailingZeros[1])q+="0"}else if(this.trailingDecimalSeparator)q+=c("NumberFormatConfig").decimalSeparator;return q};h.prototype.sanitizeAmount=function(i){var j=void 0;if(this.allowDecimals)j=new RegExp("[^\\d\\"+c("NumberFormatConfig").decimalSeparator+"]+","g");else j=new RegExp("[^\\d]+","g");return i.replace(j,"")};f.exports=new h()}),null);
__d("P2PSendMoneyAmountInput.react",["cx","fbt","intlAmountInputUtils","Middot.react","NumberFormatConfig","React","XUIError.react","XUIGrayText.react","emptyFunction"],(function a(b,c,d,e,f,g,h,i){"use strict";__p&&__p();var j,k,l=c("React").PropTypes,m=1,n=Object.freeze({LEFT:37,RIGHT:39,DELETE:8,ZERO:48,NINE:57,NUMPADZERO:96,NUMPADNINE:105}),o=i._("Please enter a smaller amount"),p=void 0,q=void 0;j=babelHelpers.inherits(r,c("React").Component);k=j&&j.prototype;function r(s){__p&&__p();k.constructor.call(this,s);this.$P2PSendMoneyAmountInput1=false;this.focus=function(){var t=void 0,u=this.state.value,v=0;if(this.$P2PSendMoneyAmountInput1&&this.refs.textInput){t=this.refs.textInput;t.focus();if(u)v=u.length;else v=0;t.setSelectionRange(v,v)}}.bind(this);this.handleCaretMoveOnMouseUp=function(t){__p&&__p();var u=this.refs.textInput;if(!u)return;if(typeof u.selectionStart==="number"&&typeof u.selectionEnd==="number"){var v=u.selectionStart,w=u.selectionEnd;if(this.state.value[v-1]===c("NumberFormatConfig").numberDelimiter)v--;if(this.state.value[w-1]===c("NumberFormatConfig").numberDelimiter)w--;u.setSelectionRange(v,w)}}.bind(this);this.handleCaretMoveOnKeyDown=function(t){__p&&__p();q=false;var u=this.refs.textInput;if(!u)return;if(typeof u.selectionStart==="number"&&typeof u.selectionEnd==="number"){var v=u.selectionStart,w=u.selectionEnd;if(t.keyCode===n.LEFT){if(this.state.value[v-2]===c("NumberFormatConfig").numberDelimiter){t.preventDefault();if(v===w)u.setSelectionRange(v-2,v-2);else u.setSelectionRange(v-2,w)}}else if(t.keyCode===n.RIGHT){if(this.state.value[v]===c("NumberFormatConfig").numberDelimiter){t.preventDefault();if(v===w)u.setSelectionRange(w+2,w+2);else u.setSelectionRange(v,w+2)}}else if(t.keyCode===n.DELETE){q=true;var x=this.state.value.split(c("NumberFormatConfig").decimalSeparator),y=x[0],z=x[1];if(this.state.value[v-1]===c("NumberFormatConfig").decimalSeparator&&y.length%c("NumberFormatConfig").minDigitsForThousandsSeparator+z.length>=4)p=v;else if(y.length>1&&v<=y.length&&y.length%c("NumberFormatConfig").minDigitsForThousandsSeparator===1)p=v-2;else p=v-1}else if(t.keyCode>=n.ZERO&&t.keyCode<=n.NINE||t.keyCode>=n.NUMPADZERO&&t.keyCode<=n.NUMPADNINE){q=true;var A=this.state.value.split(c("NumberFormatConfig").decimalSeparator),B=A[0];if((B.length+1)%c("NumberFormatConfig").minDigitsForThousandsSeparator===0)p=v+2;else p=v+1}}}.bind(this);this.handleAmountInputChange=function(t){this.processAmount(t.target.value)}.bind(this);this.handleAmountInputBlur=function(t){var u=t.target.value,v=u.split(c("NumberFormatConfig").decimalSeparator)[1];if(v){if(v.length===1)this.setState({value:u+"0"},this.updateWidth)}else if(v==="")this.setState({value:this.state.value.slice(0,this.state.value.length-1)},this.updateWidth)}.bind(this);this.updateWidth=function(){var t=this.getMockWidth();if(t)this.setState({width:Math.min(t,this.state.maxInputWidth)})}.bind(this);this.state={inputError:null,maxInputWidth:200,value:s.value,width:this.getMockWidth()};c("intlAmountInputUtils").allowDecimals=this.props.allowDecimals}r.prototype.componentDidMount=function(){this.$P2PSendMoneyAmountInput1=true;this.processAmount(this.state.value);if(!this.props.disabled)this.initDelayedFocus()};r.prototype.componentWillUnmount=function(){this.$P2PSendMoneyAmountInput1=false};r.prototype.componentDidUpdate=function(s,t){if(q)this.refs.textInput.setSelectionRange(p,p)};r.prototype.initDelayedFocus=function(){setTimeout(this.focus)};r.prototype.processAmount=function(s){var t=c("intlAmountInputUtils").sanitizeAmount(s);if(t===c("NumberFormatConfig").decimalSeparator)t="0"+t;var u=c("intlAmountInputUtils").parseAmount(t),v=u<=this.props.maxAmount&&!Number.isNaN(u)&&u>0,w=Number.isNaN(u)||u<=this.props.maxAmount;this.props.onInputChange(Number.isNaN(u)?"":u.toString(),v);var x=c("intlAmountInputUtils").formatAmount(u);if(w)this.setState({value:x,inputError:null},this.updateWidth);else this.setState({value:x,inputError:o},this.updateWidth)};r.prototype.getMockWidth=function(){var s=this.refs.mock_input;if(s)return s.offsetWidth+m;else return 0};r.prototype.renderGroupRequestInformation=function(){if(this.props.receiversCount<=1)return null;var s=this.props.amountOffset,t=void 0;if(parseFloat(this.props.value))t=Math.round(parseFloat(this.props.value)*this.props.receiversCount*s)/s;else t=0;return c("React").createElement(c("XUIGrayText.react"),{display:"block",size:"small"},i._("Per Person"),c("React").createElement(c("Middot.react"),null),i._("{currency}{total} Total",[i.param("currency",this.props.currencySymbol),i.param("total",t)]))};r.prototype.render=function(){var s=void 0,t=!this.state.value.length;if(t)s=c("React").createElement("div",{ref:"placeholder_input",className:"_1-sv"},"0");return c("React").createElement("div",{className:"_ipw"+(this.props.isRequesting?" _1c9h":"")},c("React").createElement("label",null,c("React").createElement("div",{className:"_4puh"+(t?" _1-sy":"")},s,c("React").createElement("div",{ref:"mock_input",className:"_5fbs"},this.state.value),c("React").createElement(c("XUIError.react"),{xuiError:this.state.inputError},c("React").createElement("span",{className:"_1-sz","data-currency-symbol":this.props.currencySymbol},c("React").createElement("input",{autoFocus:true,className:"_5fbv",disabled:this.props.disabled,onBlur:this.handleAmountInputBlur,onChange:this.handleAmountInputChange,onKeyDown:this.handleCaretMoveOnKeyDown,onMouseUp:this.handleCaretMoveOnMouseUp,ref:"textInput",style:{width:this.state.width},value:this.state.value}))),this.renderGroupRequestInformation())))};r.propTypes={allowDecimals:l.bool.isRequired,amountOffset:l.number.isRequired,currencySymbol:l.string,disabled:l.bool,isRequesting:l.bool,maxAmount:l.number.isRequired,onInputChange:l.func.isRequired,receiversCount:l.number,value:l.string};r.defaultProps={currencySymbol:"$",disabled:false,isRequesting:false,maxAmount:9999.99,onInputChange:c("emptyFunction"),receiversCount:1,value:""};f.exports=r}),null);
__d("P2PSendMoneyDialogActionHeader.react",["cx","fbt","React","ShimButton.react"],(function a(b,c,d,e,f,g,h,i){"use strict";__p&&__p();var j,k;j=babelHelpers.inherits(l,c("React").Component);k=j&&j.prototype;l.prototype.renderPayTab=function(){if(this.props.isPayTabDisabled)return null;var m=this.props.isPaying;return c("React").createElement(c("ShimButton.react"),{className:"_50cx"+(m?" _50cy":""),onClick:this.props.onPayClick},i._("Pay"))};l.prototype.renderRequestTab=function(){if(this.props.isRequestTabDisabled)return null;var m=this.props.isRequesting;return c("React").createElement(c("ShimButton.react"),{className:"_50cx"+(m?" _50cy":""),onClick:this.props.onRequestClick},i._("Request"))};l.prototype.render=function(){var m=!!this.props.isPayTabDisabled,n=!!this.props.isRequestTabDisabled;return c("React").createElement("div",{className:"_50cr"+(m||n?" _3b-h":"")+(this.props.isPaying?" _50cv":"")+(this.props.isRequesting?" _50cw":"")},this.renderPayTab(),this.renderRequestTab(),c("React").createElement("div",{className:"_50c_"}))};function l(){j.apply(this,arguments)}f.exports=l}),null);
__d("P2PGatingFailReason",[],(function a(b,c,d,e,f,g){f.exports=Object.freeze({NON_PERSONAL_USER:"non_personal_user",IS_WORK_USER:"is_work_user",P2P_ENABLED_GK_FAIL:"p2p_enabled_gk_fail",P2P_ELIGIBLE_GK_FAIL:"p2p_eligible_gk_fail",HAS_NOT_RECEIVED_MONEY:"has_not_received_money",PAYMENT_ACCOUNT_DISABLED:"payment_account_disabled",MBASIC:"mbasic",IS_PARTIAL_ACCOUNT:"is_partial_account",IS_MOMENTS_ONLY_ACCOUNT:"is_moments_only_account",IS_PARTIES_ONLY_ACCOUNT:"is_parties_only_account",EXCEPTION:"exception",APP_CAPABILITY:"app_capability",USER_BLOCKED:"user_blocked",MESSAGES_BLOCKED:"messages_blocked",SVA_RECEIVER_GATING:"sva_receiver_gating"})}),null);
__d("PaymentSettingsStringUtils",["fbt","P2PGatingFailReason","P2PLinkConstants","React"],(function a(b,c,d,e,f,g,h){"use strict";var i={getPaymentsDPOText:function j(){return h._("For your security, payments have been temporarily turned off. Please {=contact us} to learn more.",[h.param("=contact us",c("React").createElement("a",{href:c("P2PLinkConstants").disabledPaymentsSupportURI},"contact us"))])},getGeneralP2PDisabledText:function j(){return h._("You are not able to use payments in messages right now. Please try again later.")},getP2PDisabledText:function j(k){switch(k){case c("P2PGatingFailReason").PAYMENT_ACCOUNT_DISABLED:return this.getPaymentsDPOText();default:return this.getGeneralP2PDisabledText()}}};f.exports=i}),null);
__d("P2PSendMoneyDialog.react",["cx","fbt","Arbiter","CreditCardFormParam","FBPaymentsRiskThreatMetrixIframe.react","Image.react","ImageBlock.react","immutable","Link.react","MessengerContactImage.react","MessengerContextualDialog.react","MessengerEnvironment","MessengerHorizontalScroll.react","P2PAPI","P2PAddCreditCardDialog.react","P2PButton.react","P2PBigAmount.react","P2PCreditCardStore","P2PChooseCreditCardForm.react","P2PConfirmAmountDialog.react","P2PDialog.react","P2PDialogTitle.react","P2PEditCreditCardDialog.react","P2PGKValues","P2PLinkConstants","P2PLoadingMask.react","P2PLogger","P2PMemoField.react","P2PMemoText.react","P2PPaymentLoggerEvent","P2PPaymentLoggerEventFlow","P2PSendMoneyAmountInput.react","P2PSendMoneyDialogActionHeader.react","P2PText.react","P2PVerifyCreditCardDialog.react","PaymentSettingsStringUtils","PECurrency","React","ReactLayeredComponentMixin_DEPRECATED","XUIContextualDialog.react","XUISpinner.react"],(function a(b,c,d,e,f,g,h,i){"use strict";__p&&__p();var j=c("React").PropTypes,k=c("MessengerEnvironment").messengerui,l=c("P2PGKValues").P2PRequestMoneyEnabled,m=i._("Change"),n=i._("Add Debit Card"),o=100,p=c("React").createClass({displayName:"P2PSendMoneyDialog",mixins:[c("ReactLayeredComponentMixin_DEPRECATED")],propTypes:{amount:j.string.isRequired,currency:j.string.isRequired,currencySymbol:j.string.isRequired,groupThreadFBID:j.string,flyoutAlignment:j.oneOf(["left","center","right"]),openRequestTab:j.bool,memoText:j.string,onError:j.func.isRequired,onPaymentRequestError:j.func.isRequired,onPaymentRequestSuccess:j.func.isRequired,onSendSuccess:j.func.isRequired,onToggle:j.func.isRequired,platformData:j.object,receivers:j.instanceOf(c("immutable").List).isRequired,referrer:j.string,paymentRequestID:j.string,position:j.oneOf(["above","below","left","right"]),p2pEligibilities:j.object,p2pPaymentConfig:j.shape({currencyCode:j.string.isRequired,enabledActions:j.object.isRequired,enabledPaymentMethods:j.object.isRequired,maxTransferAmount:j.number.isRequired,title:j.string,use_payment_module_method_picker:j.bool,countryCode:j.string.isRequired,postalRegex:j.string.isRequired}).isRequired,useModal:j.bool},getDefaultProps:function q(){return{amount:"",openRequestTab:false,receivers:c("immutable").List(),useModal:false}},getInitialState:function q(){var r=c("P2PCreditCardStore").getAll(),s=this.props.openRequestTab||this.isGroupRequest();return{asyncRequestState:c("P2PCreditCardStore").getAsyncRequestState(),addCreditCardDialogShown:false,amount:this.props.amount,creditCardsFetchError:c("P2PCreditCardStore").failedCreditCardFetch(),creditCards:r,confirmAmountDialogShown:false,isAmountValid:!!this.props.paymentRequestID,isCreditCardsFetchComplete:c("P2PCreditCardStore").isCreditCardsFetchComplete(),isMemoPhotoUploading:false,isPaying:!s,isRequesting:s,loading:false,memoText:this.props.memoText,memoPhotoIDs:[],selectedCard:r[0],showChooseCreditCardForm:false,verifyCreditCardDialogShown:false}},creditCardStoreSub:null,_isAmountVerified:false,passwordCancelSubscribeToken:null,_isMounted:false,getDialogWidth:function q(){if(this.props.useModal)return k?380:312;return k?286:260},getEventFlow:function q(){return this.props.paymentRequestID||this.isRequesting()?c("P2PPaymentLoggerEventFlow").UI_FLOW_P2P_REQUEST:c("P2PPaymentLoggerEventFlow").UI_FLOW_P2P_SEND},getLogObjectIDs:function q(){var r=this.props.receivers;if(r.size>1)return{object_ids:r.map(function(s){return s.userID}).join(",")};var s=r.get(0)||{};return{object_id:s.userID}},log:function q(r,s){var t=this.getLogObjectIDs();c("P2PLogger").log(r,babelHelpers["extends"]({www_event_flow:this.getEventFlow(),memo_text:this.state.memoText,request_id:this.props.paymentRequestID},this.getPlatformLoggingData(),s,this.getReferrer(),t))},componentDidMount:function q(){this._isMounted=true},componentWillUnmount:function q(){this._isMounted=false;if(this.passwordCancelSubscribeToken){c("Arbiter").unsubscribe(this.passwordCancelSubscribeToken);this.passwordCancelSubscribeToken=null}if(this.creditCardStoreSub){this.creditCardStoreSub.remove();this.creditCardStoreSub=null}},componentWillMount:function q(){this.creditCardStoreSub=c("P2PCreditCardStore").addListener("change",this.onCreditCardStoreChange);this.log(c("P2PPaymentLoggerEvent").UI_ACTN_INITIATE_SEND);if(c("P2PGKValues").P2PDisabledReason)this.log(c("P2PPaymentLoggerEvent").UI_ACTN_P2P_SENDER_DISABLED_SHOWN);else if(this.isRecipientIneligible())this.log(c("P2PPaymentLoggerEvent").UI_ACTN_P2P_RECIPIENT_INELIGIBLE_SHOWN)},getPlatformLoggingData:function q(){var r=this.props.platformData&&this.props.platformData.loggingData;if(r)return{platform_logging_data:r};return null},getReferrer:function q(){var r=this.props.referrer;if(r)return{www_event_referrer:r};return null},onAmountInputChange:function q(r,s){this.setState({amount:r,isAmountValid:s})},onCreditCardStoreChange:function q(){var r=c("P2PCreditCardStore").getAll(),s=void 0;if(this.state.selectedCard)s=r.filter(function(t){return t.getCredentialId()===this.state.selectedCard.getCredentialId()}.bind(this))[0];if(!s)s=r[0];this.setState({asyncRequestState:c("P2PCreditCardStore").getAsyncRequestState(),creditCards:r,isCreditCardsFetchComplete:c("P2PCreditCardStore").isCreditCardsFetchComplete(),selectedCard:s,creditCardsFetchError:c("P2PCreditCardStore").failedCreditCardFetch()})},shouldShowConfirmAmountDialog:function q(){var r=this.state.amount,s=r?r.replace(/\,/g,""):"",t=parseFloat(s);return!this._isAmountVerified&&t>=o},shouldShowVerifyCreditCardDialog:function q(){return!this.state.selectedCard.getIsVerified()},shouldShowEditCreditCardDialog:function q(){return this.state.selectedCard.isExpired()},handleSendClick:function q(){if(this.isSendButtonDisabled())return;this.log(c("P2PPaymentLoggerEvent").UI_ACTN_SEND_CLICKED,{raw_amount:this.state.amount,currency:this.props.currency});this._isAmountVerified=false;this.initiatePayment()},handleRequestClick:function q(){if(this.isRequestButtonDisabled())return;this.log(c("P2PPaymentLoggerEvent").UI_ACTN_REQUEST_CLICKED,{raw_amount:this.state.amount,currency:this.props.currency});this.createPaymentRequest()},initiatePayment:function q(){__p&&__p();if(this.shouldShowConfirmAmountDialog()){this.hideAllDialogs();this.setState({confirmAmountDialogShown:true});this.log(c("P2PPaymentLoggerEvent").UI_ACTN_CONFIRM_AMOUNT,{raw_amount:this.state.amount,currency:this.props.currency});return}else if(this.shouldShowEditCreditCardDialog()){this.hideAllDialogs();this.setState({editCreditCardDialogShown:true});this.log(c("P2PPaymentLoggerEvent").UI_ACTN_EDIT_CARD,{raw_amount:this.state.amount,currency:this.props.currency});return}else if(this.shouldShowVerifyCreditCardDialog()){this.hideAllDialogs();this.setState({verifyCreditCardDialogShown:true});this.log(c("P2PPaymentLoggerEvent").UI_ACTN_VERIFY_CSC,{raw_amount:this.state.amount,currency:this.props.currency});return}this.createTransaction()},isGroupRequest:function q(){return this.props.receivers.size>1},isPayingForRequest:function q(){return!!this.props.paymentRequestID},isPaying:function q(){return this.state.isPaying===true},isRequesting:function q(){return this.state.isRequesting===true},shouldShowLoading:function q(){return!this.state.addCreditCardDialogShown&&!this.state.confirmAmountDialogShown&&!this.state.verifyCreditCardDialogShown&&!this.state.editCreditCardDialogShown},createTransaction:function q(){__p&&__p();var r={},s=this.props.receivers.get(0)||{};this.setState({loading:this.shouldShowLoading()});r[c("CreditCardFormParam").CREDENTIAL_ID]=this.state.selectedCard.getCredentialId();r.amount=this.state.amount;r.receiverId=s.userID;r.memoText=this.state.memoText;r.memoPhotoIDs=this.state.memoPhotoIDs;r.paymentRequestID=this.props.paymentRequestID;if(this.props.groupThreadFBID)r.group_thread_fbid=this.props.groupThreadFBID;if(this.props.platformData)r.platform_context_id=this.props.platformData.platformContextID;this.passwordCancelSubscribeToken=c("Arbiter").subscribeOnce("PasswordReauthDialogCancelClick",this.handlePasswordReauthDialogCancelClick);c("P2PAPI").createTransaction({formData:r,error:this.setCreateTransferError,success:this.setCreateTransferSuccess});this.log(c("P2PPaymentLoggerEvent").UI_ACTN_CONFIRM_SEND,{raw_amount:this.state.amount,currency:this.props.currency})},createPaymentRequest:function q(){this.setState({loading:this.shouldShowLoading()});var r=this.props.platformData||{};c("P2PAPI").createPaymentRequest({formData:{amount:this.state.amount,memoText:this.state.memoText,group_thread_fbid:this.props.groupThreadFBID,requestees:this.props.receivers,platform_context_id:r.platformContextID},error:this.setCreatePaymentRequestError,success:this.setCreatePaymentRequestSuccess});this.log(c("P2PPaymentLoggerEvent").UI_ACTN_CONFIRM_REQUEST,{raw_amount:this.state.amount,currency:this.props.currency})},hideAllDialogs:function q(){this.setState({addCreditCardDialogShown:false,confirmAmountDialogShown:false,verifyCreditCardDialogShown:false,editCreditCardDialogShown:false})},isDialogShowing:function q(){return!!(this.state.addCreditCardDialogShown||this.state.confirmAmountDialogShown||this.state.verifyCreditCardDialogShown||this.state.editCreditCardDialogShown)},setCreateTransferError:function q(r){if(this._isMounted){this.hideAllDialogs();this.setState({loading:false})}this.props.onError(r);this.log(c("P2PPaymentLoggerEvent").UI_ACTN_SEND_FAIL)},setCreateTransferSuccess:function q(r){if(this._isMounted){this.setState({loading:false});this.hideAllDialogs()}this.props.onSendSuccess(r);this.log(c("P2PPaymentLoggerEvent").UI_ACTN_SEND_SUCCESS)},setCreatePaymentRequestError:function q(r){if(this._isMounted){this.hideAllDialogs();this.setState({loading:false})}this.props.onPaymentRequestError(r.error);this.log(c("P2PPaymentLoggerEvent").UI_ACTN_REQUEST_FAIL)},setCreatePaymentRequestSuccess:function q(r){if(this._isMounted){this.setState({loading:false});this.hideAllDialogs()}this.props.onPaymentRequestSuccess();this.log(c("P2PPaymentLoggerEvent").UI_ACTN_REQUEST_SUCCESS,{request_id:r.id})},handlePasswordReauthDialogCancelClick:function q(){this.passwordCancelSubscribeToken=null;this.setState({loading:false});this.hideAllDialogs()},onAddCreditCardCancel:function q(){this.setState({addCreditCardDialogShown:false})},onAddCreditCardSuccess:function q(r){var s=c("P2PCreditCardStore").getAll(),t=s.filter(function(u){var v=u.getCredentialId();return r[c("CreditCardFormParam").CREDENTIAL_ID]===v})[0];this.setState({selectedCard:t},function(){if(this.state.isAmountValid)this.initiatePayment();else{this.setState({addCreditCardDialogShown:false});this.focusAmountInput()}}.bind(this))},onEditCreditCardSuccess:function q(){this.initiatePayment()},onEditCreditCardCancel:function q(){this.setState({editCreditCardDialogShown:false})},focusAmountInput:function q(){if(this.refs.send_money_amount_input)this.refs.send_money_amount_input.focus()},_handleToggle:function q(r){this.props.onToggle(r);if(!this.state.loading)this.log(c("P2PPaymentLoggerEvent").UI_ACTN_SEND_MONEY_CANCELLED)},_handleBlur:function q(){this._handleToggle(false)},handleAddCreditCardClick:function q(){this.setState({addCreditCardDialogShown:true,showChooseCreditCardForm:false});this.log(c("P2PPaymentLoggerEvent").UI_ACTN_CHANGE_CARD)},handleBackClick:function q(){this.setState({showChooseCreditCardForm:false},function(){this.focusAmountInput()}.bind(this))},handleChooseCardNextClick:function q(){var r=this.refs.choose_credit_card_form.getSelectedCard();this.setState({selectedCard:r,showChooseCreditCardForm:false},function(){this.focusAmountInput()}.bind(this))},handleAddCardNextClick:function q(){this.setState({addCreditCardDialogShown:true})},handleChangeSelectedCardClick:function q(){var r={};if(this.state.creditCards.length===1){r.addCreditCardDialogShown=true;this.log(c("P2PPaymentLoggerEvent").UI_ACTN_CHANGE_CARD)}else{r.showChooseCreditCardForm=true;this.log(c("P2PPaymentLoggerEvent").UI_ACTN_INITIATE_CHOOSE_CARD)}this.setState(r)},onConfirmAmountCancel:function q(){this.setState({confirmAmountDialogShown:false})},onConfirmAmountSuccess:function q(){this._isAmountVerified=true;this.initiatePayment()},onVerifyCreditCardSuccess:function q(){this.initiatePayment()},onVerifyCreditCardCancel:function q(){this.setState({verifyCreditCardDialogShown:false})},handleMemoTextChange:function q(r){this.setState({memoText:r})},handleMemoPhotoChange:function q(r){this.setState({memoPhotoIDs:r})},handleMemoPhotoUploadingChange:function q(r){this.setState({isMemoPhotoUploading:r})},isSendButtonDisabled:function q(){return!this.state.isAmountValid||!this.state.creditCards.length||this.state.loading||this.state.isMemoPhotoUploading||this.isGroupRequest()},isRequestButtonDisabled:function q(){return!this.state.isAmountValid||this.state.loading},isAddCardNextButtonDisabled:function q(){return!this.state.isAmountValid},renderAddDebitCardLink:function q(){return c("React").createElement(c("P2PText.react"),{className:"_42h3",type:"secondary",ref:"send_money_dialog_add_card_text"},c("React").createElement(c("Link.react"),{className:"_49nm",href:"#",onClick:this.handleAddCreditCardClick},n))},renderSelectedCard:function q(){var r=this.state.selectedCard;return c("React").createElement(c("P2PText.react"),{className:"_21x5",size:"small",type:"primary"},c("React").createElement("div",{className:"_49nn"},r.getName()),c("React").createElement("div",{className:"_21wx"},r.getCreditCardNumberFormatted()),c("React").createElement("div",{className:"_21ww"},"\xb7"),c("React").createElement(c("Link.react"),{className:"_21wy",onClick:this.handleChangeSelectedCardClick,href:"#"},m))},renderFormButtons:function q(){__p&&__p();var r=void 0,s=k&&this.props.useModal?c("React").createElement(c("P2PButton.react"),{label:i._("Cancel"),onClick:function(){this._handleToggle(false)}.bind(this),type:"secondary"}):null;if(this.isRequesting())r=c("React").createElement("div",null,s,this.renderRequestButton());else if(!this.state.creditCards.length)r=c("React").createElement("div",null,s,this.renderAddCardNextButton());else if(this.state.showChooseCreditCardForm)r=c("React").createElement("div",null,this.renderChooseCardBackButton(),this.renderChooseCardNextButton());else r=c("React").createElement("div",null,s,this.renderPayButton());return r},renderChooseCardBackButton:function q(){return c("React").createElement(c("P2PButton.react"),{label:i._("Back"),onClick:this.handleBackClick,ref:"back_button",size:"medium",type:"secondary",use:"default"})},renderAddCardNextButton:function q(){return c("React").createElement(c("P2PButton.react"),{disabled:this.isAddCardNextButtonDisabled(),label:i._("Next"),onClick:this.handleAddCardNextClick,ref:"add_card_next_button",size:"medium",type:"primary",use:"default"})},renderChooseCardNextButton:function q(){return c("React").createElement(c("P2PButton.react"),{label:i._("Next"),onClick:this.handleChooseCardNextClick,ref:"choose_card_next_button",size:"medium",type:"primary",use:"confirm"})},renderPayButton:function q(){return c("React").createElement(c("P2PButton.react"),{disabled:this.isSendButtonDisabled(),label:i._("Pay"),onClick:this.handleSendClick,ref:"send_button",size:"medium",type:"primary",use:"confirm"})},renderRequestButton:function q(){return c("React").createElement(c("P2PButton.react"),{disabled:this.isRequestButtonDisabled(),label:i._("Request"),onClick:this.handleRequestClick,ref:"request_button",size:"medium",type:"primary",use:"confirm"})},renderPaymentDetails:function q(){__p&&__p();var r=void 0;if(this.isRequesting())return null;if(this.state.creditCards.length)if(this.state.showChooseCreditCardForm)r=this.renderAddDebitCardLink();else r=this.renderSelectedCard();else if(this.state.creditCardsFetchError)r=c("React").createElement("div",{className:"_2abl"},c("React").createElement(c("P2PText.react"),{type:"secondary",ref:"send_money_dialog_add_card_next_text"},i._("Sorry, we couldn't fetch your details. Please check your internet connection or refresh this page and try again.")));else r=c("React").createElement("div",{className:"_2abl"},c("React").createElement(c("P2PText.react"),{type:"secondary",ref:"send_money_dialog_add_card_next_text"},i._("Sending money is free and secure")));return r},isRecipientIneligible:function q(){var r=this.props.p2pEligibilities;if(!r||this.props.receivers.size===0)return false;var s=this.props.receivers.find(function(t){return!r[t.userID]});return!!s},isDialogDisabled:function q(){return!!(c("P2PGKValues").P2PDisabledReason||this.isRecipientIneligible())},renderDisabledText:function q(){__p&&__p();if(!this.isDialogDisabled())return null;var r=c("P2PGKValues").P2PDisabledReason;if(r)return c("PaymentSettingsStringUtils").getP2PDisabledText(r);if(this.isRecipientIneligible()){var s=this.props.receivers.get(0)||{},t=s.short_name||"";return i._("{receiverName} isn't able to receive money right now. {Learn more about p2p link}",[i.param("receiverName",t),i.param("Learn more about p2p link",c("React").createElement(c("Link.react"),{href:c("P2PLinkConstants").receiverIneligibleHelpURI,target:"_blank"},i._("Learn More.")))])}return c("PaymentSettingsStringUtils").getGeneralP2PDisabledText()},renderFooter:function q(){var r=void 0;if(this.isDialogDisabled())r=c("React").createElement(c("P2PText.react"),{className:"_2pi8",type:"secondary"},this.renderDisabledText());else if(!this.state.isCreditCardsFetchComplete)r=c("React").createElement("div",{className:"_2-vg"},c("React").createElement(c("XUISpinner.react"),{className:"_2-vh"}));else r=[c("React").createElement("div",{className:"_21x4",key:"paymentDetails"},this.renderPaymentDetails()),c("React").createElement("div",{className:"_4zf-",key:"formButtons"},this.renderFormButtons())];return c("React").createElement("div",{className:"_5p-k"},r)},renderMemo:function q(){var r=this.isPayingForRequest(),s=this.props.memoText||this.state.memoText;if(r&&!s)return null;if(r&&s)return c("React").createElement("div",{className:"_5exl"},c("React").createElement(c("P2PMemoText.react"),{memoText:s}));return c("React").createElement("div",{className:"_5exl"},c("React").createElement(c("P2PMemoField.react"),{defaultValue:s,disabled:this.isDialogDisabled(),isRequesting:this.isRequesting(),onTextChange:this.handleMemoTextChange,onPhotoChange:this.handleMemoPhotoChange,onPhotoUploadingChange:this.handleMemoPhotoUploadingChange}))},renderSendMoneyForm:function q(){return c("React").createElement("div",null,this.renderTitle(),c("React").createElement("div",{className:"_2abm"},this.renderMainContainer()),this.renderMemo(),c("React").createElement("div",{className:"_21w-"+(this.isDialogDisabled()?" _3orf":"")+(k?" _4eb_":"")},this.renderFooter()))},renderMainContainer:function q(){var r=void 0,s=void 0,t=this.state.amount,u=this.isPayingForRequest(),v=this.props.p2pPaymentConfig,w=c("PECurrency").getCurrencyOffset(v.currencyCode),x=v.maxTransferAmount/w;if(this.state.showChooseCreditCardForm)r=c("React").createElement("div",{className:"_xn7"},c("React").createElement(c("P2PChooseCreditCardForm.react"),{creditCards:this.state.creditCards,selectedCard:this.state.selectedCard,ref:"choose_credit_card_form"}));else{if(!u)s=c("React").createElement(c("P2PSendMoneyAmountInput.react"),{amountOffset:w,currencySymbol:this.props.currencySymbol,disabled:this.isDialogDisabled(),allowDecimals:w===100,isRequesting:this.isRequesting(),maxAmount:x,onInputChange:this.onAmountInputChange,receiversCount:this.props.receivers.size,ref:"send_money_amount_input",value:t});else s=c("React").createElement(c("P2PBigAmount.react"),{amount:t,className:"_3oh-",currencyCode:v.currencyCode,size:"large"});r=c("React").createElement("div",{className:"_2abn"+(u?" _74p":"")},s)}return r},renderActionText:function q(){if(this.isRequesting())return i._("Send request to");return i._("Send to")},renderActionToggleHeader:function q(){__p&&__p();var r=this.isPaying(),s=this.isRequesting();if(this.isPayingForRequest()||!l)return null;return c("React").createElement("div",{className:"_4uvi"},c("React").createElement(c("P2PSendMoneyDialogActionHeader.react"),{isPayTabDisabled:this.isGroupRequest()||!this.props.p2pPaymentConfig.enabledActions.send,isRequestTabDisabled:!this.props.p2pPaymentConfig.enabledActions.request,isPaying:r,isRequesting:s,onPayClick:function(){if(this.isPaying())return;this.setState({isPaying:true,isRequesting:false},function(){this.focusAmountInput();this.log(c("P2PPaymentLoggerEvent").UI_ACTN_INITIATE_SEND)}.bind(this))}.bind(this),onRequestClick:function(){if(!this.isRequesting())this.setState({isPaying:false,isRequesting:true},function(){this.focusAmountInput();this.log(c("P2PPaymentLoggerEvent").UI_ACTN_INITIATE_REQUEST)}.bind(this))}.bind(this)}))},renderLayers:function q(){__p&&__p();var r={},s=this.props.receivers.get(0)||{},t=s.short_name,u=void 0,v=void 0,w=void 0;if(this.props.useModal)w={LayerFadeOnShow:false};if(this.state.addCreditCardDialogShown){if(this.state.isAmountValid){v=i._("Please enter a debit card to send {Amount} to {Recipient name}. Credit cards can't be used.",[i.param("Amount",this.props.currencySymbol+this.state.amount),i.param("Recipient name",t)]);u=i._("Pay")}r.addCreditCard=c("React").createElement(c("P2PAddCreditCardDialog.react"),{behaviors:w,eventFlow:this.getEventFlow(),loggingData:this.getPlatformLoggingData(),onCancel:this.onAddCreditCardCancel,onSuccess:this.onAddCreditCardSuccess,ref:"send_money_dialog_add_credit_card_form",saveButtonText:u,showCancelButton:!!k,text:v})}else if(this.state.confirmAmountDialogShown)r.confirmAmount=c("React").createElement(c("P2PConfirmAmountDialog.react"),{amount:this.state.amount,behaviors:w,currencySymbol:this.props.currencySymbol,onCancel:this.onConfirmAmountCancel,onConfirm:this.onConfirmAmountSuccess,receiverName:t});else if(this.state.verifyCreditCardDialogShown)r.verifyCreditCard=c("React").createElement(c("P2PVerifyCreditCardDialog.react"),{asyncRequestState:this.state.asyncRequestState,behaviors:w,creditCard:this.state.selectedCard,isSending:true,onCancel:this.onVerifyCreditCardCancel,onSuccess:this.onVerifyCreditCardSuccess});else if(this.state.editCreditCardDialogShown)r.confirmAmount=c("React").createElement(c("P2PEditCreditCardDialog.react"),{asyncRequestState:this.state.asyncRequestState,behaviors:w,creditCard:this.state.selectedCard,onCancel:this.onEditCreditCardCancel,onSuccess:this.onEditCreditCardSuccess});return r},renderIneligibleMask:function q(){if(!this.isDialogDisabled())return null;return c("React").createElement("div",{className:"_3org"})},renderReceiverImage:function q(r){var s=k?32:40;return c("React").createElement(c("MessengerContactImage.react"),{key:r.userID,size:s,src:r.big_image_src||r.image_src})},renderSingleRecipient:function q(){var r=k?32:40,s=this.props.receivers.get(0)||{};return c("React").createElement("div",{className:"_49no",ref:"send_money_dialog_title"},c("React").createElement(c("ImageBlock.react"),{spacing:"large"},c("React").createElement(c("Image.react"),{className:"_5p-i",height:r,src:s.big_image_src||s.image_src,width:r}),c("React").createElement("div",{className:"_3-8w"},c("React").createElement(c("P2PText.react"),{type:"secondary"},this.renderActionText()),c("React").createElement(c("P2PText.react"),{className:"_5p-j",size:"small",type:"primary",weight:"bold"},s.name))),c("React").createElement(c("Link.react"),{className:"_49np",href:c("P2PLinkConstants").helpCenterURI,target:"_blank"}))},renderTitle:function q(){if(this.props.receivers.size===1)return this.renderSingleRecipient();var r=k?32:40,s=12;return c("React").createElement("div",{className:"_49no",ref:"send_money_dialog_title"},c("React").createElement(c("MessengerHorizontalScroll.react"),{childPadding:8,childWidth:r,freeScroll:true,width:this.getDialogWidth()-s*2},this.props.receivers.map(this.renderReceiverImage)))},render:function q(){__p&&__p();var r=void 0,s=null,t={};if(this.props.useModal&&this.isDialogShowing())return null;if(this.props.useModal){r=c("P2PDialog.react");s=c("React").createElement(c("P2PDialogTitle.react"),{className:"_30wi"},i._("Confirm Payment"));t={layerHideOnBlur:false}}else{r=k?c("MessengerContextualDialog.react"):c("XUIContextualDialog.react");t={alignment:this.props.flyoutAlignment?this.props.flyoutAlignment:k?"right":"left",context:this.props.context,position:this.props.position||"above",onBlur:this._handleBlur}}return c("React").createElement(r,babelHelpers["extends"]({onToggle:this._handleToggle,shown:true,width:this.getDialogWidth()},t),c("React").createElement("div",{className:"_21x9"+(k?" _1pka":"")+(l?" _4uvl":"")+(this.props.useModal?" _35wt":"")},s,this.renderActionToggleHeader(),this.renderSendMoneyForm(),this.renderIneligibleMask(),c("React").createElement(c("P2PLoadingMask.react"),{ref:"send_money_dialog_loader",visible:this.state.loading}),c("React").createElement(c("FBPaymentsRiskThreatMetrixIframe.react"),null)))}});f.exports=p}),null);
__d("P2PEncryptedText.react",["ix","cx","fbt","xuiglyph","Image.react","P2PText.react","React"],(function a(b,c,d,e,f,g,h,i,j,k){"use strict";__p&&__p();var l,m,n=c("React").PropTypes;l=babelHelpers.inherits(o,c("React").Component);m=l&&l.prototype;function o(){var p,q;for(var r=arguments.length,s=Array(r),t=0;t<r;t++)s[t]=arguments[t];return q=(p=m.constructor).call.apply(p,[this].concat(s)),this.getEncryptedMessage=function(){if(this.props.showPasswordProtected)return j._("Encrypted and password protected.");return j._("Encrypted and private.")}.bind(this),q}o.prototype.render=function(){return c("React").createElement(c("P2PText.react"),{type:"secondary"},c("React").createElement("div",{className:"__8t"},c("React").createElement(c("Image.react"),{src:h("89465")})),c("React").createElement("span",{className:"_2pir"},this.getEncryptedMessage()))};o.propTypes={showPasswordProtected:n.bool};o.defaultProps={showPasswordProtected:false};f.exports=o}),null);
__d("P2PNUXNextButton.react",["fbt","P2PButton.react","React"],(function a(b,c,d,e,f,g,h){"use strict";__p&&__p();var i,j,k=c("React").PropTypes;i=babelHelpers.inherits(l,c("React").Component);j=i&&i.prototype;l.prototype.render=function(){return c("React").createElement(c("P2PButton.react"),{label:h._("Next"),onClick:this.props.onNextClick,use:"confirm"})};function l(){i.apply(this,arguments)}l.propTypes={onNextClick:k.func.isRequired};f.exports=l}),null);
__d("P2PNUXFooter.react",["cx","LeftRight.react","P2PEncryptedText.react","P2PNUXNextButton.react","React"],(function a(b,c,d,e,f,g,h){"use strict";__p&&__p();var i,j,k=c("React").PropTypes;i=babelHelpers.inherits(l,c("React").Component);j=i&&i.prototype;l.prototype.render=function(){return c("React").createElement(c("LeftRight.react"),null,c("React").createElement("div",{className:"_2pic"},c("React").createElement(c("P2PEncryptedText.react"),null)),c("React").createElement(c("P2PNUXNextButton.react"),{onNextClick:this.props.onNextClick}))};function l(){i.apply(this,arguments)}l.propTypes={onNextClick:k.func.isRequired};f.exports=l}),null);
__d("P2PSendMoneyNUXListItems.react",["fbt","ix","Image.react","P2PListRow.react","P2PText.react","React"],(function a(b,c,d,e,f,g,h,i){"use strict";__p&&__p();var j,k,l=c("React").PropTypes;j=babelHelpers.inherits(m,c("React").Component);k=j&&j.prototype;function m(){var n,o;for(var p=arguments.length,q=Array(p),r=0;r<p;r++)q[r]=arguments[r];return o=(n=k.constructor).call.apply(n,[this].concat(q)),this.renderRow=function(s,t){return c("React").createElement(c("P2PListRow.react"),{offset:this.props.size},c("React").createElement(c("Image.react"),s),c("React").createElement(c("P2PText.react"),{type:"primary"},t))}.bind(this),o}m.prototype.render=function(){var n=this.props.size;return c("React").createElement("div",null,this.renderRow(n==="small"?{height:18,src:i("94401"),width:18}:{height:36,src:i("94400"),width:36},h._("It's FREE to send and receive money.")),this.renderRow(n==="small"?{height:27,src:i("94405"),width:18}:{height:54,src:i("94404"),width:36},h._("Industry-leading security \u2014 password protection, anti-fraud team and more.")),this.renderRow(n==="small"?{height:13,src:i("94403"),width:18}:{height:26,src:i("94402"),width:36},h._("Send money from your debit card to theirs.")))};m.propTypes={offset:l.oneOf(["small","medium"])};m.defaultProps={size:"small"};f.exports=m}),null);
__d("P2PSendMoneyNUXTitleText.react",["fbt","React"],(function a(b,c,d,e,f,g,h){"use strict";function i(){return c("React").createElement("div",null,h._("Send Money to Anyone"))}f.exports=i}),null);
__d("P2PSendMoneyNUXTitle.react",["cx","fbt","P2PSendMoneyNUXTitleText.react","P2PText.react","React"],(function a(b,c,d,e,f,g,h,i){"use strict";var j,k;j=babelHelpers.inherits(l,c("React").Component);k=j&&j.prototype;l.prototype.render=function(){return c("React").createElement("div",{className:"_4fz1"},c("React").createElement(c("P2PText.react"),{size:"medium",type:"primary"},c("React").createElement(c("P2PSendMoneyNUXTitleText.react"),null)),c("React").createElement(c("P2PText.react"),{type:"secondary"},i._("Split dinner, pay rent or anything else")))};function l(){j.apply(this,arguments)}f.exports=l}),null);
__d("P2PSendMoneyNUXContextualDialog.react",["cx","MessengerEnvironment","MessengerContextualDialog.react","P2PLogger","P2PNUXFooter.react","P2PPaymentLoggerEvent","P2PPaymentLoggerEventFlow","P2PSendMoneyNUXListItems.react","P2PSendMoneyNUXTitle.react","React","XUIContextualDialog.react"],(function a(b,c,d,e,f,g,h){"use strict";__p&&__p();var i,j,k=c("React").PropTypes;i=babelHelpers.inherits(l,c("React").Component);j=i&&i.prototype;function l(){var m,n;for(var o=arguments.length,p=Array(o),q=0;q<o;q++)p[q]=arguments[q];return n=(m=j.constructor).call.apply(m,[this].concat(p)),this.log=function(r,s){c("P2PLogger").log(r,babelHelpers["extends"]({www_event_flow:c("P2PPaymentLoggerEventFlow").UI_FLOW_P2P_SEND},this.props.loggingData,s))}.bind(this),this.handleNextClick=function(){this.log(c("P2PPaymentLoggerEvent").UI_ACTN_SEND_MONEY_NUX_NEXT_CLICK);this.props.onNextClick()}.bind(this),this.$P2PSendMoneyNUXContextualDialog1=function(r){this.props.onToggle(r)}.bind(this),n}l.prototype.componentDidMount=function(){this.log(c("P2PPaymentLoggerEvent").UI_ACTN_SEND_MONEY_NUX_SHOWN)};l.prototype.render=function(){var m=c("MessengerEnvironment").messengerui?c("MessengerContextualDialog.react"):c("XUIContextualDialog.react");return c("React").createElement(m,{alignment:this.props.flyoutAlignment,context:this.props.context,contextRef:this.props.contextRef,onBlur:function(){return this.$P2PSendMoneyNUXContextualDialog1(false)}.bind(this),onToggle:this.$P2PSendMoneyNUXContextualDialog1,position:this.props.position,shown:true,width:this.props.width},c("React").createElement("div",{className:"_56i7"},c("React").createElement("div",{className:"_56jc"},c("React").createElement(c("P2PSendMoneyNUXTitle.react"),null)),c("React").createElement("div",{className:"_56jd"},c("React").createElement(c("P2PSendMoneyNUXListItems.react"),null)),c("React").createElement(c("P2PNUXFooter.react"),{onNextClick:this.handleNextClick})))};l.propTypes={loggingData:k.object,onNextClick:k.func.isRequired,onToggle:k.func.isRequired,width:k.number};l.defaultProps=function(){var m=c("MessengerEnvironment").messengerui;return{flyoutAlignment:m?"right":"left",position:"above",width:m?286:260}}();f.exports=l}),null);
__d("P2PSendMoneySuccessDialog.react",["fbt","Link.react","React","P2PLinkConstants","P2PSuccessDialog.react","P2PText.react"],(function a(b,c,d,e,f,g,h){"use strict";__p&&__p();var i,j,k=c("React").PropTypes;i=babelHelpers.inherits(l,c("React").Component);j=i&&i.prototype;l.prototype.render=function(){return c("React").createElement(c("P2PSuccessDialog.react"),{onOKClick:this.props.onClose,title:h._("Payment Sent")},c("React").createElement(c("P2PText.react"),{type:"primary"},h._("When you receive money, it will go on this card too. You can update your card in {Link with text that goes to settings page}.",[h.param("Link with text that goes to settings page",c("React").createElement(c("Link.react"),{target:"_blank",href:c("P2PLinkConstants").settingsWWWURI},h._("Payments Settings")))])))};function l(){i.apply(this,arguments)}l.propTypes={onClose:k.func.isRequired};f.exports=l}),null);
__d("P2PTransferRiskResult",[],(function a(b,c,d,e,f,g){f.exports=Object.freeze({SUCCESS:"SUCCESS",UNDER_MANUAL_REVIEW:"UNDER_MANUAL_REVIEW",REQUIRE_VERIFICATION:"REQUIRE_VERIFICATION"})}),null);
__d("P2PTransferStore",["Arbiter","P2PActionConstants","ChannelConstants","CurrentUser","CreditCardFormParam","EventEmitter","ImmutableObject","P2PActions","P2PAPI","P2PChannelType","P2PCreditCard","P2PDispatcher","P2PGKValues","P2PNUXRendererUtils","P2PTransferParam","P2PTransferStatus","Set","MercuryThreadInformer"],(function a(b,c,d,e,f,g){"use strict";__p&&__p();var h,i,j=c("MercuryThreadInformer").get(),k=false,l=void 0,m=[],n=void 0,o={},p=false,q=false,r=new(c("Set"))(),s=false;function t(w,x){if(x)o[x]=new(c("ImmutableObject"))(w)}function u(w,x){if(x)o[x]={error:w}}h=babelHelpers.inherits(v,c("EventEmitter"));i=h&&h.prototype;function v(){i.constructor.call(this);c("Arbiter").subscribe(c("ChannelConstants").getArbiterType(c("P2PChannelType").TRANSFER_STATUS_CHANGED),this.handleChannelTransferStatusChanged.bind(this));j.subscribe("messages-received",this.handleMessageReceived.bind(this));c("P2PDispatcher").register(this.onEventDispatched.bind(this))}v.prototype.onEventDispatched=function(w){__p&&__p();var x=w.data,y=w.type;switch(y){case c("P2PActionConstants").TRANSFERS_UPDATED:this.handleTransfersUpdated(x);this.emit("change");break;case c("P2PActionConstants").TRANSFERS_UPDATED_ERROR:this.handleTransfersUpdatedError(x);this.emit("change");break;case c("P2PActionConstants").NUX_TRANSFERS_UPDATED:this.handleNUXTransfersUpdated(x);this.emit("change");break;case c("P2PActionConstants").TRANSFER_ADDED:this.handleTransferAdded(x);this.emit("change");break;case c("P2PActionConstants").TRANSFER_UPDATED:this.handleTransferUpdated(x);this.emit("change");break;case c("P2PActionConstants").TRANSFER_ACCEPTED:this.handleTransferAccepted();this.emit("change");break;case c("P2PActionConstants").TRANSFER_DECLINED:this.handleTransferDeclined(x);this.emit("change");break;case c("P2PActionConstants").EXTENSIVE_TRANSFER_DETAILS_UPDATED:this.handleTransferWithExtensiveDetails(x);this.emit("change");break}};v.prototype.getAsyncRequestState=function(){return o};v.prototype.handleTransfersUpdated=function(w){__p&&__p();n=null;p=true;var x=[],y=w.map(function(A){__p&&__p();var B={},C=this.getTransferByID(A[c("P2PTransferParam").TRANSFER_ID]),D={};if(A.creditCard){B[c("CreditCardFormParam").CREDENTIAL_ID]=A.creditCard[c("CreditCardFormParam").CREDENTIAL_ID];B[c("CreditCardFormParam").CARD_NUMBER]=A.creditCard[c("CreditCardFormParam").CARD_NUMBER];B[c("CreditCardFormParam").CARD_TYPE]=A.creditCard[c("CreditCardFormParam").CARD_TYPE];A.creditCard=new(c("P2PCreditCard"))(B)}if(C)for(var E in C)D[E]=A[E]!==null?A[E]:C[E];x.push(A[c("P2PTransferParam").TRANSFER_ID]);return new(c("ImmutableObject"))(A,D)}.bind(this)),z=m.filter(function(A){return x.indexOf(A[c("P2PTransferParam").TRANSFER_ID])===-1});m=y.concat(z);m=m.sort(function(A,B){return B.creationTime-A.creationTime})};v.prototype.handleTransfersUpdatedError=function(w){n=w.error;u(w.requestID,w.error)};v.prototype.handleNUXTransfersUpdated=function(w){if(!p)this.handleTransfersUpdated(w)};v.prototype.handleTransferAdded=function(w){__p&&__p();var x=null;t(w,w.requestID);if(w&&w.sender&&w.sender.id===c("CurrentUser").getID())s=true;x=m.filter(function(y){return y[c("P2PTransferParam").TRANSFER_ID]===w[c("P2PTransferParam").TRANSFER_ID]})[0];if(x)return;m.push(new(c("ImmutableObject"))(w));m=m.sort(function(y,z){return z.creationTime-y.creationTime})};v.prototype.handleTransferAddedError=function(w){u(w.requestID,w.errors)};v.prototype.handleChannelTransferStatusChanged=function(w,x){x=x.obj;c("P2PActions").transferUpdated(x)};v.prototype.handleMessageReceived=function(w,x){__p&&__p();for(var y in x)if(Object.prototype.hasOwnProperty.call(x,y)){var z=x[y];for(var A=0;A<z.length;A++)if(z[A].attachments&&z[A].attachments.length){var B=c("P2PNUXRendererUtils").getTransferFromMessage(z[A]);if(B){if(!this.hasReceived()&&B.receiver.id===c("CurrentUser").getID())c("P2PAPI").getBannerStates();c("P2PActions").transferAdded(B);return}}}};v.prototype.handleTransferUpdated=function(w){for(var x=0,y=m.length;x<y;x++)if(m[x][c("P2PTransferParam").TRANSFER_ID]===w[c("P2PTransferParam").TRANSFER_ID])m[x]=c("ImmutableObject").set(m[x],w)};v.prototype.handleTransferAccepted=function(){var w=void 0;for(var x=0,y=m.length;x<y;x++)if(m[x][c("P2PTransferParam").STATUS]===c("P2PTransferStatus").PENDING_RECIPIENT_NUX){w={};w[c("P2PTransferParam").STATUS]=c("P2PTransferStatus").COMPLETED;m[x]=c("ImmutableObject").set(m[x],w)}q=true};v.prototype.handleTransferDeclined=function(w){var x=void 0;for(var y=0,z=m.length;y<z;y++)if(m[y][c("P2PTransferParam").TRANSFER_ID]===w[c("P2PTransferParam").TRANSFER_ID]&&m[y][c("P2PTransferParam").STATUS]===c("P2PTransferStatus").PENDING_RECIPIENT_NUX){x={};x[c("P2PTransferParam").STATUS]=c("P2PTransferStatus").CANCELED_DECLINED;m[y]=c("ImmutableObject").set(m[y],x);break}};v.prototype.handleTransferUpdatedError=function(w){u(w.requestID,w.errors)};v.prototype.getTransferByID=function(w){return m.filter(function(x){return w===x[c("P2PTransferParam").TRANSFER_ID]})[0]};v.prototype.getAll=function(w){if(!k){k=true;c("P2PAPI").getTransactions(w)}return m};v.prototype.getNUXTransfer=function(){var w=m.filter(function(x){return c("P2PNUXRendererUtils").isRecipientActionableStatus(x)})[0];if(!w&&!l&&!k){l=true;c("P2PAPI").getNUXTransactions()}if(w&&!w.currency)c("P2PAPI").getNUXTransactions();return w};v.prototype.hasTransfers=function(){return m.length>0};v.prototype.hasAccepted=function(){return q};v.prototype.hasReceivedFromSender=function(w){for(var x=0,y=m.length;x<y;x++)if(m[x].sender.id===w)return true;return false};v.prototype.hasReceived=function(){for(var w=0,x=m.length;w<x;w++)if(m[w].receiver.id===c("CurrentUser").getID())return true;return false};v.prototype.getTransferFetchError=function(){return n};v.prototype.getTransferWithExtensiveDetailsByID=function(w){if(!r.has(w)){r.add(w);c("P2PAPI").getExtensiveTransferDetailsByID(w)}};v.prototype.handleTransferWithExtensiveDetails=function(w){if(this.getTransferByID(w.transfer_id))this.handleTransferUpdated(w);else this.handleTransferAdded(w)};v.prototype.getAllLocal=function(){return m};v.prototype.hasSentDuringSession=function(){return s};v.prototype.shouldShowSenderNUX=function(){return!c("P2PGKValues").P2PUserAddedCredentialBefore&&!this.hasSentDuringSession()};f.exports=new v()}),null);
__d("P2PUnderManualReviewDialog.react",["fbt","P2PButton.react","P2PDialog.react","P2PDialogBody.react","P2PDialogFooter.react","P2PDialogTitle.react","P2PText.react","React"],(function a(b,c,d,e,f,g,h){"use strict";__p&&__p();var i,j,k=c("React").PropTypes;i=babelHelpers.inherits(l,c("React").Component);j=i&&i.prototype;l.prototype.render=function(){return c("React").createElement(c("P2PDialog.react"),{layerHideOnBlur:false,shown:true,width:300},c("React").createElement(c("P2PDialogTitle.react"),{showCloseButton:false},h._("Reviewing Payment Info")),c("React").createElement(c("P2PDialogBody.react"),null,c("React").createElement(c("P2PText.react"),{type:"primary"},h._("For your security, this payment is in review for up to 24 hours. When it's confirmed, it will go through."))),c("React").createElement(c("P2PDialogFooter.react"),null,c("React").createElement(c("P2PButton.react"),{label:h._("OK"),onClick:this.props.onClose,use:"confirm"})))};function l(){i.apply(this,arguments)}l.propTypes={onClose:k.func.isRequired};f.exports=l}),null);
__d("P2PUserEligibilityContainer.react",["immutable","P2PUserEligibilityStore","React","StoreAndPropBasedStateMixin"],(function a(b,c,d,e,f,g){"use strict";__p&&__p();var h=c("React").PropTypes,i=c("React").createClass({displayName:"P2PUserEligibilityContainer",propTypes:{participants:h.instanceOf(c("immutable").List)},mixins:[c("StoreAndPropBasedStateMixin")(c("P2PUserEligibilityStore"))],statics:{calculateState:function j(k){var l=k.participants,m=void 0,n=void 0;if(l){n=l.map(function(o){return o.userID}).toArray();m=c("P2PUserEligibilityStore").getEligibilityByUserIDs(n)}return{p2pEligibilities:m}}},render:function j(){var k=c("React").Children.only(this.props.children);return c("React").cloneElement(k,{p2pEligibilities:this.state.p2pEligibilities})}});f.exports=i}),null);
__d("P2PVerificationFlowHelper",["AsyncDialog","AsyncRequest","P2PAPI","P2PTransferParam","emptyFunction"],(function a(b,c,d,e,f,g){__p&&__p();var h=null,i=null,j=null,k={startVerificationFlow:function l(m,n,o){h=m;i=n;j=o||c("emptyFunction");c("AsyncDialog").send(new(c("AsyncRequest"))("/p2p/verify/dialog/?id="+m))},setupFlowExitHandler:function l(m,n,o,p){__p&&__p();var q=function q(t){j(t);h=null;i=null;j=null;m.destroy();n.destroy()};if(o)m.subscribe("hide",function(){q(p)});else{var r=false,s=false;m.subscribe("confirm",function(){r=true});m.subscribe("hide",function(){if(r){m.destroy();n.destroy()}else if(i)n.show();else q(false)});n.subscribe("confirm",function(){s=true;var t={};t[c("P2PTransferParam").TRANSFER_ID]=h;c("P2PAPI").cancelTransaction({formData:t});q(false)});n.subscribe("hide",function(){if(!s)m.show()})}}};f.exports=k}),null);
__d("P2PSendMoneyButton.react",["fbt","MessengerEnvironment","immutable","P2PAbstractSendMoneyButton.react","P2PActions","P2PErrorDialog.react","P2PGKValues","P2PGroupSendParticipantsPickerDialog.react","P2PGroupSendDialog.react","P2PLogger","P2PPaymentLoggerEvent","P2PPaymentLoggerEventFlow","P2PPasswordProtectionNUXDialog.react","P2PPasswordProtectionStatusTypes","P2PSendMoneyDialog.react","P2PUserEligibilityContainer.react","P2PSendMoneyNUXContextualDialog.react","P2PSendMoneySuccessDialog.react","P2PTransferParam","P2PTransferStore","P2PTransferRiskResult","P2PUnderManualReviewDialog.react","P2PVerificationFlowHelper","PECurrency","React","ReactDOM","ReactLayeredComponentMixin_DEPRECATED","emptyFunction"],(function a(b,c,d,e,f,g,h){"use strict";__p&&__p();var i=c("React").PropTypes,j=c("React").createClass({displayName:"P2PSendMoneyButton",mixins:[c("ReactLayeredComponentMixin_DEPRECATED")],propTypes:{amount:i.string,button:i.object,groupSendRecipientUserIDs:i.arrayOf(i.string),groupThreadFBID:i.string,flyoutAlignment:i.string,openRequestTab:i.bool,isNewEmptyLocalThread:i.bool,isGroupChat:i.bool,onCompletion:i.func,onTrigger:i.func,p2pPaymentConfig:i.shape({currencyCode:i.string.isRequired,enabledActions:i.object.isRequired,enabledPaymentMethods:i.object.isRequired,maxTransferAmount:i.number.isRequired,title:i.string,use_payment_module_method_picker:i.bool,countryCode:i.string.isRequired,postalRegex:i.string.isRequired}),participants:i.instanceOf(c("immutable").List),platformData:i.object,sendMoneyDialogShown:i.bool,threadID:i.string,threadFBID:i.string},getDefaultProps:function k(){return{amount:"",groupThreadFBID:"",openRequestTab:false,onTrigger:c("emptyFunction"),sendMoneyDialogShown:false}},getInitialState:function k(){return{sendMoneyNUXDismissed:false}},log:function k(l,m){c("P2PLogger").log(l,babelHelpers["extends"]({www_event_flow:c("P2PPaymentLoggerEventFlow").UI_FLOW_P2P_SEND},m))},canShowSendMoneyDialog:function k(){return!!(this.props.participants&&this.props.participants.size)},originalCreateTransactionResponse:null,_onButtonClick:function k(){var l=this.getRecipients();this.log(c("P2PPaymentLoggerEvent").UI_ACTN_SEND_MONEY_BUTTON_CLICKED,this.getLogData(l));this.canShowSendMoneyDialog()&&this.showSendMoneyDialog()},hideSendMoneyDialog:function k(){c("P2PActions").chatSendViewClosed({threadID:this.props.threadID})},showSendMoneyDialog:function k(){c("P2PActions").chatSendViewOpened({referrer:this.props.referrer,threadID:this.props.threadID})},_handleDialogToggle:function k(l){if(!l)this.hideSendMoneyDialog();else this.showSendMoneyDialog()},handlePaymentRequestSuccess:function k(){this.hideSendMoneyDialog();this.props.onTrigger();this.props.onCompletion&&this.props.onCompletion()},handleOnSendSuccess:function k(l){this.hideSendMoneyDialog();var m=l[c("P2PTransferParam").RISK_RESULT];this.originalCreateTransactionResponse=l;if(m===c("P2PTransferRiskResult").REQUIRE_VERIFICATION)c("P2PVerificationFlowHelper").startVerificationFlow(l.id,true,this.handleVerificationCompleted);else if(m===c("P2PTransferRiskResult").UNDER_MANUAL_REVIEW)this.showUnderManualReviewDialog();else this.handlePostSendSteps(false)},handleVerificationCompleted:function k(l){this.handlePostSendSteps(!l)},handlePostSendSteps:function k(l){__p&&__p();var m=this.originalCreateTransactionResponse,n=m.passwordProtection===c("P2PPasswordProtectionStatusTypes").NOT_SET;if(!l&&m.isFirstSend){this._passwordNUXPending=n;this.showSendSuccessDialog()}else if(n)this.showPasswordProtectionDialog();else c("P2PActions").hideDialog();this.originalCreateTransactionResponse=null;this.props.onTrigger();this.props.onCompletion&&this.props.onCompletion()},handleConfirmationOKClick:function k(){if(this._passwordNUXPending){this._passwordNUXPending=false;this.showPasswordProtectionDialog()}else c("P2PActions").hideDialog()},handleSendError:function k(l){this.showErrorDialog(l)},handlePaymentRequestError:function k(l){this.showPaymentRequestErrorDialog(l)},getGroupSendDialog:function k(){if(c("P2PGKValues").P2PGroupRequestEnabled)return c("P2PGroupSendParticipantsPickerDialog.react");return c("P2PGroupSendDialog.react")},getLogData:function k(l){if(l.size>1)return{object_ids:l.map(function(m){return m.userID}).join(",")};var m=l.get(0);return{object_id:m&&m.userID}},getMoneyButtonNode:function k(){return c("ReactDOM").findDOMNode(this.refs.p2pSendMoneyButton)},getRecipients:function k(){if(!this.props.participants)return c("immutable").List();if(!this.props.isGroupChat)return this.props.participants.slice(0,1);var l=this.props.groupSendRecipientUserIDs||[],m=l.reduce(function(n,o){n[o]=true;return n},{});return this.props.participants.filter(function(n){return!!m[n.userID]})},setGroupSendDialog:function k(l,m){var n=this.getGroupSendDialog();l.groupSendMoneyDialog=c("React").createElement(c("P2PUserEligibilityContainer.react"),{participants:this.props.participants},c("React").createElement(n,{amount:this.props.amount,context:this.getMoneyButtonNode(),flyoutAlignment:this.props.flyoutAlignment,openRequestTab:this.props.openRequestTab,currency:m,onToggle:this._handleDialogToggle,participants:this.props.participants,referrer:this.props.referrer,threadID:this.props.threadID,threadFBID:this.props.threadFBID}))},getGroupSendRecipient:function k(){return this.props.participants&&this.props.participants.find(function(l){return l.userID===this.props.groupSendRecipientUserID}.bind(this))},showErrorDialog:function k(l){var m=h._("Problem Sending Money");c("P2PActions").showDialog(c("P2PErrorDialog.react"),{error:l,onOKClick:c("P2PActions").hideDialog,title:m})},showPaymentRequestErrorDialog:function k(l){var m=h._("Problem Requesting Money");c("P2PActions").showDialog(c("P2PErrorDialog.react"),{error:l,onOKClick:c("P2PActions").hideDialog,title:m})},showPasswordProtectionDialog:function k(){c("P2PActions").showDialog(c("P2PPasswordProtectionNUXDialog.react"),{onComplete:c("P2PActions").hideDialog})},showSendSuccessDialog:function k(){c("P2PActions").showDialog(c("P2PSendMoneySuccessDialog.react"),{onClose:this.handleConfirmationOKClick})},showUnderManualReviewDialog:function k(){c("P2PActions").showDialog(c("P2PUnderManualReviewDialog.react"),{onClose:this.handlePostSendSteps.bind(this,false)})},shouldShowNUX:function k(){return!this.props.sendMoneyNUXDismissed&&!this.state.sendMoneyNUXDismissed&&c("P2PTransferStore").shouldShowSenderNUX()},renderLayers:function k(){__p&&__p();if(!this.props.p2pPaymentConfig)return null;var l={},m=this.props.p2pPaymentConfig.currencyCode,n=c("PECurrency").getCurrencySymbol(m)||"$",o=this.getRecipients();if(this.canShowSendMoneyDialog()&&this.props.sendMoneyDialogShown)if(this.shouldShowNUX())l.nux=c("React").createElement(c("P2PSendMoneyNUXContextualDialog.react"),{context:this.getMoneyButtonNode(),loggingData:this.getLogData(o),flyoutAlignment:this.props.flyoutAlignment,onNextClick:function(){return this.setState({sendMoneyNUXDismissed:true})}.bind(this),onToggle:this._handleDialogToggle});else if(!o.size&&!this.props.groupSendRecipientUserID&&this.props.isGroupChat&&this.props.threadFBID)this.setGroupSendDialog(l,m);else l.sendMoneyDialog=c("React").createElement(c("P2PUserEligibilityContainer.react"),{participants:this.props.participants,ref:"send_money_dialog"},c("React").createElement(c("P2PSendMoneyDialog.react"),{amount:this.props.amount,context:this.getMoneyButtonNode(),currency:m,currencySymbol:n,groupThreadFBID:this.props.groupThreadFBID,flyoutAlignment:this.props.flyoutAlignment,openRequestTab:this.props.openRequestTab,memoText:this.props.memoText,onToggle:this._handleDialogToggle,onError:this.handleSendError,onPaymentRequestError:this.handlePaymentRequestError,onPaymentRequestSuccess:this.handlePaymentRequestSuccess,onSendSuccess:this.handleOnSendSuccess,p2pPaymentConfig:this.props.p2pPaymentConfig,platformData:this.props.platformData,receivers:o,ref:"send_money_dialog",referrer:this.props.referrer,paymentRequestID:this.props.paymentRequestID,useModal:this.props.useModal}));return l},render:function k(){if(this.props.isNewEmptyLocalThread&&this.props.participants.size>1)return null;if(!this.props.p2pPaymentConfig)return null;return c("React").createElement(c("P2PAbstractSendMoneyButton.react"),{button:this.props.button,className:this.props.className,isActive:this.canShowSendMoneyDialog()&&this.props.sendMoneyDialogShown,isMessenger:!!c("MessengerEnvironment").messengerui,onClick:this._onButtonClick,ref:"p2pSendMoneyButton"})}});f.exports=j}),null);
__d("P2PSendMoneyContainer.react",["CurrentUser","immutable","ImmutableObject","MercuryIDs","MercuryParticipants","MercuryShareAttachmentRenderLocations","MercuryThreads","P2PSendMoneyButton.react","P2PSendMoneyDialogStore","React","StoreAndPropBasedStateMixin"],(function a(b,c,d,e,f,g){"use strict";__p&&__p();var h=c("React").PropTypes,i=c("React").createClass({displayName:"P2PSendMoneyContainer",propTypes:{button:h.node,className:h.string,flyoutAlignment:h.string,p2pPaymentConfig:h.object,participantIDs:h.array,onCompletion:h.func,onTrigger:h.func,threadID:h.string},getDefaultProps:function j(){return{referrer:c("MercuryShareAttachmentRenderLocations").CHAT}},mixins:[c("StoreAndPropBasedStateMixin")(c("MercuryParticipants"),c("MercuryThreads"),c("P2PSendMoneyDialogStore"))],statics:{calculateState:function j(k){__p&&__p();var l=k.threadID,m=null,n=k.participantIDs,o=null,p=null,q=void 0,r=void 0,s=k.referrer;if(!l)return{};q=c("P2PSendMoneyDialogStore").getStateByThreadID(l);r=q&&q.referrer;if(l){m=c("MercuryThreads").getForFBID(c("CurrentUser").getID()).getOrFetch(l);if(!n&&m&&m.participants)n=m.participants.filter(function(t){return c("CurrentUser").getID()!==c("MercuryIDs").getUserIDFromParticipantID(t)});if(n){o=c("immutable").List();o=o.withMutations(function(t){n&&n.forEach(function(u){var v=c("MercuryParticipants").getOrFetch(u),w=c("MercuryIDs").getUserIDFromParticipantID(u);v=v&&c("ImmutableObject").set(v,{userID:w});if(v)t.push(v)})})}}p=c("MercuryThreads").get().isNewEmptyLocalThread(l);return babelHelpers["extends"]({},q,{participants:o,isNewEmptyLocalThread:p,isGroupChat:c("MercuryIDs").isGroupChat(l)&&!p,threadID:l,threadFBID:m&&m.thread_fbid,referrer:r||s})}},render:function j(){return c("React").createElement(c("P2PSendMoneyButton.react"),babelHelpers["extends"]({},this.state,{button:this.props.button,className:this.props.className,flyoutAlignment:this.props.flyoutAlignment,onTrigger:this.props.onTrigger,p2pPaymentConfig:this.props.p2pPaymentConfig}))}});f.exports=i}),null);