if (self.CavalryLogger) { CavalryLogger.start_js(["9I5Pd"]); }

__d("messengerThreadlistReact",["cx","csx","fbt","bs_array","bs_block","bs_curry","React","Parent","utilsRe","ReactDOM","debounce","linkReact","UserAgent","bs_caml_array","MercuryIDs","bs_pervasives","CurrentUser","ReasonReact","bs_js_primitive","MessagingTag","MercuryConfig","MessengerView","MercuryFilters","MessengerActions","MercuryThreadInfo","KeyEventController","SubscriptionsHandler","chatSidebarSheetReact","messengerSpinnerReact","messageRequestLoggerRe","MessengerTypeaheadUtils","MessengerComposerActions","MercuryTypeaheadConstants","MessengerSearchFunnelLogger","messengerNewMessagesNoticeReact","messengerThreadlistLinkRowReact","messengerFlexScrollableAreaReact","workchatThreadListInviteRowReact","messengerMessageRequestsInfoReact","messengerThreadListGridWrapperReact","messengerGraphQLSearchTypeaheadReact","MessengerSearchFunnelLoggerConstants","messengerThreadlistRowContainerReact","messengerThreadlistNewMessageRowReact","workChatThreadlistNewsfeedActionReact","messengerThreadlistMessageRequestsRowReact"],(function aa(ba,a,ca,da,ea,b,fa,ga,c){"use strict";__p&&__p();function d(u,v,w){if(w)if(u.length>0&&v.length>0){var x=a("bs_caml_array").caml_array_get(a("bs_caml_array").caml_array_get(u,0),0),y=a("bs_caml_array").caml_array_get(a("bs_caml_array").caml_array_get(v,0),0);if(x.unread_count>0&&x.thread_id!==w[0]&&x!==y)return+a("MercuryThreadInfo").isMuted(x);else return 0}else return 0;else return 0}function e(u,v){var w=+u.ctrlKey,x=+u.metaKey,y=+u.shiftKey,z=+a("KeyEventController").filterEventTypes(u,v),A=+a("KeyEventController").filterEventTargets(u,v),B=a("Parent").bySelector(u.target,"._150g");if(w!==0||x!==0||y!==0||!(z!==0&&A!==0&&B==null))return 0;else return 1}function f(u,v){__p&&__p();var w=+u.ctrlKey,x=+u.metaKey,y=+a("UserAgent").isPlatform("Mac OS X"),z=+a("UserAgent").isPlatform("iOS"),A=+a("KeyEventController").filterEventTypes(u,v),B=a("Parent").bySelector(u.target,"._150g");if(w!==0)if(x!==0||y!==0||z!==0||!(A!==0&&B==null))return 0;else return 1;else if(x!==0)if(y!==0)if(z!==0||!(A!==0&&B==null))return 0;else return 1;else if(z!==0&&A!==0&&B==null)return 1;else return 0;else return 0}function g(u){return a("bs_block").__(3,[u])}function h(u,v,w){__p&&__p();var x=w.findIndex(function(z){__p&&__p();var A=z.length;if(A!==1)if(A!==0&&u&&a("bs_caml_array").caml_array_get(z,0).thread_id===u[0])return 1;else return 0;else{var B=z[0];if(u&&B.thread_id===u[0])return 1;else return 0}}),y=a("bs_pervasives").min(a("bs_pervasives").max(x+v|0,0),w.length-1|0);return a("bs_caml_array").caml_array_get(a("bs_caml_array").caml_array_get(w,y),0).thread_id}function i(u){return a("bs_block").__(4,[u])}function j(u,v){v.preventDefault();return a("bs_block").__(2,[u])}function k(u){u.preventDefault();return 4}function l(){a("MessengerSearchFunnelLogger").startFunnel("WWW_MESSENGER_SEARCH_SESSION_FUNNEL");return 0}function m(){a("MessengerSearchFunnelLogger").endFunnel("WWW_MESSENGER_SEARCH_SESSION_FUNNEL");return 1}function n(u,v){u.preventDefault();var w=v[2][4][0];if(w)return w[0].focusInput();else return 0}function o(u,v){v[2][4][0]=u==null?0:[u];return 0}function p(u){return a("bs_block").__(1,[u.target.value])}function q(u,v){var w=v[2][6];if(w){a("MessengerTypeaheadUtils").scrollEntryIntoView(u,w[0]);return 0}else return 0}function ha(u){u.preventDefault();a("MessengerActions").changeFolder(a("MessagingTag").OTHER);return 0}function ia(u){u.preventDefault();a("MessengerActions").changeFolder(a("MessagingTag").INBOX);a("MessengerActions").changeFilter(a("MercuryFilters").ALL);return 0}function r(u,v,w,x){__p&&__p();var y=[];a("bs_array").iter(function(B){__p&&__p();var C=v[B];if(C!==undefined){var D=C[1],E=C[0];if(E==null)return 0;else{var F=a("ReactDOM").findDOMNode(E).getBoundingClientRect();if(F.top>u.top-10&&F.bottom<u.bottom+10){y.push({threadID:D.thread_id,unread:+(D.unread_count>0)});return 0}else return 0}}else return 0},Object.keys(v));if(y.length){var z=a("bs_array").map(function(B){return a("MercuryIDs").getThreadKeyfromThreadIDUserID(B.threadID,x)},y),A=z.join(",");return a("messageRequestLoggerRe").logItemImpression(y,A,w)}else return 0}var s=a("debounce")(function(u){var v=u[1],w=u[0],x=w[6];if(x){var y=x[0].getArea().getElement().getBoundingClientRect();r(y,w[7],a("MessagingTag").PENDING,v);return r(y,w[8],a("MessagingTag").OTHER,v)}else return 0},500);function ja(u,v,w,x){var y=v[2],z=y[0],A=z&&z[0]===a("bs_caml_array").caml_array_get(x,0).thread_id?true:false;return a("ReasonReact").element([a("bs_caml_array").caml_array_get(x,0).thread_id],0,a("messengerThreadlistMessageRequestsRowReact").make(w,A,a("bs_curry")._1(v[1],g),[],x,u,[]))}function ka(u,v,w){__p&&__p();var x=w[2];if(u.folder===a("MessagingTag").PENDING){x[7][u.thread_id]=[v,u];return 0}else if(u.folder===a("MessagingTag").OTHER){x[8][u.thread_id]=[v,u];return 0}else return 0}function la(u,v,w,x,y,z){var A=w[2],B=u&&u[0]===z.thread_id?1:0,C=A[0],D=C?1:0,E=A[0],F=E&&E[0]===z.thread_id?1:0,G=B!==0?D!==0&&F===0?0:1:F!==0?1:0,H=+(z.folder===a("MessagingTag").PENDING||z.folder===a("MessagingTag").OTHER);return a("ReasonReact").element([z.thread_id],[H!==0?a("bs_curry")._1(w[0],function(I,J){return ka(z,I,J)}):function(){return 0}],a("messengerThreadlistRowContainerReact").make([x],[B],[F],[A[2]],[G],a("bs_curry")._1(w[1],g),a("bs_curry")._1(w[0],q),z,v,y,[]))}function ma(u){return a("bs_block").__(0,[u==null?0:[u]])}function na(u,v){var w=u[1],x=u[0],y=w==null?a("MessengerSearchFunnelLoggerConstants").OTHER:w===a("MercuryTypeaheadConstants").FRIEND_TYPE?a("MessengerSearchFunnelLoggerConstants").USER_CONTACT:w===a("MercuryTypeaheadConstants").NON_FRIEND_TYPE?a("MessengerSearchFunnelLoggerConstants").USER_NON_CONTACT:w===a("MercuryTypeaheadConstants").FB4C_TYPE?a("MessengerSearchFunnelLoggerConstants").COWORKER:w===a("MercuryTypeaheadConstants").GAME_TYPE?a("MessengerSearchFunnelLoggerConstants").GAME:w===a("MercuryTypeaheadConstants").INTERNAL_BOT_PAGE_TYPE||w===a("MercuryTypeaheadConstants").COMMERCE_PAGE_TYPE||w===a("MercuryTypeaheadConstants").MEETING_ROOM_PAGE_TYPE?a("MessengerSearchFunnelLoggerConstants").PAGE:a("MessengerSearchFunnelLoggerConstants").OTHER;a("MessengerActions").selectThread(x,w);a("MessengerSearchFunnelLogger").logResultSelection("WWW_MESSENGER_SEARCH_SESSION_FUNNEL",v[2][3],x,y);return 0}var t=a("ReasonReact").reducerComponentWithRetainedProps("MessengerThreadlistReact");function oa(u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,ra){__p&&__p();var K=function K(L,M,N){__p&&__p();var O=N[3],G=O[0],P=typeof L==="number"?L!==0?G.length-1|0:(-G.length|0)-1|0:L[0],Q=+M.altKey,R=a("Parent").bySelector(M.target,"._4rv3"),S=N[2][0],T=a("Parent").bySelector(M.target,"._1ht1"),U=0;if(Q!==0)if(R==null)U=1;else{var V=O[4];if(V!==0)if(P===1&&G.length>0){a("MessengerActions").selectThread(a("bs_caml_array").caml_array_get(a("bs_caml_array").caml_array_get(G,0),0).thread_id,null);return 0}else return 0;else{var W=G.findIndex(function(Y){if(Y.length!==1)return 0;else{var Z=Y[0],Q=O[2];if(Q&&Q[0]===Z.thread_id)return 1;else return 0}});if(W!==-1){var X=a("bs_caml_array").caml_array_get(G,W+P|0);a("MessengerActions").selectThread(a("bs_caml_array").caml_array_get(X,0).thread_id);if(O[1]&&W===0&&P===-1)a("MessengerActions").changeDetailView(a("MessengerView").DETAIL.COMPOSE);if(W===(G.length-1|0))return a("bs_curry")._1(O[3],0);else return 0}else return 0}}else U=1;if(U===1)if(S&&!(T==null)){M.preventDefault();return a("bs_curry")._2(N[1],i,P)}else return 0},sa=function sa(){a("MessengerSearchFunnelLogger").logClearQuery("WWW_MESSENGER_SEARCH_SESSION_FUNNEL");if(v)a("bs_curry")._1(v[0],0);return 2},ta=function ta(){return 3},ua=function ua(L,ra){__p&&__p();L.stopPropagation();a("MessengerComposerActions").exitComposeState();if(B){var M=G.find(function(N){var O=N.length;if(O!==1)if(O!==0)return+(a("bs_js_primitive").undefined_to_opt(N.find(function(M){return+(M.unread_count===0)}))===0);else return 0;else{var P=N[0];return+(P.unread_count===0)}});a("MessengerActions").selectThread(M!==undefined?a("bs_caml_array").caml_array_get(M,0).thread_id:null,null);return 0}else return 0},va=function va(L,ra){L.preventDefault();return a("bs_curry")._1(D,0)},wa=function wa(z,A,J,L){__p&&__p();var M=0,N=0;if(J!==0)return null;else if(z)if(z[0]!==0)return null;else N=2;else N=2;if(N===2)if(A)if(A[0]!==0)return a("React").createElement("div",{className:"_19hf"},a("ReasonReact").element(0,0,a("messengerSpinnerReact").make(0,0,0,[])));else M=1;else M=1;if(M===1)return a("React").createElement("div",{className:"_19hf"},a("ReasonReact").element(0,0,a("linkReact").make(0,0,0,0,0,0,["#"],[a("bs_curry")._1(L[0],va)],0,0,0,0,[-1],0,0,[c._("Show Older")])))},xa=function xa(L){__p&&__p();if(G.length)return a("ReasonReact").element(0,0,a("messengerThreadListGridWrapperReact").make(c._("Conversation List"),[a("bs_array").map(function(R){if(R.length!==1)return ja(H,L,I,R);else{var S=R[0];return la(u,H,L,x,J,S)}},G)]));else{var M;if(x===a("MessagingTag").INBOX){var N=+(w===a("MercuryFilters").UNREAD);M=N!==0?c._("No unread messages found."):c._("No messages found.")}else if(x===a("MessagingTag").PENDING){var O=+a("MercuryConfig").RTCR;M=O!==0?c._("No Connection requests found."):c._("No Message requests found.")}else M=c._("No filtered requests found.");var P=+(x!==a("MessagingTag").INBOX||w!==a("MercuryFilters").ALL),Q=P!==0?a("ReasonReact").element(0,0,a("linkReact").make(0,0,0,0,0,0,0,[ia],0,0,0,0,0,0,0,[c._("Return to inbox.")])):null;return a("React").createElement("div",{className:"_3blk"},M,a("React").createElement("div",{className:"_3bll"},Q))}};return[t[0],t[1],t[2],function(L){__p&&__p();var M=L[3],N=L[2];if(M[5]!==x||J!==M[6])s([N,H]);var O=N[6],P=O?+O[0].isScrolledToTop():0,Q=d(G,M[0],u),R=0;if(P!==0)R=1;else if(Q!==0)if(E){var S=E[0],T=N.slice(),U=+(S.length===0);T[3]=U!==0?S:N[3];T[5]=1;return T}else return N;else R=1;if(R===1)if(E){var V=E[0],W=N.slice(),X=+(V.length===0);W[3]=X!==0?V:N[3];W[5]=N[5]&&1-P;return W}else return N},function(L){s([L[2],H]);return 0},function(L){var M=L[1],N=L[0],O=+(M[2][1]!==N[2][1]),P=y&&1-N[3][1],Q=M[2][6];if(O!==0&&P!==0&&Q){Q[0].scrollToTop();return 0}else return 0},t[6],t[7],t[8],function(L){var M=L[2],N=M[5]&&1-M[1],O=c._("Conversations"),P=E?1:0,Q=+(x===a("MessagingTag").INBOX),R;if(Q!==0){var S=+a("CurrentUser").isWorkUser();R=a("ReasonReact").element(0,[a("bs_curry")._1(L[0],o)],a("messengerGraphQLSearchTypeaheadReact").make("_5iwm"+(M[1]||+(M[3].length>0)?" _5iwn":"")+" _150g",1,0,0,0,[+(M[3]==="")&&1-P],[P],[M[1]],a("bs_curry")._1(L[1],m),a("bs_curry")._1(L[1],p),a("bs_curry")._1(L[1],sa),a("bs_curry")._1(L[1],l),a("bs_curry")._1(L[0],q),function(Y,Z){return a("bs_curry")._2(L[0],na,[Y,Z])},S!==0?c._("Search Workplace Chat"):c._("Search Messenger"),[M[3]],1,1,"_11_d",H,[]))}else R=null;var T=+a("CurrentUser").isWorkUser()&&1-M[1],U=+(x===a("MessagingTag").PENDING),V=+(x===a("MessagingTag").INBOX&&C.length>0),W=+(x===a("MessagingTag").PENDING),X=+a("CurrentUser").isWorkUser();return a("React").createElement("div",{className:"_2xhi"},a("ReasonReact").element(0,0,a("chatSidebarSheetReact").make("_p0g",[])),a("ReasonReact").element(0,0,a("messengerNewMessagesNoticeReact").make(N,a("bs_curry")._1(L[1],k),0,[])),a("ReasonReact").element(0,[a("bs_curry")._1(L[1],ma)],a("messengerFlexScrollableAreaReact").make([a("bs_curry")._1(L[1],ta)],[R,T!==0?a("ReasonReact").element(0,0,a("workchatThreadListInviteRowReact").make([])):null,U!==0?a("ReasonReact").element(0,0,a("messengerMessageRequestsInfoReact").make([])):null,a("React").cloneElement(a("React").createElement("div",{className:M[1]&&1-P?"accessible_elem":"",role:"navigation"}),{"aria-label":O},V!==0?a("ReasonReact").element(0,0,a("messengerThreadlistMessageRequestsRowReact").make(I,false,a("bs_curry")._1(L[1],g),C,[],H,[])):null,y!==0?a("ReasonReact").element(0,0,a("messengerThreadlistNewMessageRowReact").make(B,a("bs_curry")._1(L[0],ua),[])):null,xa(L),W!==0?a("messengerThreadlistLinkRowReact").make(ha):null,F?a("bs_curry")._1(F[0],0):wa(z,A,J,L))])),X!==0?a("ReasonReact").element(0,0,a("workChatThreadlistNewsfeedActionReact").make([])):null)},function(){return[0,0,0,"",[0],0,0,{},{}]},[G,y,u,D,B,x,J],function(L,M){__p&&__p();if(typeof L==="number")switch(L){case 0:var N=M.slice();return a("bs_block").__(0,[(N[1]=1,N)]);case 1:var O=M.slice();return a("bs_block").__(0,[(O[1]=0,O[3]="",O)]);case 2:var P=M.slice();return a("bs_block").__(0,[(P[3]="",P)]);case 3:if(M[1])return 0;else{var Q=M[6];if(Q){var R=Q[0],S=+R.isScrolledToBottom(),T=+R.isScrolledToTop(),U=M[5];if(S!==0){var V=0;if(T!==0)if(U!==0){var W=M.slice();return a("bs_block").__(3,[(W[5]=0,W),function($){a("bs_curry")._1(D,0);return s([$[2],H])}])}else V=1;else V=1;if(V===1)return a("bs_block").__(2,[function($){a("bs_curry")._1(D,0);return s([$[2],H])}])}else{var X=0;if(T!==0)if(U!==0){var Y=M.slice();return a("bs_block").__(3,[(Y[5]=0,Y),function($){return s([$[2],H])}])}else X=1;else X=1;if(X===1)return a("bs_block").__(2,[function($){return s([$[2],H])}])}}else return 0}break;case 4:var Z=M.slice();return a("bs_block").__(3,[(Z[5]=0,Z),function($){var Q=$[2][6];if(Q){Q[0].scrollToTop();return 0}else return 0}])}else switch(L.tag|0){case 0:var ya=M.slice();return a("bs_block").__(1,[(ya[6]=L[0],ya)]);case 1:var za=M.slice();return a("bs_block").__(0,[(za[3]=L[0],za)]);case 2:var Aa=M.slice();return a("bs_block").__(0,[(Aa[2]=L[0],Aa)]);case 3:var Ba=M.slice();return a("bs_block").__(0,[(Ba[0]=[L[0]],Ba)]);case 4:var Ca=M.slice();return a("bs_block").__(0,[(Ca[0]=[h(M[0],L[0],G)],Ca)])}},function(L){__p&&__p();return[[function(){__p&&__p();var M=new(a("SubscriptionsHandler"))(),N=[-1],O=[1],P=[-5],Q=[5];M.addSubscriptions(a("KeyEventController").registerKey("UP",a("bs_curry")._1(L[0],function(R,S){return K(N,R,S)}),e),a("KeyEventController").registerKey("DOWN",a("bs_curry")._1(L[0],function(R,S){return K(O,R,S)}),e),a("KeyEventController").registerKey("PAGE_UP",a("bs_curry")._1(L[0],function(R,S){return K(P,R,S)})),a("KeyEventController").registerKey("PAGE_DOWN",a("bs_curry")._1(L[0],function(R,S){return K(Q,R,S)})),a("KeyEventController").registerKey("HOME",a("bs_curry")._1(L[0],function(R,S){return K(0,R,S)})),a("KeyEventController").registerKey("END",a("bs_curry")._1(L[0],function(R,S){return K(1,R,S)})),a("KeyEventController").registerKey("LEFT",a("bs_curry")._1(L[1],function(R){return j(0,R)})),a("KeyEventController").registerKey("RIGHT",a("bs_curry")._1(L[1],function(R){return j(1,R)})),a("KeyEventController").registerKey("K",a("bs_curry")._1(L[0],n),f));return M},function(M){M.release();return 0}],0]},t[14]]}var pa=a("ReasonReact").wrapReasonForJs(t,function(u){var v=a("utilsRe").nullUndefinedBooleanToOptionBool(u.isComposing);return oa(a("bs_js_primitive").null_undefined_to_opt(u.activeThreadID),a("bs_js_primitive").null_undefined_to_opt(u.clearQuery),u.filter,u.folder,v?v[0]:0,a("utilsRe").nullUndefinedBooleanToOptionBool(u.isLoaded),a("utilsRe").nullUndefinedBooleanToOptionBool(u.isLoading),+u.isNewMessageActive,u.newMessageRequestThreads,u.onLoadMoreRequest,a("bs_js_primitive").null_undefined_to_opt(u.queryString),a("bs_js_primitive").null_undefined_to_opt(u.renderLoadMore),a("bs_array").map(function(w){return[].concat(w)},u.threads),u.viewer,u.onAggregationClick,+u.showAggregation,[])}),qa=10;b.hasNewUnreadMessages=d;b.filterKeyEvent=e;b.filterPlatformSpecificModifierKey=f;b.handleThreadFocus=g;b.getFocusedThreadId=h;b.updateThreadFocus=i;b.handleActionsFocus=j;b.handleNewMessageNoticeClick=k;b.handleFocus=l;b.handleBlur=m;b.handleFocusSearchBar=n;b.setSearchInputNode=o;b.handleChange=p;b.handleScrollIntoView=q;b.handleFilteredRequestsClick=ha;b.handleReturnToInboxClick=ia;b.impressionOffset=qa;b.logNodeImpressions=r;b.checkAndUpdateMessageRequestImpressions=s;b.renderAggregatedRequests=ja;b.setter=ka;b.renderThread=la;b.setScrollable=ma;b.handleSelect=na;b.component=t;b.make=oa;b.jsComponent=pa}),null);