if (self.CavalryLogger) { CavalryLogger.start_js(["hpKv3"]); }

__d("MessengerComposer.react",["cx","cssVar","fbt","invariant","AsyncRequest","AutoFocusableLink.react","BootloadedComponent.react","MercuryBootloadOnInteraction.react","BootloadOnRender.react","Bootloader","ChatPhotoUploader.react","CurrentUser","EmoticonsList","immutable","JSResource","LazyComponent.react","MercuryConfig","MercuryIDs","MercuryReadOnlyReason","MercuryParticipants","MercuryThreadActions","MessageRequestUtils","MessagingTag","MessengerStateStore","MessengerActions","MessengerBotMenuDataFetcher","messengerBlockDialogReact","messengerConfirmBlockThreadDialogReact","messengerButtonReact","MessengerComposerInput.react","MessengerConstants","MessengerContextualDialog.react","messengerDialogsRe","MessengerMessageRequestsTypedLogger","messengerFileSizeErrorDialogReact","MessengerHotLikeButton.react","MessengerHotLikeUtils","MessengerQuickCamOrigins","MessengerResponsiveBlock.react","messengerSendButtonReact","MessengerView","MNCommerceCallToActionType","MNCommercePageSetting","MNCommercePostbackCTADataManager","MNCommercePostbackRefSendManager","P2PGKValues","React","MercuryShareAttachmentRenderLocations","WorkQEWorkChatFileAttachmentIcon","XMessagingUnblockMessagesController","XMNCommercePageNullStateCTAController","XUISpinner.react","getPageIDFromThreadID","gkx","isWebGLEnabled","idx"],(function a(b,c,d,e,f,g,h,i,j,k){"use strict";__p&&__p();var l,m,n=c("messengerBlockDialogReact").jsComponent,o=c("messengerConfirmBlockThreadDialogReact").jsComponent,p=c("messengerButtonReact").jsComponent,q=c("messengerFileSizeErrorDialogReact").jsComponent,r=c("messengerSendButtonReact").jsComponent,s=c("React").PropTypes,t=640,u=360,v=navigator.mediaDevices&&navigator.mediaDevices.getUserMedia||navigator.getUserMedia||navigator.webkitGetUserMedia||navigator.mozGetUserMedia||navigator.msGetUserMedia;l=babelHelpers.inherits(w,c("React").PureComponent);m=l&&l.prototype;function w(x){__p&&__p();m.constructor.call(this,x);this.handleFileUpload=function(y){this.refsUploader&&this.refsUploader.uploadFiles(y);this.exitCurrentMode()}.bind(this);this.$MessengerComposer30=function(y){var z=c("EmoticonsList").symbols[y];if(!z)return;this.refsInput&&this.refsInput.insertEmoticon(z)}.bind(this);this.focusInput=function(){this.refsInput&&this.refsInput.focus()}.bind(this);this.$MessengerComposer46=function(){var y=c("XMessagingUnblockMessagesController").getURIBuilder().getURI(),z=this.props.threadID;new(c("AsyncRequest"))(y).setMethod("POST").setData({fbid:c("MercuryIDs").getUserIDFromThreadID(z)}).send()}.bind(this);this.$MessengerComposer44=function(){__p&&__p();var y=this.props.thread,z=!!y&&c("MessageRequestUtils").isFiltered(y),A=c("MessengerStateStore").getState().threadIDs;if(A){var B=A.filter(function(E){return this.props.threadID!==E}.bind(this));c("MessengerActions").selectAggregation(B)}var C=c("CurrentUser").getID(),D=c("MercuryIDs").getThreadKeyfromThreadIDUserID(this.props.threadID,C);this.$MessengerComposer42()["delete"](this.props.threadID);c("MessengerActions").selectThread(null);new(c("MessengerMessageRequestsTypedLogger"))().setAction("message_requests_delete_request").setThreadID(c("MercuryIDs").getThreadFBIDFromThreadID(this.props.threadID)).setSurface("thread").setFolderType(z?"other":"pending").setThreadKey(D).setEntryPoint("inbox_banner").log()}.bind(this);this.$MessengerComposer48=function(){if(c("MercuryConfig").WMBF)this.$MessengerComposer43();else{this.$MessengerComposer42().archive(this.props.threadID);c("MessengerActions").selectThread(null)}}.bind(this);this.$MessengerComposer43=function(){__p&&__p();var y,z,A=this,B=(y=this.props)!=null?(y=y.thread)!=null?y.thread_id:y:y,C=c("MercuryIDs").isGroupChat(B);if(C)this.$MessengerComposer49();else{var D;(function(){var E=(D=A.props)!=null?(D=D.thread)!=null?D.other_user_fbid:D:D,F=E?c("MercuryParticipants").getNow(c("MercuryIDs").getParticipantIDFromUserID(E)):null,G=F&&F.short_name;if(G)c("messengerDialogsRe").showDialog(function(){return c("React").createElement(n,{onBlock:function(){this.$MessengerComposer50(G)}.bind(this),contact:F,onToggle:this.$MessengerComposer51})}.bind(A))})()}}.bind(this);this.$MessengerComposer45=function(y){var z=this.props.thread,A=c("CurrentUser").getID(),B=c("MercuryIDs").getThreadKeyfromThreadIDUserID(this.props.threadID,A),C=!!z&&c("MessageRequestUtils").isFiltered(z);if(!y)new(c("MessengerMessageRequestsTypedLogger"))().setAction("message_requests_decline_cancel").setThreadID(c("MercuryIDs").getThreadFBIDFromThreadID(this.props.threadID)).setSurface("thread").setFolderType(C?c("MessagingTag").OTHER:c("MessagingTag").PENDING).setThreadKey(B).setEntryPoint("inbox_banner").log()}.bind(this);this.$MessengerComposer40=function(y,z){if(y.platformFBID.toString()===c("MercuryConfig").MessengerAppID)this.props.onStickerSelect(y.resultID.toString());else this.refsGifUploader&&this.refsGifUploader.uploadURL({attribution_app_id:y.platformFBID,external_image_url:y.source.url,preview_url:y.media.preview?y.media.preview.url:y.media.thumbnail.url,source:y.source})}.bind(this);this.$MessengerComposer41=function(y){this.focusInput();this.refsInput&&this.refsInput.insertEmoji(y)}.bind(this);this.$MessengerComposer14=function(y){this.setState({currentValue:y})}.bind(this);this.$MessengerComposer13=function(y,z,A){this.refsEmojiButton&&this.refsEmojiButton.hideFlyout();return this.props.onMessageSend&&this.props.onMessageSend(y,z,A)}.bind(this);this.$MessengerComposer39=function(y){this.refsInput&&this.refsInput.triggerSend()}.bind(this);this.$MessengerComposer10=function(){__p&&__p();if(this.state.nullStateCTA!==null)switch(this.state.nullStateCTA.action_type){case c("MNCommerceCallToActionType").OPEN_NATIVE:break;case c("MNCommerceCallToActionType").POSTBACK:default:this.setState({disableNullState:true});if(c("MNCommercePostbackRefSendManager").hasMDotMeRef(this.$MessengerComposer4())){c("MNCommercePostbackCTADataManager").sendAndConfirm(this.state.nullStateCTA.id,this.state.nullStateCTA.title,this.props.threadID,null,this.$MessengerComposer1,c("MNCommercePostbackRefSendManager").getMdotMeRef());c("MessengerActions").changeMDotMeReferral()}else c("MNCommercePostbackCTADataManager").sendAndConfirm(this.state.nullStateCTA.id,this.state.nullStateCTA.title,this.props.threadID,null,this.$MessengerComposer1);break}}.bind(this);this.$MessengerComposer1=function(){this.setState({showNullState:true,disableNullState:false})}.bind(this);this.$MessengerComposer1=this.$MessengerComposer1.bind(this);this.state=this.$MessengerComposer2()}w.prototype.componentWillReceiveProps=function(x){if(x.threadID!==this.props.threadID){this.setState(this.$MessengerComposer2());if(x.thread)this.$MessengerComposer3(x.thread.message_count,c("getPageIDFromThreadID")(x.threadID))}if(x.thread&&x.thread.message_count>0)this.setState({showNullState:false})};w.prototype.componentWillMount=function(){if(this.props.thread)this.$MessengerComposer3(this.props.thread.message_count,this.$MessengerComposer4())};w.prototype.componentDidUpdate=function(x){if(x.canReply!==this.props.canReply)this.props.onResize&&this.props.onResize();if(this.props.thread){this.$MessengerComposer5();this.$MessengerComposer6()}};w.prototype.render=function(){__p&&__p();if(!this.props.canReply)return this.$MessengerComposer7();else if(this.props.thread&&c("MessageRequestUtils").isMessageRequest(this.props.thread)&&!this.state.pendingActionsBypassed)return this.$MessengerComposer8();var x=this.props.thread&&this.props.thread.message_count;c("MNCommercePostbackRefSendManager").sendMDotMeRef(this.$MessengerComposer4(),x);if(this.state.showNullState&&this.state.nullStateCTA!==null)return c("React").createElement("div",{className:"_2xh0"},this.$MessengerComposer9(),c("React").createElement("div",{className:"_2xh4 _59w_"},c("React").createElement(c("BootloadOnRender.react"),{component:c("React").createElement(c("LazyComponent.react"),{cta:this.state.nullStateCTA,onClick:this.$MessengerComposer10,disabled:this.state.disableNullState,threadID:this.props.threadID}),loader:c("JSResource")("ChatPageComposerNullState.react").__setRef("MessengerComposer.react"),placeholder:c("React").createElement(c("XUISpinner.react"),{size:"small"})})));var y=this.$MessengerComposer11();return c("React").createElement(c("MessengerResponsiveBlock.react"),{breakpointsToggles:function z(A){return[A!=null&&A<=t,A]}},function(z){var A=z[0],B=z[1];return c("React").createElement("div",{"aria-label":j._("New message"),className:"_4rv3",role:"region"},c("gkx")("AT5V6GuV7OE1f4CNmq1NUhZOeDrgnZF-AQ7WoOvZA8jFMJsYzyghwU79Bm31vgH-mi9DAlUGSFnfYvhwjhMfTolYEEzHhgUrhLD2UxTqbooHHw")&&this.$MessengerComposer12(this.props.threadID),c("React").createElement("div",{className:"_5irm"+(A?" _1_73":"")},c("React").createElement(c("MessengerComposerInput.react"),{disableAutofocus:!!this.props.disableAutofocus,fileUploader:this.props.fileUploader,handleOnlyImageUploads:false,isComposing:y,mentionsEnabled:this.props.mentionsEnabled,ref:function(C){return this.refsInput=C}.bind(this),onBeforeInput:function(){return this.refsEmojiButton&&this.refsEmojiButton.hideFlyout()}.bind(this),onResize:this.props.onResize,onMessageSend:this.$MessengerComposer13,participants:this.props.participants,sharePreview:this.props.sharePreview,smallerEqual640:A,thread:this.props.thread,threadID:y?c("MessengerConstants").NEW_THREAD_KEY:this.props.threadID,pageID:this.$MessengerComposer4(),viewer:this.props.viewer,onFileUpload:this.handleFileUpload,onChange:this.$MessengerComposer14,showMenu:this.state.showMenu,disableInput:this.state.disableInput}),this.$MessengerComposer15(B)))}.bind(this))};w.prototype.$MessengerComposer12=function(x){__p&&__p();if(!x)return null;var y=this.props.fileUploader;if(!y)return null;var z=y.get("uploadedFiles");if(z.size==0)return null;var A=this.props.thread,B=A&&A.custom_color?A.custom_color:"#0084ff";return c("React").createElement(c("BootloadOnRender.react"),{component:c("React").createElement(c("LazyComponent.react"),{files:z,small:false,threadID:x,threadCustomColor:B,onClick:this.$MessengerComposer16,onResize:this.props.onResize}),loader:c("JSResource")("MercuryStageFilePreviewReactComponent").__setRef("MessengerComposer.react"),placeholder:c("React").createElement(c("XUISpinner.react"),{className:"_2qf"})})};w.prototype.$MessengerComposer16=function(x,y){c("MessengerActions").cancelFileUpload(x,y)};w.prototype.$MessengerComposer15=function(x){return this.state.disableInput===true?null:c("React").createElement("div",{ref:function(y){this.refsButtonsContainer=y}.bind(this),className:"_4rv4"},this.$MessengerComposer17(x),this.$MessengerComposer18())};w.prototype.$MessengerComposer17=function(x){if(this.props.hideActions)return null;if(x&&x<u)return c("React").createElement("div",null,c("React").createElement("ul",{className:"_39bj"},this.$MessengerComposer19(),this.$MessengerComposer20(),this.$MessengerComposer21(),this.$MessengerComposer22()),c("React").createElement("ul",{className:"_39bj"},this.$MessengerComposer23(),this.$MessengerComposer24(),this.$MessengerComposer25(),this.$MessengerComposer26(),this.$MessengerComposer27()));return c("React").createElement("ul",{className:"_39bj"},c("CurrentUser").isWorkUser()&&c("WorkQEWorkChatFileAttachmentIcon").showIcon?this.$MessengerComposer28():null,this.$MessengerComposer19(),this.$MessengerComposer20(),this.$MessengerComposer21(),this.$MessengerComposer22(),this.$MessengerComposer23(),this.$MessengerComposer24(),this.$MessengerComposer25(),this.$MessengerComposer26(),this.$MessengerComposer27())};w.prototype.$MessengerComposer29=function(x){c("messengerDialogsRe").showDialog(function(){return c("React").createElement(q,{error:x.error})})};w.prototype.handleTextDropped=function(x){this.refsInput&&this.refsInput.handleTextDropped(x)};w.prototype.$MessengerComposer24=function(){return c("React").createElement("li",null,this.$MessengerComposer31())};w.prototype.$MessengerComposer31=function(){if(!c("P2PGKValues").P2PVisible||!this.props.threadID||this.$MessengerComposer32()||!this.props.p2pPaymentConfig)return null;var x="_30yy _25pc _39bk";return c("React").createElement(c("BootloadOnRender.react"),{component:c("React").createElement(c("LazyComponent.react"),{className:x,ContextualDialog:c("MessengerContextualDialog.react"),threadID:this.props.threadID,p2pPaymentConfig:this.props.p2pPaymentConfig}),loader:c("JSResource")("P2PSendMoneyContainerBootloader.react").__setRef("MessengerComposer.react"),placeholder:c("React").createElement(c("AutoFocusableLink.react"),{className:x,role:"button"})})};w.prototype.$MessengerComposer27=function(){if(c("gkx")("AT7NMH8Fy3EgTAU92jLm_-e65sqgQK-sAjecOeMqKm7I8DjgqesO35iaJSaySvKNghUUIX8H61oA8oRMnPMYOfvy")&&c("gkx")("AT44XpsdaaEfcz2GrZ0m8RNEjrTHpQedGRhxmeB3oGdMvETdQ7vdyzqg8MlOqQGInNDXydDTyvvVR5lvi3VlBp7t")&&this.props.threadID)return c("React").createElement(c("MercuryBootloadOnInteraction.react"),{component:c("React").createElement(c("LazyComponent.react"),{className:"_4rv5 _39bk"+(this.state.flyoutOpen?" _5jhb":""),location:c("MessengerQuickCamOrigins").MESSENGER,threadID:this.props.threadID,viewer:this.props.viewer}),loader:c("JSResource")("MessengerQuickCamButtonHTML5.react").__setRef("MessengerComposer.react"),placeholder:c("React").createElement(c("AutoFocusableLink.react"),{className:"_4rv5 _39bk",role:"button"})});return null};w.prototype.$MessengerComposer23=function(){if(!v)return null;return c("React").createElement("li",null,c("React").createElement(c("MercuryBootloadOnInteraction.react"),{component:c("React").createElement(c("LazyComponent.react"),{onVoiceClipCreate:this.props.onVoiceClipCreate}),loader:c("JSResource")("MessengerVoiceClipButton.react").__setRef("MessengerComposer.react"),placeholder:c("React").createElement(c("AutoFocusableLink.react"),{className:"_4rv7 _39bk _30yy",role:"button"})}))};w.prototype.$MessengerComposer25=function(){if(this.props.thread&&this.props.thread.is_canonical)return null;if(!this.props.threadFBID)return null;return c("React").createElement("li",null,c("React").createElement(c("MercuryBootloadOnInteraction.react"),{component:c("React").createElement(c("LazyComponent.react"),{customColor:this.props.thread&&this.props.thread.custom_color,threadFBID:this.props.threadFBID}),loader:c("JSResource")("MessengerGroupPollingButton.react").__setRef("MessengerComposer.react"),placeholder:c("React").createElement(c("AutoFocusableLink.react"),{className:"_39bk _30yy _2o-b",role:"button"})}))};w.prototype.$MessengerComposer26=function(){var x=c("gkx")("AT4VU3LTU_m0y3MeJeai7hJytsOcRy63JbTrv7QtkGDcMH9aN_sV8sDNC1ebrhVq0RfT0H4FEgW5UVoJHsOiHpnF")&&c("isWebGLEnabled")();return x&&this.props.threadFBID&&!this.$MessengerComposer32()?c("React").createElement("li",null,c("React").createElement(c("MercuryBootloadOnInteraction.react"),{component:c("React").createElement(c("LazyComponent.react"),{customColor:this.props.thread&&this.props.thread.custom_color,threadFBID:this.props.threadFBID}),loader:c("JSResource")("MessengerGamesButton.react").__setRef("MessengerComposer.react"),placeholder:c("React").createElement(c("AutoFocusableLink.react"),{className:"_39bk _30yy _4ce_",role:"button"})})):null};w.prototype.$MessengerComposer33=function(x){return c("React").createElement("li",{className:"_39bk"},c("React").createElement(c("ChatPhotoUploader.react"),{allowCrossPage:true,disabled:!(this.props.threadID||this.$MessengerComposer34()),ref:function(y){return this.refsUploader=y}.bind(this),imageClassName:(x=="files"?"_5vn8":"")+(x=="attachment"?" _46si":""),imagesOnly:false,inputClassname:"_260t",linkClassName:"_30yy _260u",focusInput:this.focusInput,onAllUploadsComplete:this.props.onPhotoUploadComplete,onLastUploadFail:this.props.onPhotoUploadFail,onLastUploadCancel:this.props.onPhotoUploadCancel,onSubmit:this.props.onPhotoUploadSubmit,onUploadError:this.$MessengerComposer29,threadID:this.props.threadID}))};w.prototype.$MessengerComposer19=function(){return this.$MessengerComposer33("files")};w.prototype.$MessengerComposer28=function(){return this.$MessengerComposer33("attachment")};w.prototype.$MessengerComposer35=function(){return this.state.currentValue.length>0||this.$MessengerComposer36()||this.$MessengerComposer37()};w.prototype.$MessengerComposer36=function(){var x=this.props.fileUploader;return Boolean(x&&x.get("uploadedFiles").size>0)};w.prototype.$MessengerComposer37=function(){var x=this.props.sharePreview;return!!(x&&x.params&&x.type)};w.prototype.$MessengerComposer38=function(){var x=this.props.fileUploader;return Boolean(x&&x.get("uploadingFiles").size>0)};w.prototype.$MessengerComposer18=function(){var x=!(this.props.threadID||this.$MessengerComposer34());if(!x&&this.$MessengerComposer35()&&!this.$MessengerComposer38())return c("React").createElement(r,{className:(this.props.threadID?"_30yy":"")+" _38lh _39bl",customColor:this.props.thread&&this.props.thread.custom_color,onClick:this.$MessengerComposer39});return c("React").createElement(c("MessengerHotLikeButton.react"),{className:"_4rv9"+(this.props.threadID?" _30yy":"")+" _39bl",disabled:x,customColor:this.props.thread&&this.props.thread.custom_color,customLike:c("MessengerHotLikeUtils").getCustomEmojiFromThread(this.props.thread)||undefined,sendSticker:this.props.onStickerSelect,sendCustomLike:this.props.onCustomLikeSelect,threadID:this.props.threadID,renderSize:24})};w.prototype.$MessengerComposer20=function(){var x=(this.props.threadID?"_30yy":"")+" _4rv6 _39bk";return c("React").createElement("li",null,c("React").createElement(c("MercuryBootloadOnInteraction.react"),{component:c("React").createElement(c("LazyComponent.react"),{className:x,ContextualDialogClass:c("MessengerContextualDialog.react"),disabled:!(this.props.threadID||this.$MessengerComposer34()),getInput:function(){return this.refsInput}.bind(this),flyoutAlignment:"right",flyoutClassName:"_293j",flyoutWidth:285,onStickerSelect:this.props.onStickerSelect,onEmoticonSelect:this.$MessengerComposer30,threadID:this.props.threadID}),loader:c("JSResource")("ChatStickerButton.react").__setRef("MessengerComposer.react"),placeholder:c("React").createElement(c("AutoFocusableLink.react"),{className:x,role:"button"})}))};w.prototype.$MessengerComposer9=function(){__p&&__p();var x,y=(x=this.props)!=null?(x=x.thread)!=null?x.other_user_fbid:x:x,z=y?c("MercuryParticipants").getNow(c("MercuryIDs").getParticipantIDFromUserID(y)):null,A=z&&z.name||"page";if(this.state.nullStateCTA!==null)switch(this.state.nullStateCTA.action_type){case c("MNCommerceCallToActionType").OPEN_NATIVE:return null;case c("MNCommerceCallToActionType").POSTBACK:if(!c("MNCommercePostbackRefSendManager").hasMDotMeRef(this.$MessengerComposer4())&&!this.state.nullStateCTA.instantgame_metadata)return c("React").createElement("div",{className:"_3zc8"},j._("When you tap {cta title}, {name} will see your public info.",[j.param("cta title",this.state.nullStateCTA.title),j.param("name",A)]));else if(c("MNCommercePostbackRefSendManager").hasMDotMeRef(this.$MessengerComposer4())){var B=this.$MessengerComposer4(),C=z&&z.vanity?"m.me/"+z.vanity:B?"m.me/"+B:"m.me";return c("React").createElement("div",{className:"_3zc8"},j._("When you tap {cta title}, {name} will see your public info and that you opened their {link} link.",[j.param("cta title",this.state.nullStateCTA.title),j.param("name",A),j.param("link",C)]))}break;default:return null}return null};w.prototype.$MessengerComposer21=function(){var x=(this.props.threadID?"_30yy":"")+" _yht _39bk";return c("React").createElement("li",null,c("React").createElement("div",{style:{display:"none"}},c("React").createElement(c("ChatPhotoUploader.react"),{allowCrossPage:true,disabled:false,ref:function(y){return this.refsGifUploader=y}.bind(this),imagesOnly:false,focusInput:this.focusInput,onAllUploadsComplete:this.props.onPhotoUploadComplete,onLastUploadFail:this.props.onPhotoUploadFail,onLastUploadCancel:this.props.onPhotoUploadCancel,onSubmit:this.props.onPhotoUploadSubmit,onUploadError:this.$MessengerComposer29})),c("React").createElement(c("MercuryBootloadOnInteraction.react"),{component:c("React").createElement(c("LazyComponent.react"),{className:x,ContextualDialogClass:c("MessengerContextualDialog.react"),getInput:function(){return this.refsInput}.bind(this),getQuery:function(){return this.refsInput?this.refsInput.getValue():""}.bind(this),location:c("MercuryShareAttachmentRenderLocations").MESSENGER,onSelect:this.$MessengerComposer40}),loader:c("JSResource")("ChatContentSearchButton.react").__setRef("MessengerComposer.react"),placeholder:c("React").createElement(c("AutoFocusableLink.react"),{className:x,role:"button"})}))};w.prototype.$MessengerComposer22=function(){var x=(this.props.threadID?"_30yy":"")+" _5s2p _39bk";return c("React").createElement("li",null,c("React").createElement(c("MercuryBootloadOnInteraction.react"),{component:c("React").createElement(c("LazyComponent.react"),{className:x,ContextualDialogClass:c("MessengerContextualDialog.react"),flyoutAlignment:"right",getInput:function(){return this.refsInput}.bind(this),onSelect:this.$MessengerComposer41,onMount:function(y){return this.refsEmojiButton=y}.bind(this),sendCustomEmoji:this.props.onCustomLikeSelect,threadID:this.props.threadID}),loader:c("JSResource")("ChatEmojiButton.react").__setRef("MessengerComposer.react"),placeholder:c("React").createElement(c("AutoFocusableLink.react"),{className:x,role:"button"})}))};w.prototype.$MessengerComposer8=function(){__p&&__p();var x=this.props.thread,y=!!x&&c("MessageRequestUtils").isFiltered(x),z=c("CurrentUser").getID(),A=c("MercuryIDs").getThreadKeyfromThreadIDUserID(this.props.threadID,z);return c("React").createElement(c("BootloadedComponent.react"),{bootloadPlaceholder:c("React").createElement("div",{style:{height:51}}),bootloadLoader:c("JSResource")("MessengerPendingActions.react").__setRef("MessengerComposer.react"),folder:this.props.thread&&this.props.thread.folder,onAcceptClick:function(){this.$MessengerComposer42().changeFolder(this.props.threadID,c("MessagingTag").INBOX);var B=c("MessengerStateStore").getState().threadIDs;if(B){var C=B.filter(function(D){return this.props.threadID!==D}.bind(this));c("MessengerActions").selectAggregation(C)}this.setState({pendingActionsBypassed:true},function(){return new(c("MessengerMessageRequestsTypedLogger"))().setAction("message_requests_accept_request").setThreadID(c("MercuryIDs").getThreadFBIDFromThreadID(this.props.threadID)).setSurface("thread").setFolderType(y?"other":"pending").setThreadKey(A).setEntryPoint(null).log()}.bind(this))}.bind(this),onDeclineClick:function(){var B=c("MercuryIDs").isGroupChat(this.props.threadID);c("Bootloader").loadModules(["messengerDeclineDialogReact"],function(C){var D=C.jsComponent;c("messengerDialogsRe").showDialog(function(){return c("React").createElement(D,{onBlock:this.$MessengerComposer43,onDelete:this.$MessengerComposer44,onToggle:this.$MessengerComposer45,isGroupChat:B})}.bind(this));new(c("MessengerMessageRequestsTypedLogger"))().setAction("message_requests_decline_attempt").setThreadID(c("MercuryIDs").getThreadFBIDFromThreadID(this.props.threadID)).setSurface("thread").setFolderType("pending").setThreadKey(A).setEntryPoint("inbox_banner").log()}.bind(this),"MessengerComposer.react")}.bind(this),onDeleteClick:function(){c("Bootloader").loadModules(["messengerFilteredDeleteDialogReact"],function(B){var C=B.jsComponent;c("messengerDialogsRe").showDialog(function(){return c("React").createElement(C,{onDelete:this.$MessengerComposer44,onToggle:this.$MessengerComposer45})}.bind(this))}.bind(this),"MessengerComposer.react");new(c("MessengerMessageRequestsTypedLogger"))().setAction("message_requests_decline_attempt").setThreadID(c("MercuryIDs").getThreadFBIDFromThreadID(this.props.threadID)).setSurface("thread").setFolderType("other").setThreadKey(A).setEntryPoint("inbox_banner").log()}.bind(this)})};w.prototype.$MessengerComposer7=function(){__p&&__p();if(!this.props.thread||this.props.view===c("MessengerView").DETAIL.COMPOSE)return null;var x=this.props.thread,y=this.props.participants,z=false,A=false;if(x.cannot_reply_reason==="blocked"){z=true;x.is_canonical===true||k(0);y!=null||k(0);var B=x.other_user_fbid;B!=null||k(0);var C=y.get(c("MercuryIDs").getParticipantIDFromUserID(B));C!=null||k(0);if(C.is_messenger_blocked)A=true}if(z)if(A)return c("React").createElement("div",{className:"_4rv3"},c("React").createElement("div",{className:"_2wy4"},j._("You've blocked messages from this person. {unblock_now_button}",[j.param("unblock_now_button",c("React").createElement(p,{label:j._("Unblock Now"),onClick:this.$MessengerComposer46,type:"secondary"}))])));else return c("React").createElement("div",{className:"_4rv3"},c("React").createElement("div",{className:"_2wy4"},j._("This person isn't available right now.")));return c("React").createElement("div",{className:"_4rv3"},c("React").createElement("div",{className:"_2wy4"},c("MercuryReadOnlyReason").getReason(x.has_email_participant)))};w.prototype.$MessengerComposer47=function(){return c("MercuryThreadActions").getForFBID(this.props.viewer)};w.prototype.$MessengerComposer49=function(){var x,y=(x=this.props)!=null?(x=x.thread)!=null?x.thread_id:x:x;if(y){var z=c("MessengerStateStore").getState().activeThreadID===y;this.$MessengerComposer47().changeFolder(y,"other");z&&c("MessengerActions").selectThread(null)}};w.prototype.$MessengerComposer51=function(){c("messengerDialogsRe").removeDialog()};w.prototype.$MessengerComposer50=function(x){var y=this.props.threadID,z=y===c("MessengerStateStore").getState().activeThreadID;this.$MessengerComposer47().blockIgnoreOnMessengerDotCom(z,y,function(){this.$MessengerComposer52(x)}.bind(this))};w.prototype.$MessengerComposer52=function(x){var y=this.props,z=y.threadID,A=y.thread;c("messengerDialogsRe").showDialog(function(){return c("React").createElement(o,{participantName:x})});var B=c("CurrentUser").getID(),C=c("MercuryIDs").getThreadKeyfromThreadIDUserID(z,B),D=!!A&&c("MessageRequestUtils").isFiltered(A);new(c("MessengerMessageRequestsTypedLogger"))().setAction("message_requests_block_request").setThreadID(c("MercuryIDs").getThreadFBIDFromThreadID(z)).setSurface("thread").setFolderType(D?c("MessagingTag").OTHER:c("MessagingTag").PENDING).setThreadKey(C).setEntryPoint(null).log()};w.prototype.exitCurrentMode=function(){this.refsInput&&this.refsInput.exitCurrentMode()};w.prototype.$MessengerComposer11=function(){return this.props.view===c("MessengerView").DETAIL.COMPOSE};w.prototype.$MessengerComposer34=function(){return!!(this.$MessengerComposer11()&&this.props.recipients&&this.props.recipients.size)};w.prototype.$MessengerComposer32=function(){return!!this.$MessengerComposer4()};w.prototype.$MessengerComposer4=function(){return c("getPageIDFromThreadID")(this.props.threadID)};w.prototype.$MessengerComposer5=function(){var x=this.$MessengerComposer4();if(x)c("MessengerBotMenuDataFetcher").getHasPageSetting(x,function(y){this.setState({showMenu:y})}.bind(this),function(){this.setState({showMenu:false})}.bind(this),c("MNCommercePageSetting").STRUCTURED_MENU_ENABLED);else this.setState({showMenu:false})};w.prototype.$MessengerComposer6=function(){var x=this.$MessengerComposer4();if(x)c("MessengerBotMenuDataFetcher").getHasPageSetting(x,function(y){this.setState({disableInput:y})}.bind(this),function(){this.setState({disableInput:false})}.bind(this),c("MNCommercePageSetting").COMPOSER_INPUT_DISABLED);else this.setState({disableInput:false})};w.prototype.$MessengerComposer3=function(x,y){var z=x===0,A=!!y;if(A&&z){var B=c("XMNCommercePageNullStateCTAController").getURIBuilder();new(c("AsyncRequest"))().setURI(B.getURI()).setMethod("POST").setData({page_id:y}).setHandler(function(C){if(C&&C.payload)this.setState({showNullState:true,nullStateCTA:C.payload});else this.setState({showNullState:false,disableNullState:false})}.bind(this)).send()}else this.setState({showNullState:false,disableNullState:false})};w.prototype.$MessengerComposer2=function(){return{pendingActionsBypassed:false,currentValue:"",nullStateCTA:null,showMenu:false,disableInput:false,showNullState:false,disableNullState:false}};w.prototype.$MessengerComposer42=function(){return c("MercuryThreadActions").getForFBID(this.props.viewer)};w.prototype.testUtils_renderRawP2PSendMoneyButton=function(){return this.$MessengerComposer31()};w.prototype.replyToMention=function(x){this.refsInput&&this.refsInput.addMention&&this.refsInput.addMention(x)};w.propTypes={canReply:s.bool,disableAutofocus:s.bool,fileUploader:s.object,hideActions:s.bool,mentionsEnabled:s.bool,onCustomLikeSelect:s.func,onMessageSend:s.func,onPhotoUploadComplete:s.func,onPhotoUploadCancel:s.func,onPhotoUploadFail:s.func,onPhotoUploadSubmit:s.func,onResize:s.func,onStickerSelect:s.func.isRequired,onVoiceClipCreate:s.func,p2pPaymentConfig:s.object,participants:s.instanceOf(c("immutable").Map),recipients:s.instanceOf(c("immutable").List),sharePreview:s.object,threadID:s.string,threadFBID:s.string,thread:s.object,view:s.string,viewer:s.string};f.exports=w}),null);