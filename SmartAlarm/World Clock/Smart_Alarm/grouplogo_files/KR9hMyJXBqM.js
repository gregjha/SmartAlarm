if (self.CavalryLogger) { CavalryLogger.start_js(["ydZYK"]); }

__d("MessengerAddIconSVG.react",["React"],(function a(b,c,d,e,f,g){"use strict";var h=c("React").PropTypes,i=function i(j){return c("React").createElement("div",{className:j.className},c("React").createElement("svg",{viewBox:"-8 -8 48 48"},c("React").createElement("title",null,"add to group"),c("React").createElement("path",{d:"M16,0 V32 M0,16 H32",fillRule:"evenodd",clipRule:"evenodd",fill:"none",stroke:j.customColor,strokeWidth:2,strokeMiterlimit:10,strokeLinecap:"round"})))};i.propTypes={className:h.string,customColor:h.string.isRequired};f.exports=i}),null);
__d("MessengerAbstractTextInputWithFocus.react",["AbstractTextInput.react","React"],(function a(b,c,d,e,f,g){"use strict";__p&&__p();var h,i,j=c("React").PropTypes;h=babelHelpers.inherits(k,c("React").Component);i=h&&h.prototype;k.prototype.componentDidMount=function(){if(Object.prototype.hasOwnProperty.call(this.refs,"input"))if(this.props.focused)this.refs.input.focusInput();else this.refs.input.blurInput()};k.prototype.componentDidUpdate=function(){if(Object.prototype.hasOwnProperty.call(this.refs,"input"))if(this.props.focused)this.refs.input.focusInput();else this.refs.input.blurInput()};k.prototype.render=function(){return c("React").createElement(c("AbstractTextInput.react"),{className:this.props.className,onChange:this.props.onChange,onFocus:this.props.onFocus,onKeyDown:this.props.onKeyDown,placeholder:this.props.placeholder,ref:"input",value:this.props.value})};function k(){h.apply(this,arguments)}k.propTypes={className:j.string,focused:j.bool.isRequired,onChange:j.func.isRequired,onFocus:j.func.isRequired,onKeyDown:j.func.isRequired,placeholder:j.string.isRequired,value:j.string};f.exports=k}),null);
__d("MessengerGroupPollingCheckbox.react",["cssVar","cx","Keys","React"],(function a(b,c,d,e,f,g,h,i){"use strict";__p&&__p();var j,k,l=c("React").PropTypes;j=babelHelpers.inherits(m,c("React").Component);k=j&&j.prototype;function m(){__p&&__p();var n,o;for(var p=arguments.length,q=Array(p),r=0;r<p;r++)q[r]=arguments[r];return o=(n=k.constructor).call.apply(n,[this].concat(q)),this.$MessengerGroupPollingCheckbox1=function(){this.props.onToggle(!this.props.checked)}.bind(this),this.$MessengerGroupPollingCheckbox2=function(event){switch(event.keyCode){case c("Keys").SPACE:event.preventDefault();this.$MessengerGroupPollingCheckbox1();break;default:break}}.bind(this),o}m.prototype.render=function(){var n=this.props.checked?this.props.customColor:"rgba(0, 0, 0, 0.10)",o="_2m5p"+(this.props.checked?" _2m5q":"");return c("React").createElement("div",{"aria-checked":this.props.checked?"true":"false",className:o,onClick:this.$MessengerGroupPollingCheckbox1,onKeyDown:this.$MessengerGroupPollingCheckbox2,role:"checkbox",tabIndex:"0"},c("React").createElement("span",{className:"_2m5r",style:{backgroundColor:this.props.customColor,borderColor:n}}))};m.propTypes={checked:l.bool.isRequired,customColor:l.string.isRequired,onToggle:l.func.isRequired};f.exports=m}),null);
__d("XMessengerGroupPollingCreatePollController",["XController"],(function a(b,c,d,e,f,g){f.exports=c("XController").create("/messaging/group_polling/create_poll/",{})}),null);
__d("MessengerGroupPollingCreatePollFlyout.react",["cx","fbt","AsyncRequest","Keys","Link.react","MessengerAbstractTextInputWithFocus.react","MessengerAddIconSVG.react","MessengerGroupPollingCheckbox.react","MessengerSpinner.react","React","ScrollableArea.react","XMessengerGroupPollingCreatePollController","XUICloseButton.react"],(function a(b,c,d,e,f,g,h,i){"use strict";__p&&__p();var j,k,l=c("React").PropTypes,m=30,n=75,o=200;j=babelHelpers.inherits(p,c("React").Component);k=j&&j.prototype;function p(){__p&&__p();var q,r;for(var s=arguments.length,t=Array(s),u=0;u<s;u++)t[u]=arguments[u];return r=(q=k.constructor).call.apply(q,[this].concat(t)),this.state={focusIndicator:{isQuestionFocused:true,optionFocusIndex:0},questionText:null,options:[{optionText:null,isSelected:false}],errorTitle:null,errorMessage:null,isLoading:false},this.$MessengerGroupPollingCreatePollFlyout6=function(){var v={optionText:null,isSelected:false},w=this.state.options.concat(v);this.setState({focusIndicator:{isQuestionFocused:false,optionFocusIndex:w.length-1},options:w})}.bind(this),this.$MessengerGroupPollingCreatePollFlyout7=function(v){this.setState({focusIndicator:{isQuestionFocused:true,optionFocusIndex:0},questionText:v.target.value,errorTitle:null,errorMessage:null})}.bind(this),this.$MessengerGroupPollingCreatePollFlyout9=function(v){if(v.keyCode===c("Keys").RETURN){v.preventDefault();this.setState({focusIndicator:{isQuestionFocused:false,optionFocusIndex:0}})}}.bind(this),this.$MessengerGroupPollingCreatePollFlyout11=function(v){v.preventDefault();if(v.keyCode===c("Keys").RETURN)this.$MessengerGroupPollingCreatePollFlyout10()}.bind(this),this.$MessengerGroupPollingCreatePollFlyout10=function(){__p&&__p();if(this.state.isLoading)return;this.setState({isLoading:true});var v=this.state.options.filter(function(x){return x.optionText}),w=c("XMessengerGroupPollingCreatePollController").getURIBuilder().getURI();new(c("AsyncRequest"))().setURI(w).setData({question_text:this.state.questionText,target_id:this.props.threadFBID,option_text_array:v.map(function(x){return x.optionText}),option_is_selected_array:v.map(function(x){return x.isSelected?1:0})}).setMethod("POST").setAllowCrossPageTransition(true).setHandler(function(x){var y=x.payload;if(y.status==="failure"&&y.showUser===true)this.setState({errorTitle:y.errorTitle,errorMessage:y.errorMessage,isLoading:false});else this.props.onSubmitHandler()}.bind(this)).send()}.bind(this),r}p.prototype.render=function(){var q=this.state.options.map(function(x,y){return c("React").createElement("div",{className:"_9fu",key:y},c("React").createElement(c("MessengerGroupPollingCheckbox.react"),{checked:x.isSelected,customColor:this.props.customColor,onToggle:function(){return this.$MessengerGroupPollingCreatePollFlyout1(y)}.bind(this)}),c("React").createElement(c("MessengerAbstractTextInputWithFocus.react"),{className:"_9fv",focused:!this.state.focusIndicator.isQuestionFocused&&this.state.focusIndicator.optionFocusIndex===y,onChange:function(z){return this.$MessengerGroupPollingCreatePollFlyout2(z,y)}.bind(this),onFocus:function(z){return this.$MessengerGroupPollingCreatePollFlyout3(y)}.bind(this),onKeyDown:function(z){return this.$MessengerGroupPollingCreatePollFlyout4(z,y)}.bind(this),placeholder:i._("Add an option").toString(),value:x.optionText}),c("React").createElement(c("XUICloseButton.react"),{className:"_4y_1",onClick:function(){return this.$MessengerGroupPollingCreatePollFlyout5(y)}.bind(this),size:"small",tooltip:i._("Remove")}))}.bind(this)),r=c("React").createElement(c("Link.react"),{onClick:this.$MessengerGroupPollingCreatePollFlyout6,role:"button",tabIndex:"0"},c("React").createElement(c("MessengerAddIconSVG.react"),{className:"_5n1-",customColor:this.props.customColor})),s=c("React").createElement("div",{className:"_5jmn"},this.state.errorTitle),t=c("React").createElement("div",{className:"_5jmo"},this.state.errorMessage),u=this.state.options.length+1,v=m*u,w=Math.min(Math.max(v,n),o);return c("React").createElement("div",{className:"_5jmp"},c("React").createElement("div",{className:"_5jn1"},i._("Poll")),s,t,c("React").createElement(c("MessengerAbstractTextInputWithFocus.react"),{className:"_9fw",focused:this.state.focusIndicator.isQuestionFocused,onChange:this.$MessengerGroupPollingCreatePollFlyout7,onFocus:function(x){return this.$MessengerGroupPollingCreatePollFlyout8()}.bind(this),onKeyDown:this.$MessengerGroupPollingCreatePollFlyout9,placeholder:i._("Ask a question").toString(),value:this.state.questionText}),c("React").createElement(c("ScrollableArea.react"),{className:"_5nkw",height:w},c("React").createElement("div",{className:"_5jn3"},q,r)),c("React").createElement("div",{className:"_5jn4"+(this.state.isLoading?" _2zwp":""),onClick:this.$MessengerGroupPollingCreatePollFlyout10,onKeyUp:this.$MessengerGroupPollingCreatePollFlyout11,role:"button",style:{backgroundColor:this.props.customColor},tabIndex:"0"},this.state.isLoading?c("React").createElement(c("MessengerSpinner.react"),null):i._("Create Poll")))};p.prototype.$MessengerGroupPollingCreatePollFlyout1=function(q){var r=this.state.options.map(function(s,t){if(t===q)return babelHelpers["extends"]({},s,{isSelected:!s.isSelected});return s});this.setState({focusIndicator:{isQuestionFocused:false,optionFocusIndex:null},options:r})};p.prototype.$MessengerGroupPollingCreatePollFlyout5=function(q){var r=this.state.options.filter(function(u,v){return v!==q}),s=r.length===0,t=null;if(this.state.focusIndicator.optionFocusIndex!==null&&this.state.focusIndicator.optionFocusIndex!==undefined&&r.length!==0)t=this.state.focusIndicator.optionFocusIndex<q?this.state.focusIndicator.optionFocusIndex:this.state.focusIndicator.optionFocusIndex-1;this.setState({focusIndicator:{isQuestionFocused:s,optionFocusIndex:t},options:r})};p.prototype.$MessengerGroupPollingCreatePollFlyout2=function(q,r){var s=this.state.options.map(function(t,u){if(u===r)return babelHelpers["extends"]({},t,{optionText:q.target.value});return t});this.setState({focusIndicator:{isQuestionFocused:false,optionFocusIndex:r},options:s,errorTitle:null,errorMessage:null})};p.prototype.$MessengerGroupPollingCreatePollFlyout4=function(q,r){if(q.keyCode===c("Keys").RETURN){q.preventDefault();var s=r+1;if(s===this.state.options.length)this.$MessengerGroupPollingCreatePollFlyout6();else this.setState({focusIndicator:{isQuestionFocused:false,optionFocusIndex:s}})}};p.prototype.$MessengerGroupPollingCreatePollFlyout8=function(){this.setState({focusIndicator:{isQuestionFocused:true,optionFocusIndex:0}})};p.prototype.$MessengerGroupPollingCreatePollFlyout3=function(q){this.setState({focusIndicator:{isQuestionFocused:false,optionFocusIndex:q}})};p.propTypes={customColor:l.string.isRequired,threadFBID:l.string.isRequired,onSubmitHandler:l.func.isRequired};f.exports=p}),null);
__d("XMessengerGroupPollingUpdateVoteController",["XController"],(function a(b,c,d,e,f,g){f.exports=c("XController").create("/messaging/group_polling/update_vote/",{})}),null);
__d("MessengerGroupPollingFlyout.react",["cx","fbt","AsyncRequest","Keys","Link.react","MessengerAbstractTextInputWithFocus.react","MessengerAddIconSVG.react","MessengerEnvironment","MessengerGroupPollingCheckbox.react","MessengerGroupPollingUtils","MessengerSpinner.react","React","ScrollableArea.react","XMessengerGroupPollingUpdateVoteController"],(function a(b,c,d,e,f,g,h,i){"use strict";__p&&__p();var j,k,l=c("React").PropTypes,m=16,n=24,o=28,p=36,q=50,r=200;j=babelHelpers.inherits(s,c("React").Component);k=j&&j.prototype;function s(t){__p&&__p();k.constructor.call(this,t);this.$MessengerGroupPollingFlyout3=function(){var v=this.state.newOptions.concat(null);this.setState({focusIndex:v.length-1,newOptions:v})}.bind(this);this.$MessengerGroupPollingFlyout8=function(v){v.preventDefault();if(v.keyCode===c("Keys").RETURN)this.$MessengerGroupPollingFlyout7()}.bind(this);this.$MessengerGroupPollingFlyout7=function(){__p&&__p();if(this.state.isLoading)return;this.setState({isLoading:true});var v=this.state.newOptions.filter(function(x){return x}),w=c("XMessengerGroupPollingUpdateVoteController").getURIBuilder().getURI();new(c("AsyncRequest"))().setURI(w).setData({question_id:this.props.questionID,selected_options:this.state.selectedOptions,new_options:v}).setMethod("POST").setAllowCrossPageTransition(true).setHandler(function(x){var y=x.payload;if(y.status==="failure"&&y.showUser===true)this.setState({errorTitle:y.errorTitle,errorMessage:y.errorMessage,isLoading:false});else this.props.onSubmitHandler()}.bind(this)).send()}.bind(this);var u=this.$MessengerGroupPollingFlyout1(t.options);this.state={focusIndex:0,selectedOptions:u,errorTitle:null,errorMessage:null,newOptions:[null],isLoading:false}}s.prototype.componentWillReceiveProps=function(t){if(this.props.options==null){var u=this.$MessengerGroupPollingFlyout1(t.options);this.setState({selectedOptions:u})}};s.prototype.render=function(){__p&&__p();var t=c("MessengerEnvironment").messengerui;if(!this.props.options)return c("React").createElement("div",{className:"_8bt"+(!t?" _5il4":"")},c("React").createElement(c("MessengerSpinner.react"),{color:"grey"}));var u=t?n:m,v=c("React").createElement("div",{className:"_3lpw"},c("React").createElement("div",{className:"_3lpx"},this.state.errorTitle),c("React").createElement("div",{className:"_3lpy"},this.state.errorMessage)),w=this.props.options&&this.props.options.map(function(C){return c("React").createElement("div",{className:"_1mqz"+(!t?" _5k8c":""),key:C.id},c("React").createElement(c("MessengerGroupPollingCheckbox.react"),{checked:this.state.selectedOptions&&this.state.selectedOptions.indexOf(C.id)!==-1||false,customColor:this.props.customColor,onToggle:function(){return this.$MessengerGroupPollingFlyout2(C.id)}.bind(this)}),c("React").createElement("div",{className:"_2f83"+(!t?" _vhn":"")},c("React").createElement("div",{className:"_1mq-"+(!t?" _2a5a":"")},c("MessengerGroupPollingUtils").renderEmojiText(C.text)),c("MessengerGroupPollingUtils").renderVoterFacepiles("_4ic7"+(!t?" _8kg":""),u,C.voters.count,C.voters.edges.map(function(D){return D.node.id}),C.viewer_has_voted)))}.bind(this)),x=this.state.newOptions.map(function(C,D){return c("React").createElement("div",{className:"_1mqz"+(!t?" _5k8c":""),key:D},c("React").createElement(c("Link.react"),{onClick:this.$MessengerGroupPollingFlyout3,role:"button",tabIndex:"0"},c("React").createElement(c("MessengerAddIconSVG.react"),{className:"_8i7",customColor:this.props.customColor})),c("React").createElement(c("MessengerAbstractTextInputWithFocus.react"),{className:"_8i5",focused:D===this.state.focusIndex,onChange:function(E){return this.$MessengerGroupPollingFlyout4(E,D)}.bind(this),onFocus:function(E){return this.$MessengerGroupPollingFlyout5(D)}.bind(this),onKeyDown:function(E){return this.$MessengerGroupPollingFlyout6(E,D)}.bind(this),placeholder:i._("Add an option").toString(),value:C}))}.bind(this)),y=this.props.options&&this.props.options.length||0,z=y+this.state.newOptions.length,A=t?p*z:o*z,B=Math.min(Math.max(A,q),r);return c("React").createElement("div",{className:"_1mq_"+(!t?" _1mr-":"")},c("React").createElement("div",{className:"_1mr_"},c("MessengerGroupPollingUtils").renderEmojiText(this.props.questionText)),v,c("React").createElement(c("ScrollableArea.react"),{height:B},c("React").createElement("div",{className:"_1ms0"},w,x)),c("React").createElement("div",{className:"_1ms1"+(this.state.isLoading?" _m1v":""),onClick:this.$MessengerGroupPollingFlyout7,onKeyUp:this.$MessengerGroupPollingFlyout8,role:"button",style:{backgroundColor:this.props.customColor},tabIndex:"0"},this.state.isLoading?c("React").createElement(c("MessengerSpinner.react"),null):i._("Submit")))};s.prototype.$MessengerGroupPollingFlyout1=function(t){var u=t&&t.filter(function(v){return v.viewer_has_voted===true}).map(function(v){return v.id});return u};s.prototype.$MessengerGroupPollingFlyout2=function(t){var u=this.state.selectedOptions;if(!u)return;var v=u.indexOf(t)===-1?u.concat(t):u.filter(function(w){return w!==t});this.setState({focusIndex:null,selectedOptions:v})};s.prototype.$MessengerGroupPollingFlyout4=function(t,u){var v=this.state.newOptions.map(function(w,x){return x===u?t.target.value:w});this.setState({focusIndex:u,newOptions:v,errorTitle:null,errorMessage:null})};s.prototype.$MessengerGroupPollingFlyout6=function(t,u){if(t.keyCode===c("Keys").RETURN){t.preventDefault();var v=u+1;if(v===this.state.newOptions.length)this.$MessengerGroupPollingFlyout3();else this.setState({focusIndex:v})}};s.prototype.$MessengerGroupPollingFlyout5=function(t){this.setState({focusIndex:t})};s.propTypes={customColor:l.string.isRequired,questionID:l.string.isRequired,questionText:l.string.isRequired,options:l.arrayOf(l.object),onSubmitHandler:l.func.isRequired};f.exports=s}),null);