if (self.CavalryLogger) { CavalryLogger.start_js(["kzIKE"]); }

__d("OmniMStore",["AsyncRequest","FluxReduceStore","MercuryConfig","MercuryDispatcher","MercuryMessages","MessengerFluxReduceDispatcher","OmniMHelpers","OmniMReducer","OmniMState","OmniMActions","XMessagingOmniMPrefController","gkx"],(function a(b,c,d,e,f,g){"use strict";__p&&__p();var h,i,j=5,k=[].concat(Object.values(c("OmniMReducer")));h=babelHelpers.inherits(l,c("FluxReduceStore"));i=h&&h.prototype;l.prototype.getInitialState=function(){return new(c("OmniMState"))()};l.prototype.reduce=function(m,n){if(n.namespace!==c("OmniMActions").Namespace)return m;return k.reduce(function(m,o){return o(m,n)},m)};l.prototype.$OmniMStore1=function(m){c("MercuryMessages").get().getThreadMessagesRange(m,0,1,function(n){if(n&&n.length){var o=n[0];c("OmniMActions").messageFetched(m,o)}})};l.prototype.$OmniMStore2=function(){var m=this.getState().get("prefs"),n=c("OmniMHelpers").suggestionMode(m),o=c("MercuryConfig").OmniMConfidenceThresholds[n];return o||.9};l.prototype.$OmniMStore3=function(m){var n=this.$OmniMStore2();return(m||[]).filter(function(o){return o.confidence&&o.confidence>n})};l.prototype.suggestionsForThread=function(m){var n=this.getState();if(!n.getIn(["threadMetadata",m]))this.$OmniMStore1(m);var o=n.getIn(["suggestionsByThread",m],{}),p=this.$OmniMStore3(o.agentSuggestions).slice(0,j);return babelHelpers["extends"]({},o,{agentSuggestions:p})};l.prototype.prefs=function(){return this.getState().get("prefs")};l.prototype.$OmniMStore4=function(){var m=c("MercuryDispatcher").get();m.subscribe("update-messages",function(n,o){c("OmniMActions").mercuryDispatched(n,o)});m.subscribe("invalidate-thread-state",function(n,o){c("OmniMActions").mercuryDispatched(n,{threadID:o})});m.subscribe("invalidate-global-state",function(n){return c("OmniMActions").mercuryDispatched(n)})};l.prototype.$OmniMStore5=function(){if(c("gkx")("AT5yWbHZcFbk8dHu9E8OgmaLZBFHY9-zh1crwQUro5XMW8HcPRzq86dofIPpo_Blktep-KcJ1J4uPJMiA3IOS9wnV278BkfyuEh6Dpu-S3Q1Hg")){var m=c("XMessagingOmniMPrefController").getURIBuilder().getURI();new(c("AsyncRequest"))(m).setAllowCrossPageTransition(true).setReadOnly(true).setMethod("POST").setHandler(function(n){return c("OmniMActions").prefsUpdated(n.payload)}).send()}};l.prototype.setUp=function(){this.$OmniMStore4();this.$OmniMStore5()};function l(){h.apply(this,arguments)}f.exports=new l(c("MessengerFluxReduceDispatcher"))}),null);